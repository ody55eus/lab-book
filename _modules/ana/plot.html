<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ana.plot &mdash; Lab Book 0.4 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Lab Book
          </a>
              <div class="version">
                0.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Lab Book</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/gitlab.html">GitLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/onenote/index.html">Original Lab Book</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">About the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/hloop/index.html">Magnetic Characterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/mfn/index.html">Magnetic Flux Noise (MFN)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/ana/index.html">Data Analysis Framework (Ana)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/sa/index.html">SpectrumAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/eve/index.html">Efficient Virtual Environment (EVE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/scripts.html">Python Scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../info/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/idx.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Lab Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>ana.plot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ana.plot</h1><div class="highlight"><pre>
<span></span><span class="c1"># SPDX-FileCopyrightText: 2020/2021 Jonathan Pieper &lt;ody55eus@mailbox.org&gt;</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: GPL-3.0-or-later</span>

<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Main plotting class to handle plots.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Math / Science Libraries</span>
<span class="kn">import</span> <span class="nn">scipy</span>

<span class="kn">from</span> <span class="nn">.handle</span> <span class="kn">import</span> <span class="n">HandleM</span>
<span class="kn">from</span> <span class="nn">.hloop</span> <span class="kn">import</span> <span class="n">Hloop</span>
<span class="kn">from</span> <span class="nn">.plotting</span> <span class="kn">import</span> <span class="n">PlottingClass</span>


<div class="viewcode-block" id="Plot"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot">[docs]</a><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A small class used to plot figures for a presentation.&quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">meas</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="mi">57</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span> <span class="o">=</span> <span class="n">HandleM</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data/SR785&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Plot.get_plot"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.get_plot">[docs]</a>    <span class="k">def</span> <span class="nf">get_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)),</span>
                               <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span><span class="nb">dict</span><span class="p">())</span>
                               <span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="Plot.set_plot_style"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.set_plot_style">[docs]</a>    <span class="k">def</span> <span class="nf">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>

        <span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;talk&#39;</span><span class="p">),</span>
                          <span class="n">style</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;ticks&#39;</span><span class="p">),</span>
                          <span class="n">palette</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;palette&#39;</span><span class="p">,</span> <span class="s1">&#39;deep&#39;</span><span class="p">),</span>
                          <span class="n">grid</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                          <span class="n">latex</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
                          <span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_single_hloop"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_single_hloop">[docs]</a>    <span class="k">def</span> <span class="nf">plot_single_hloop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">54</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-single-1&#39;</span><span class="p">,</span>
                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a single measurement. Default: 0deg</span>

<span class="sd">        Args:</span>
<span class="sd">            nr:</span>
<span class="sd">            filename (str, optional): File to write. The default is</span>
<span class="sd">                &#39;hloop-single-1&#39;.</span>
<span class="sd">            xlim / ylim: limit the plots axes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            {filename}.pdf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.64</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-1&#39;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares Plusses and Crosses between two angles (4 Subplots).</span>
<span class="sd">        Default: 0 and 45 Writes file hloop-compare-1.pdf</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (list, optional): List of 4 measurement numbers, </span>
<span class="sd">                defaults to [54, 55]</span>
<span class="sd">            filename (str, optional): DESCRIPTION, defaults to &#39;hloop-compare-1&#39;</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">plot_args</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span><span class="nb">dict</span><span class="p">()))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">4.45</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff_yticks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

        <span class="n">title_style</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bfseries </span><span class="se">\\</span><span class="s1">Huge &#39;</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="p">[</span><span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_style</span> <span class="o">+</span> <span class="n">struct</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = +45^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">,</span>
          <span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = -45^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.8</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.8</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="mf">3.45</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="mf">3.45</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops_95"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops_95">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops_95</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-95&#39;</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares +95/100/105/110deg with -85/80/75/70deg for (180deg</span>
<span class="sd">        Comparison)</span>

<span class="sd">        :param filename:Filename to save. The default is &#39;hloop-compare-95&#39;.</span>
<span class="sd">        :type filename: str, optional</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (list, optional): Measurement numbers to plot. The default</span>
<span class="sd">                is a[95]+a[-85].</span>
<span class="sd">            filename:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            {filename}.pdf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Crosses&#39;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;crosses_xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crosses_xlim&#39;</span><span class="p">))</span>

            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="c1"># inset.set_ylabel(&quot;$\Delta B_z\\;[\\mathrm{mT}]$&quot;)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Crosses&#39;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                        <span class="s1">&#39;crosses_xlim&#39;</span><span class="p">):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crosses_xlim&#39;</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops_90"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops_90">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops_90</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">155</span><span class="p">],</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-90&#39;</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares +90deg with -90deg for (180deg Comparison)</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [57,155].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-compare-90&#39;.</span>
<span class="sd">            **kwargs (TYPE): mirror: bool, optional</span>
<span class="sd">                    should we mirror the hloop? The default is False</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">))</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">cur_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                   <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># Plusses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="sd">&quot;&quot;&quot;if nr == 57:</span>
<span class="sd">                ax.set_title(&#39;m57: Plusses ($90^\circ$)&#39;)</span>
<span class="sd">            else:</span>
<span class="sd">                ax.set_title(&#39;m155: Plusses ($-90^\circ$)&#39;)&quot;&quot;&quot;</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">)):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">(</span>
                    <span class="n">fitted_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference (fitted)&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff_yticks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>

            <span class="c1"># Crosses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="sd">&quot;&quot;&quot;if nr == 57:</span>
<span class="sd">                ax.set_title(&#39;M57: Crosses ($90^\circ$)&#39;)</span>
<span class="sd">            else:</span>
<span class="sd">                ax.set_title(&#39;M155: Crosses ($-90^\circ$)&#39;)&quot;&quot;&quot;</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
                <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference (fitted)&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>

        <span class="n">title_style</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bfseries </span><span class="se">\\</span><span class="s1">Huge &#39;</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Crosses&#39;</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_style</span> <span class="o">+</span> <span class="n">struct</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = +90^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">,</span>
                          <span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = -90^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops_90_nofit"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops_90_nofit">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops_90_nofit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">155</span><span class="p">],</span>
                             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-90&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares +90deg with -90deg for (180deg Comparison) Using not fitted</span>
<span class="sd">        data</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [57,155].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-compare-90&#39;.</span>
<span class="sd">            **kwargs (TYPE): mirror: bool, optional</span>
<span class="sd">                    should we mirror the hloop? The default is False</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">))</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">cur_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                   <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># Plusses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (Empty)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (Empty)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Plusses ($90^\circ$)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M155: Plusses ($-90^\circ$)&#39;</span><span class="p">)</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">)):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.59</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>

            <span class="c1"># Crosses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (Empty)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (Empty)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Crosses ($90^\circ$)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M155: Crosses ($-90^\circ$)&#39;</span><span class="p">)</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
                <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.5$&#39;</span><span class="p">])</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.5$&#39;</span><span class="p">])</span>

            <span class="c1"># if nr == 57 and not kwargs.get(&#39;mirror&#39;):</span>
            <span class="c1">#    ax.legend(loc=&#39;upper left&#39;)#, ncol=2)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops2"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops2">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">],</span>
                     <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Outputs hloop-compare-3.pdf (not used anymore)</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is a[85]+a[100].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-compare-3&#39;.</span>
<span class="sd">            **kwargs (TYPE): DESCRIPTION.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">58</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops3"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops3">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
                     <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-repeat&#39;</span><span class="p">,</span>
                     <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="mi">350</span><span class="p">),</span>
                     <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">inset_xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                     <span class="n">inset_ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)</span>
                     <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compares two measurements at the same Angle (repeated</span>
<span class="sd">            measurements).</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [139,140].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-repeat&#39;.</span>
<span class="sd">            xlim (TYPE, optional): DESCRIPTION. The default is (-350, 350).</span>
<span class="sd">            ylim:</span>
<span class="sd">            inset_xlim (TYPE, optional): DESCRIPTION. The default is (-30, 30).</span>
<span class="sd">            inset_ylim (TYPE, optional): DESCRIPTION. The default is (.15,</span>
<span class="sd">                1.25).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="c1"># ax = axes[i//2][i%2]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">bmin1</span><span class="p">,</span> <span class="n">bmax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
            <span class="n">bmin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bmin1</span><span class="p">)</span>
            <span class="n">bmax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bmax1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bmin</span><span class="p">)</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bmax</span><span class="p">)</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;M</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> ($</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span>
                                                       <span class="s1">&#39;Structure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                                                       <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\_&#39;</span><span class="p">),</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span>
                                                       <span class="s1">&#39;Angle&#39;</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">])</span>
        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.055</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset2</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_ylim</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.43</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop_gradient3</span><span class="p">(</span><span class="n">inset3</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="n">to_show</span><span class="p">,</span>
                                      <span class="n">limit</span><span class="o">=</span><span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
            <span class="c1"># inset3.set_xticklabels([&#39;&#39;])</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops_compare_90"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops_compare_90">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops_compare_90</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">414</span><span class="p">,</span> <span class="mi">415</span><span class="p">],</span>
                               <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;plusses&#39;</span><span class="p">,</span>
                               <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-repeat-414&#39;</span><span class="p">,</span>
                               <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span>
                               <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.36</span><span class="p">,</span> <span class="mf">.76</span><span class="p">),</span>
                               <span class="n">inset_xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">),</span>
                               <span class="n">inset_ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.75</span><span class="p">),</span>
                               <span class="n">insets</span><span class="o">=</span><span class="p">[((</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.75</span><span class="p">),</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">))],</span>
                               <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
                               <span class="n">nograd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">nodiff</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                               <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compares multiple measurements at 90 deg (repeated</span>
<span class="sd">            measurements).</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [414,415].</span>
<span class="sd">            structure:</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-repeat-414&#39;.</span>
<span class="sd">            xlim (TYPE, optional): DESCRIPTION. The default is (-750, 750).</span>
<span class="sd">            ylim:</span>
<span class="sd">            inset_xlim (TYPE, optional): DESCRIPTION. The default is (-100,</span>
<span class="sd">                100).</span>
<span class="sd">            inset_ylim (TYPE, optional): DESCRIPTION. The default is (-1.25,</span>
<span class="sd">                .75).</span>
<span class="sd">            legend_loc:</span>
<span class="sd">            nograd:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Bx8&#39;</span>
        <span class="k">elif</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;crosses&#39;</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Bx9&#39;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="c1"># ax = axes[i//2][i%2]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>  <span class="c1"># Load measurement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">remove_zero</span><span class="p">()</span>  <span class="c1"># Remove measurement Errors</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="p">(</span>
                                                  <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">),</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="p">(</span>
                                                  <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;crosses&#39;</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>

            <span class="n">legend</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;m</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">,</span> <span class="s2">&quot;m</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">]</span>

        <span class="n">m_numbers</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">to_show</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">textbf{</span><span class="si">%s</span><span class="s2">} ($</span><span class="si">%s</span><span class="s2">^{</span><span class="se">\\</span><span class="s2">circ}$)&quot;</span> <span class="o">%</span> <span class="p">(</span>
                                                <span class="n">structure</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">all_insets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nodiff</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">:</span>
                        <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">(</span>
                            <span class="n">fitted_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span>
                        <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span>
                        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                        <span class="n">B_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
                        <span class="n">B_stray</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B_ext</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B_ext</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>

        <span class="n">subfig</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">bbox</span><span class="p">,</span> <span class="p">(</span><span class="n">inset_xlim</span><span class="p">,</span> <span class="n">inset_ylim</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="ow">in</span> <span class="n">insets</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset2</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_ylim</span><span class="p">)</span>

            <span class="p">(</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">ann_xx</span><span class="p">),</span> <span class="p">(</span><span class="n">ann_yy</span><span class="p">,</span> <span class="n">ann_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">inset2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="n">inset2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ann_x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ann_xx</span> <span class="o">-</span> <span class="n">ann_x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.05</span>
            <span class="n">ann_y</span> <span class="o">-=</span> <span class="p">(</span><span class="n">ann_y</span> <span class="o">-</span> <span class="n">ann_yy</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.20</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ann_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">subfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
                          <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.1&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;#ccf&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

            <span class="c1"># Draw Area into big plot</span>
            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nograd</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.08</span><span class="p">,</span> <span class="mf">.67</span><span class="p">,</span> <span class="mf">.27</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset3</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop_gradient3</span><span class="p">(</span><span class="n">inset3</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                          <span class="n">column</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_show</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">all_insets</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloops4"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloops4">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloops4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-parallel&#39;</span><span class="p">,</span>
                     <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;M57: $90^</span><span class="se">\\</span><span class="s2">circ$ Parallel measurement&quot;</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a single measurement (default: 90deg parallel)</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-parallel&#39;.</span>
<span class="sd">            figtitle (TYPE, optional): DESCRIPTION. The default is &quot;M57:</span>
<span class="sd">                $90^\circ$ Parallel measurement&quot;.</span>
<span class="sd">            **kwargs (TYPE): DESCRIPTION.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># self.mset_factor(-1)</span>
        <span class="c1"># self.mfactor = 1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span>
                               <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span> <span class="o">+=</span> <span class="mf">.25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span> <span class="o">+=</span> <span class="mf">.25</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">.46</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.23</span><span class="p">)</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference Plusses&quot;</span><span class="p">)</span>

            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.22</span><span class="p">)</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
            <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
            <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                        <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference Crosses&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_cubes_trees"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_cubes_trees">[docs]</a>    <span class="k">def</span> <span class="nf">plot_cubes_trees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots difference between RAW data from Cubes and Trees (1st</span>
<span class="sd">        Generation)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data/Data/</span><span class="si">%s</span><span class="s1">deg_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">struct</span><span class="p">)</span> <span class="k">for</span>
                     <span class="n">angle</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">]</span> <span class="k">for</span>
                     <span class="n">struct</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cubes&#39;</span><span class="p">,</span> <span class="s1">&#39;Trees&#39;</span><span class="p">]</span>
                     <span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_list</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">load_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">.dat&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span> <span class="k">for</span>
                          <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span>
            <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">file_list</span><span class="o">=</span><span class="n">load_files</span><span class="p">)</span>
            <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$V_x [</span><span class="se">\\</span><span class="s2">mathrm{</span><span class="se">\\</span><span class="s2">mu V}]$&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu_0 H_</span><span class="si">{ext}</span><span class="s2">$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
            <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;cubes&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">struct</span> <span class="o">=</span> <span class="s1">&#39;Cubes&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">struct</span> <span class="o">=</span> <span class="s2">&quot;Trees&quot;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> ($</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)))</span>

            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.69</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
                <span class="c1"># inset.set_title(&quot;Difference&quot;)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;compare-cubes-trees.pdf&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloop_gradient"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloop_gradient">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloop_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-gradient&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>

<span class="sd">        Args:</span>
<span class="sd">            limit:</span>
<span class="sd">            filename:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">grad1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
                 <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
        <span class="n">grad12</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">grad1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">grad12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Plusses&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Crosses&#39;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Gradient (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                    <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                    <span class="n">g2</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloop_gradient2"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloop_gradient2">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloop_gradient2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-gradient&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>

<span class="sd">        Args:</span>
<span class="sd">            limit:</span>
<span class="sd">            filename:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: Gradient (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Up&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Down&#39;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                    <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloop_gradient3"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloop_gradient3">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloop_gradient3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                             <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Vx8&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>

<span class="sd">        Args:</span>
<span class="sd">            ax:</span>
<span class="sd">            to_show:</span>
<span class="sd">            limit:</span>
<span class="sd">            column:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.m.style.set_style(default=True, grid=True,</span>
        <span class="c1">#        style=&#39;ticks&#39;,</span>
        <span class="c1">#        size=&#39;talk&#39;,</span>
        <span class="c1">#        palette=&#39;Paired&#39;,</span>
        <span class="c1">#        latex=True,)</span>

        <span class="n">limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gradient&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">column</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;Up&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;Down&#39;</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                        <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">direction</span><span class="p">))</span>

        <span class="c1"># ax.set_xlim(-limit, limit)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.plot_hloop_temp"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_hloop_temp">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hloop_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the Temperature of a Hloop measurement.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: Sample Temperature&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Sample Temp&#39;</span><span class="p">]),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Sample Temp&#39;</span><span class="p">]),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $[</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mK}</span><span class="s1">]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hloop-90-temp.pdf&#39;</span><span class="p">)</span></div>

    <span class="c1">#### Plot Static Fields</span>
<div class="viewcode-block" id="Plot.plot_static_fields"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.plot_static_fields">[docs]</a>    <span class="k">def</span> <span class="nf">plot_static_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;static-field&#39;</span><span class="p">,</span>
                           <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the Signal Analyzer (SA) Data for static fields (not sweeping)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Plusses (25 mT)&#39;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
            <span class="s1">&#39;Plusses (-25 mT)&#39;</span><span class="p">:</span> <span class="mi">361</span><span class="p">,</span>
            <span class="s1">&#39;Plusses (-9.4 mT)&#39;</span><span class="p">:</span> <span class="mi">282</span><span class="p">,</span>
            <span class="s1">&#39;Crosses (-9.4 mT)&#39;</span><span class="p">:</span> <span class="mi">283</span><span class="p">,</span>
            <span class="s1">&#39;Plusses (0 T)&#39;</span><span class="p">:</span> <span class="mi">281</span><span class="p">,</span>
            <span class="s1">&#39;Crosses (0 T)&#39;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span>
            <span class="s1">&#39;Empty (0 T)&#39;</span><span class="p">:</span> <span class="mi">310</span><span class="p">,</span>
            <span class="c1"># &#39;Crosses (250 mT)&#39;: 315,</span>
        <span class="p">}</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">j</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="p">{}]})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                 <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                                 <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                 <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Static Field&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">5e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="p">)</span>

        <span class="c1"># ax = plt.gca()</span>
        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.58</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.4</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                       <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                                       <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                       <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># &#39; ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># &#39; ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

                <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
                        <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()][</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span>

                <span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">iloc</span><span class="p">[((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()][</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#000099&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9999FF&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">9.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.4</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mf">9.4</span><span class="p">),</span> <span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mf">9.4</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FF3333&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

                <span class="c1"># ana.set_relative_yticks(inset)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span></div>

    <span class="c1">#### Sweeping Field</span>
<div class="viewcode-block" id="Plot.first_sweeps"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.first_sweeps">[docs]</a>    <span class="k">def</span> <span class="nf">first_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;vacant-sweeps&#39;</span><span class="p">,</span>
                     <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;First field sweeps (plus minus 50/75/100/etc.)</span>

<span class="sd">        Args:</span>
<span class="sd">            add: adding more data</span>
<span class="sd">            filename: saving as pdf (default: vacant-sweeps)</span>

<span class="sd">        Returns:</span>
<span class="sd">            vacant-sweeps.pdf:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># 382: [(-25,25), &#39;Plusses&#39;, 5, {}],</span>
            <span class="mi">362</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">363</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">364</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">366</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">365</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="c1"># 352: [(&quot;-M_s \\rightarrow -25&quot;,25), &#39;Plusses&#39;, .1],</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="mi">336</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="mi">331</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
                <span class="mi">332</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
                <span class="mi">333</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
            <span class="p">})</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="s2"> </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 9e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Huge </span><span class="se">\\</span><span class="s1">textbf{b) Sweeping Inside the Hysteresis (Plusses)}&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">7e-2</span><span class="p">)),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span> <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.74</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="c1"># Plotting Lines for each measurement</span>
                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">76</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">114</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">176</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">221</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">132</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">82</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">175</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
                                 <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
                           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>

                <span class="c1"># X-Ticks (labels)</span>
                <span class="n">xt_labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">xt_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">xt_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xt_labels</span><span class="p">)</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.44</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.09</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">2e-1</span><span class="p">))</span>
                <span class="n">voltage</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;end field&#39;</span><span class="p">:</span> <span class="n">voltage</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;End field [$\mu_0 \mathrm{H_</span><span class="si">{ext}</span><span class="s1">}$]&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mf">8e-7</span><span class="p">,</span> <span class="mf">9e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">])</span>

            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;End field [$\mu_0 \mathrm{H_</span><span class="si">{ext}</span><span class="s1">}$]&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">i2data</span></div>

<div class="viewcode-block" id="Plot.compare_voltages"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.compare_voltages">[docs]</a>    <span class="k">def</span> <span class="nf">compare_voltages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;compare-voltages&#39;</span><span class="p">,</span>
                         <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare different applied Voltages.</span>

<span class="sd">        Returns:</span>
<span class="sd">            compare-voltages.pdf:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">to_show</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">377</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">mu</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{A}</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span>
            <span class="p">),</span> <span class="p">{}]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 7e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Current Amplitudes (SR785)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">7e-2</span><span class="p">)),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                                <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1.5e-1</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.38</span><span class="p">,</span> <span class="mf">.26</span><span class="p">,</span> <span class="mf">.26</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
                <span class="c1"># inset.set_xticks([-45+10*_ for _ in range(10)], minor=True)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
                           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
                <span class="c1"># inset.set_xlabel(&#39;&#39;)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.54</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.3</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
                <span class="n">voltage</span> <span class="o">=</span> <span class="n">content</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;voltage&#39;</span><span class="p">:</span> <span class="n">voltage</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current [$</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{A}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current [$</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{A}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">i2data</span></div>

<div class="viewcode-block" id="Plot.compare_sweeprates"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.compare_sweeprates">[docs]</a>    <span class="k">def</span> <span class="nf">compare_sweeprates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;compare-sweeprates&#39;</span><span class="p">,</span>
                           <span class="n">show_inset</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare different Sweeprates, fits the data and</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">382</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
            <span class="mi">354</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="mi">351</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="mi">355</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span>
            <span class="mi">353</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.25</span><span class="p">],</span>
            <span class="mi">352</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">frac{</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">}{</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{min}</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">),</span> <span class="p">{}]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 5e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sweeprates (SR785)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1.5e-1</span><span class="p">,),</span>
                                <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.33</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>

                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
                <span class="n">sweep_rate</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sweeprate&#39;</span><span class="p">:</span> <span class="n">sweep_rate</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sweep_rate</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
                <span class="s1">&#39;Sweeprate $</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{d}{dt}</span><span class="s1"> \mu_0 H_</span><span class="si">{ext}</span><span class="s1"> </span><span class="se">\\</span><span class="s1">left[</span><span class="se">\\</span><span class="s1">frac{</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">}{</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{min}</span><span class="s1">}</span><span class="se">\\</span><span class="s1">right]$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="c1"># Only save if necessary</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">i2data</span></div>

<div class="viewcode-block" id="Plot.fast_sweeprate"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.fast_sweeprate">[docs]</a>    <span class="k">def</span> <span class="nf">fast_sweeprate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">320</span><span class="p">,</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">323</span><span class="p">,</span> <span class="mi">329</span><span class="p">,</span> <span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;FastSR-1&#39;</span><span class="p">,</span> <span class="n">pos2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Huge </span><span class="se">\\</span><span class="s1">textbf{a) Large Field Sweeps}&#39;</span><span class="p">,</span>
                       <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;anas Fast Sweeps over large sweep ranges (1T)</span>

<span class="sd">        Args:</span>
<span class="sd">            show_numbers:</span>
<span class="sd">            xlim:</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is &#39;FastSR-1&#39;.</span>
<span class="sd">            pos2:</span>
<span class="sd">            title:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">320</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">321</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">325</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">326</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">323</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">324</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">329</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">322</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">327</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">328</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">336</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">333</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">.75</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">332</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">.3</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">331</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">4.7</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="ow">in</span> <span class="n">show_numbers</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{</span><span class="si">%s</span><span class="s1">} $</span><span class="se">\\</span><span class="s1">;</span><span class="se">\\</span><span class="s1">mathbf{</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{T}</span><span class="s1">}$&#39;</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">leg_str</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>   <span class="c1"># Structure</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="c1"># Field from</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="c1"># Field to</span>
                <span class="c1"># content[2], # Sweeprate</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lofm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
            <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                                 <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                 <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">),</span>
                                       <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ffff99&#39;</span><span class="p">,</span>
                                                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">3e-2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="c1"># self.eva[i]._draw_oneoverf(ax, xmin=1e-2, ymin=1e-6)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
                 <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">pos2</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.32</span><span class="p">,</span> <span class="mf">.72</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Crosses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.45</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">pos2</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">300</span> <span class="o">+</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span>
                                     <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">[((</span><span class="mi">202</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">178</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">214</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">300</span><span class="p">),</span>
                                      <span class="p">((</span><span class="mi">106</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">61</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">154</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">100</span><span class="p">)]:</span>
                        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span>
                                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="c1"># inset.fill([-500, -500, 500, 500], [y1, y2, y2, y1], &#39;blue&#39;, alpha=.1)</span>
                <span class="c1"># inset.annotate(&quot;&quot;, xy=(25, .35), xytext=(-25, .2),</span>
                <span class="c1">#             arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&#39;blue&#39;))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.sv_temp_effect"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.sv_temp_effect">[docs]</a>    <span class="k">def</span> <span class="nf">sv_temp_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;sv-temp-effect&#39;</span><span class="p">,</span>
                       <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">351</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="mi">355</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
            <span class="mi">356</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
            <span class="mi">357</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="mi">358</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="mi">359</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">;\mathrm</span><span class="si">{K}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="p">),</span> <span class="p">{}]</span>
            <span class="c1"># self.eva[nr].Vx *= grad</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 7e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="c1">#Temperature Effect&#39;,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">7e-2</span>
                                <span class="p">)</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.75</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span> <span class="s1">&#39;Down&#39;</span><span class="p">],</span>
                             <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">temp</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$\mathrm</span><span class="si">{K}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$\mathrm</span><span class="si">{K}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Only save if necessary</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">i2data</span></div>

<div class="viewcode-block" id="Plot.multiple_fspans"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.multiple_fspans">[docs]</a>    <span class="k">def</span> <span class="nf">multiple_fspans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;multiple-fspans&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">340</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">349</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">338</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">342</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25 </span><span class="se">\\</span><span class="s2">rightarrow 8.3&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                  <span class="o">+</span><span class="mf">0.11</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">343</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25 </span><span class="se">\\</span><span class="s2">rightarrow -8.3&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                  <span class="mf">0.11</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">$ mT </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{mT}{min}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                      <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps ($B = </span><span class="se">\\</span><span class="s1">pm 25 mT$)&#39;</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-3</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                          <span class="c1"># ylim=()</span>
                      <span class="p">),</span>
                      <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                      <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
                      <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="p">)</span>
                      <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Dark2&#39;</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.44</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                   <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span> <span class="s1">&#39;Down&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="n">s</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">)</span>
            <span class="c1"># inset.plot([8.3, 8.3], [y1, y2], &#39;b-.&#39;, alpha=.8)</span>

        <span class="c1"># Only save if necessary</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span></div>

<div class="viewcode-block" id="Plot.negative_sweeps"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.negative_sweeps">[docs]</a>    <span class="k">def</span> <span class="nf">negative_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Testing without file output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">340</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">338</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">348</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow 36.56&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">347</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow 36.56&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">$ mT </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{mT}{min}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (measurement Plan \#2)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-3</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="c1"># ylim=()</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">6e-3</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;muted&#39;</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.28</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mf">291.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">291.13</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span>
                       <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">611</span><span class="p">,</span> <span class="o">-</span><span class="mi">611</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">291</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.measplan12"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.measplan12">[docs]</a>    <span class="k">def</span> <span class="nf">measplan12</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="c1"># sns.color_palette(&quot;Reds_r&quot;, 14)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">383</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">384</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">385</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)),</span>
                                 <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses $0.5\;\mathrm</span><span class="si">{mT}</span><span class="s1">/\mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">3e-3</span><span class="p">,</span> <span class="mf">6e-7</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="mi">5</span><span class="p">)]:</span>  <span class="c1"># + [-300-50*i for i in range(5)] + [-575]:</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="c1"># for j in [-300-50*i for i in range(5)] + [-575]:</span>
            <span class="c1">#    inset.fill([j, j, j-50, j-50], [y1, y2, y2, y1], alpha=.4)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Without Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2e-2</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;With Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.01e-2</span><span class="p">,</span> <span class="mf">.8e-3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">37</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;self.measplan12-1.pdf&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.measplan12_2"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.measplan12_2">[docs]</a>    <span class="k">def</span> <span class="nf">measplan12_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="c1"># sns.color_palette(&quot;Reds_r&quot;, 14)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">_</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">391</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span>
                                <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">625</span>
        <span class="n">to_show</span><span class="p">[</span><span class="mi">397</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                        <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}]</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses $0.5\;\mathrm</span><span class="si">{mT}</span><span class="s1">/\mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-4</span><span class="p">,</span> <span class="mf">2e-7</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">300</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]:</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;self.measplan12-2.pdf&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.measplan12_full"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.measplan12_full">[docs]</a>    <span class="k">def</span> <span class="nf">measplan12_full</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;measplan12-full&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;measurement Plan #12 All 14 measurements in one Graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># c1 = sns.color_palette(&quot;twilight&quot;, 14)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>

        <span class="c1"># Choosing measurement Numbers to plot</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">383</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">384</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">385</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)),</span>
                                 <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">_</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">391</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span>
                                <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">625</span>
        <span class="n">to_show</span><span class="p">[</span><span class="mi">397</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                        <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}]</span>

        <span class="c1"># Converting them to a list of measurements (lofm)</span>
        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses;&#39;</span> <span class="o">+</span> \
                                          <span class="s1">&#39; $</span><span class="se">\\</span><span class="s1">Delta B = 50</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$;&#39;</span> <span class="o">+</span> \
                                          <span class="s1">&#39; $0.5</span><span class="se">\\</span><span class="s1">;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">5e-2</span><span class="p">,</span> <span class="mf">5e-8</span><span class="p">),</span>
                                    <span class="n">legend_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.26</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span>
                                   <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                   <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span> <span class="o">+</span> \
                     <span class="p">[</span><span class="o">-</span><span class="mi">300</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]:</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Without Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2e-2</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;With Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.01e-2</span><span class="p">,</span> <span class="mf">4e-4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">35</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Plot.set_size"><a class="viewcode-back" href="../../modules/ana/programming.html#ana.plot.Plot.set_size">[docs]</a>    <span class="k">def</span> <span class="nf">set_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width_pt</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;Set figure dimensions to sit nicely in our document.</span>
<span class="sd">        </span>
<span class="sd">        Source: https://jwalton.info/Matplotlib-latex-PGF/</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        width_pt: float</span>
<span class="sd">                Document width in points</span>
<span class="sd">        fraction: float, optional</span>
<span class="sd">                Fraction of the width which you wish the figure to occupy</span>
<span class="sd">        subplots: array-like, optional</span>
<span class="sd">                The number of rows and columns of subplots.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig_dim: tuple</span>
<span class="sd">                Dimensions of figure in inches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Width of figure (in pts)</span>
        <span class="n">fig_width_pt</span> <span class="o">=</span> <span class="n">width_pt</span> <span class="o">*</span> <span class="n">fraction</span>
        <span class="c1"># Convert from pt to inches</span>
        <span class="n">inches_per_pt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">72.27</span>

        <span class="c1"># Golden ratio to set aesthetic figure height</span>
        <span class="n">golden_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">**</span> <span class="mf">.5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Figure width in inches</span>
        <span class="n">fig_width_in</span> <span class="o">=</span> <span class="n">fig_width_pt</span> <span class="o">*</span> <span class="n">inches_per_pt</span>
        <span class="c1"># Figure height in inches</span>
        <span class="n">fig_height_in</span> <span class="o">=</span> <span class="n">fig_width_in</span> <span class="o">*</span> <span class="n">golden_ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">subplots</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">fig_width_in</span><span class="p">,</span> <span class="n">fig_height_in</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020/2021, Jonathan Pieper.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>