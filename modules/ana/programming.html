

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Programming Documentation &mdash; Lab Book 0.4 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Lab Book
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Lab Book</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/gitlab.html">GitLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/onenote/index.html">Original Lab Book</a></li>
</ul>
<p><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">About the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/hloop/index.html">Magnetic Characterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/mfn/index.html">Magnetic Flux Noise (MFN)</a></li>
</ul>
<p><span class="caption-text">Software</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Data Analysis Framework (Ana)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="README.html">Readme</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Programming Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#uml-diagram">UML Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#high-level-interface">High Level Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plot">Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handlem">HandleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mfn">MFN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#low-level-python-backend">Low Level Python Backend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#measurementclass">MeasurementClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#singlem">SingleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiplem">MultipleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plottingclass">PlottingClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ana.functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#source-code">Source Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plot-1">Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handlem-1">HandleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mfn-1">MFN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#measurementclass-1">MeasurementClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#singlem-1">SingleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#raw-1">RAW</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sa-1">SA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hloop-1">Hloop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiplem-1">MultipleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plottingclass-1">PlottingClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions-1">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sa/index.html">SpectrumAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eve/index.html">EVE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Python Scripts</a></li>
</ul>
<p><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../info/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/idx.html">Index</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Lab Book</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Data Analysis Framework (Ana)</a> &raquo;</li>
        
      <li>Programming Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/ana/programming.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="programming-documentation">
<h1>Programming Documentation<a class="headerlink" href="#programming-documentation" title="Permalink to this headline">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#uml-diagram" id="toc-entry-1">UML Diagram</a></p></li>
<li><p><a class="reference internal" href="#high-level-interface" id="toc-entry-2">High Level Interface</a></p>
<ul>
<li><p><a class="reference internal" href="#plot" id="toc-entry-3">Plot</a></p></li>
<li><p><a class="reference internal" href="#handlem" id="toc-entry-4">HandleM</a></p></li>
<li><p><a class="reference internal" href="#mfn" id="toc-entry-5">MFN</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#low-level-python-backend" id="toc-entry-6">Low Level Python Backend</a></p>
<ul>
<li><p><a class="reference internal" href="#measurementclass" id="toc-entry-7">MeasurementClass</a></p></li>
<li><p><a class="reference internal" href="#singlem" id="toc-entry-8">SingleM</a></p>
<ul>
<li><p><a class="reference internal" href="#raw" id="toc-entry-9">RAW</a></p></li>
<li><p><a class="reference internal" href="#sa" id="toc-entry-10">SA</a></p></li>
<li><p><a class="reference internal" href="#hloop" id="toc-entry-11">Hloop</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#multiplem" id="toc-entry-12">MultipleM</a></p></li>
<li><p><a class="reference internal" href="#plottingclass" id="toc-entry-13">PlottingClass</a></p></li>
<li><p><a class="reference internal" href="#module-ana.functions" id="toc-entry-14">Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#source-code" id="toc-entry-15">Source Code</a></p>
<ul>
<li><p><a class="reference internal" href="#plot-1" id="toc-entry-16">Plot</a></p></li>
<li><p><a class="reference internal" href="#handlem-1" id="toc-entry-17">HandleM</a></p></li>
<li><p><a class="reference internal" href="#mfn-1" id="toc-entry-18">MFN</a></p></li>
<li><p><a class="reference internal" href="#measurementclass-1" id="toc-entry-19">MeasurementClass</a></p></li>
<li><p><a class="reference internal" href="#singlem-1" id="toc-entry-20">SingleM</a></p></li>
<li><p><a class="reference internal" href="#raw-1" id="toc-entry-21">RAW</a></p></li>
<li><p><a class="reference internal" href="#sa-1" id="toc-entry-22">SA</a></p></li>
<li><p><a class="reference internal" href="#hloop-1" id="toc-entry-23">Hloop</a></p></li>
<li><p><a class="reference internal" href="#multiplem-1" id="toc-entry-24">MultipleM</a></p></li>
<li><p><a class="reference internal" href="#plottingclass-1" id="toc-entry-25">PlottingClass</a></p></li>
<li><p><a class="reference internal" href="#functions-1" id="toc-entry-26">Functions</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="uml-diagram">
<h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">UML Diagram</a><a class="headerlink" href="#uml-diagram" title="Permalink to this headline">¶</a></h2>
<figure class="align-default" id="figure-1">
<img alt="../../_images/ana_uml.svg" src="../../_images/ana_uml.svg" /><figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">UML diagram of inheritance and created objects</span><a class="headerlink" href="#figure-1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="high-level-interface">
<h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">High Level Interface</a><a class="headerlink" href="#high-level-interface" title="Permalink to this headline">¶</a></h2>
<section id="plot">
<h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">Plot</a><a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.plot.Plot">
<em class="property">class </em><code class="sig-name descname">Plot</code><a class="reference internal" href="../../_modules/ana/plot.html#Plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A small class used to plot figures for a presentation.</p>
<dl class="py method">
<dt id="ana.plot.Plot.compare_sweeprates">
<code class="sig-name descname">compare_sweeprates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'compare-sweeprates'</span></em>, <em class="sig-param"><span class="n">show_inset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.compare_sweeprates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.compare_sweeprates" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare different Sweeprates, fits the data and</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.compare_voltages">
<code class="sig-name descname">compare_voltages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'compare-voltages'</span></em>, <em class="sig-param"><span class="n">show_inset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.compare_voltages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.compare_voltages" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare different applied Voltages.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>compare-voltages.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.fast_sweeprate">
<code class="sig-name descname">fast_sweeprate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">show_numbers</span><span class="o">=</span><span class="default_value">[320, 325, 323, 329]</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'FastSR-1'</span></em>, <em class="sig-param"><span class="n">pos2</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">'\\Huge \\textbf{a) Large Field Sweeps}'</span></em>, <em class="sig-param"><span class="n">show_inset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.fast_sweeprate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.fast_sweeprate" title="Permalink to this definition">¶</a></dt>
<dd><p>anas Fast Sweeps over large sweep ranges (1T)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_numbers</strong> – </p></li>
<li><p><strong>xlim</strong> – </p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is ‘FastSR-1’.</p></li>
<li><p><strong>pos2</strong> – </p></li>
<li><p><strong>title</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.first_sweeps">
<code class="sig-name descname">first_sweeps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">add</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'vacant-sweeps'</span></em>, <em class="sig-param"><span class="n">show_inset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.first_sweeps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.first_sweeps" title="Permalink to this definition">¶</a></dt>
<dd><p>First field sweeps (plus minus 50/75/100/etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add</strong> – adding more data</p></li>
<li><p><strong>filename</strong> – saving as pdf (default: vacant-sweeps)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>vacant-sweeps.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.get_plot">
<code class="sig-name descname">get_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.get_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.get_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.measplan12">
<code class="sig-name descname">measplan12</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.measplan12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.measplan12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.measplan12_2">
<code class="sig-name descname">measplan12_2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.measplan12_2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.measplan12_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.measplan12_full">
<code class="sig-name descname">measplan12_full</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'measplan12-full'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.measplan12_full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.measplan12_full" title="Permalink to this definition">¶</a></dt>
<dd><p>measurement Plan #12 All 14 measurements in one Graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.multiple_fspans">
<code class="sig-name descname">multiple_fspans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'multiple-fspans'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.multiple_fspans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.multiple_fspans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.negative_sweeps">
<code class="sig-name descname">negative_sweeps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.negative_sweeps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.negative_sweeps" title="Permalink to this definition">¶</a></dt>
<dd><p>Testing without file output.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_cubes_trees">
<code class="sig-name descname">plot_cubes_trees</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_cubes_trees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_cubes_trees" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots difference between RAW data from Cubes and Trees (1st
Generation)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloop_gradient">
<code class="sig-name descname">plot_hloop_gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">limit</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-gradient'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the gradient along the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> – </p></li>
<li><p><strong>filename</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloop_gradient2">
<code class="sig-name descname">plot_hloop_gradient2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">limit</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-gradient'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_gradient2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_gradient2" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the gradient along the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> – </p></li>
<li><p><strong>filename</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloop_gradient3">
<code class="sig-name descname">plot_hloop_gradient3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[139, 140]</span></em>, <em class="sig-param"><span class="n">limit</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">column</span><span class="o">=</span><span class="default_value">'Vx8'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_gradient3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_gradient3" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the gradient along the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>to_show</strong> – </p></li>
<li><p><strong>limit</strong> – </p></li>
<li><p><strong>column</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloop_temp">
<code class="sig-name descname">plot_hloop_temp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_temp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the Temperature of a Hloop measurement.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops">
<code class="sig-name descname">plot_hloops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[54, 55]</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-compare-1'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares Plusses and Crosses between two angles (4 Subplots).
Default: 0 and 45 Writes file hloop-compare-1.pdf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>list</em><em>, </em><em>optional</em>) – List of 4 measurement numbers,
defaults to [54, 55]</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to ‘hloop-compare-1’</p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops2">
<code class="sig-name descname">plot_hloops2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[58, 59, 61, 62]</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-compare-3'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops2" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs hloop-compare-3.pdf (not used anymore)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is a[85]+a[100].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is
‘hloop-compare-3’.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops3">
<code class="sig-name descname">plot_hloops3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[139, 140]</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-repeat'</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">(- 350, 350)</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inset_xlim</span><span class="o">=</span><span class="default_value">(- 30, 30)</span></em>, <em class="sig-param"><span class="n">inset_ylim</span><span class="o">=</span><span class="default_value">(0.15, 1.25)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops3" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compares two measurements at the same Angle (repeated
measurements).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is [139,140].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is
‘hloop-repeat’.</p></li>
<li><p><strong>xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is (-350, 350).</p></li>
<li><p><strong>ylim</strong> – </p></li>
<li><p><strong>inset_xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is (-30, 30).</p></li>
<li><p><strong>inset_ylim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is (.15,
1.25).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops4">
<code class="sig-name descname">plot_hloops4</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-parallel'</span></em>, <em class="sig-param"><span class="n">figtitle</span><span class="o">=</span><span class="default_value">'M57: $90^\\circ$ Parallel measurement'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops4" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a single measurement (default: 90deg parallel)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is
‘hloop-parallel’.</p></li>
<li><p><strong>figtitle</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is “M57:
$90^circ$ Parallel measurement”.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops_90">
<code class="sig-name descname">plot_hloops_90</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[57, 155]</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-compare-90'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_90"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_90" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares +90deg with -90deg for (180deg Comparison)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is [57,155].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is
‘hloop-compare-90’.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) – mirror: bool, optional
should we mirror the hloop? The default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops_90_nofit">
<code class="sig-name descname">plot_hloops_90_nofit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[57, 155]</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-compare-90'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_90_nofit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_90_nofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares +90deg with -90deg for (180deg Comparison) Using not fitted
data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is [57,155].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is
‘hloop-compare-90’.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) – mirror: bool, optional
should we mirror the hloop? The default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops_95">
<code class="sig-name descname">plot_hloops_95</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[42, 43, 32, 34]</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-compare-95'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_95"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_95" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares +95/100/105/110deg with -85/80/75/70deg for (180deg
Comparison)</p>
<p>:param filename:Filename to save. The default is ‘hloop-compare-95’.
:type filename: str, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>list</em><em>, </em><em>optional</em>) – Measurement numbers to plot. The default
is a[95]+a[-85].</p></li>
<li><p><strong>filename</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{filename}.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_hloops_compare_90">
<code class="sig-name descname">plot_hloops_compare_90</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span><span class="o">=</span><span class="default_value">[414, 415]</span></em>, <em class="sig-param"><span class="n">structure</span><span class="o">=</span><span class="default_value">'plusses'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-repeat-414'</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">(- 750, 750)</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">(- 0.36, 0.76)</span></em>, <em class="sig-param"><span class="n">inset_xlim</span><span class="o">=</span><span class="default_value">(- 225, 225)</span></em>, <em class="sig-param"><span class="n">inset_ylim</span><span class="o">=</span><span class="default_value">(- 0.35, 0.75)</span></em>, <em class="sig-param"><span class="n">insets</span><span class="o">=</span><span class="default_value">[((0.05, 0.05, 0.35, 0.35), ((- 225, 225), (- 0.35, 0.75), 'blue', 0.1))]</span></em>, <em class="sig-param"><span class="n">legend_loc</span><span class="o">=</span><span class="default_value">'upper right'</span></em>, <em class="sig-param"><span class="n">nograd</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">nodiff</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">(16, 12)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_compare_90"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_compare_90" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compares multiple measurements at 90 deg (repeated
measurements).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is [414,415].</p></li>
<li><p><strong>structure</strong> – </p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is
‘hloop-repeat-414’.</p></li>
<li><p><strong>xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is (-750, 750).</p></li>
<li><p><strong>ylim</strong> – </p></li>
<li><p><strong>inset_xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is (-100,
100).</p></li>
<li><p><strong>inset_ylim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is (-1.25,
.75).</p></li>
<li><p><strong>legend_loc</strong> – </p></li>
<li><p><strong>nograd</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_single_hloop">
<code class="sig-name descname">plot_single_hloop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nr</span><span class="o">=</span><span class="default_value">54</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'hloop-single-1'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_single_hloop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_single_hloop" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a single measurement. Default: 0deg</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> – </p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – File to write. The default is
‘hloop-single-1’.</p></li>
<li><p><strong>/ ylim</strong> (<em>xlim</em>) – limit the plots axes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{filename}.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.plot_static_fields">
<code class="sig-name descname">plot_static_fields</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'static-field'</span></em>, <em class="sig-param"><span class="n">show_inset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_static_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.plot_static_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the Signal Analyzer (SA) Data for static fields (not sweeping)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.set_plot_style">
<code class="sig-name descname">set_plot_style</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.set_plot_style"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.set_plot_style" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.set_size">
<code class="sig-name descname">set_size</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">width_pt</span></em>, <em class="sig-param"><span class="n">fraction</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">subplots</span><span class="o">=</span><span class="default_value">(1, 1)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.set_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.set_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Set figure dimensions to sit nicely in our document.</p>
<p>Source: <a class="reference external" href="https://jwalton.info/Matplotlib-latex-PGF/">https://jwalton.info/Matplotlib-latex-PGF/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width_pt</strong> (<em>float</em>) – Document width in points</p></li>
<li><p><strong>fraction</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of the width which you wish the figure to occupy</p></li>
<li><p><strong>subplots</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The number of rows and columns of subplots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig_dim</strong> – Dimensions of figure in inches</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plot.Plot.sv_temp_effect">
<code class="sig-name descname">sv_temp_effect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'sv-temp-effect'</span></em>, <em class="sig-param"><span class="n">show_inset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.sv_temp_effect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plot.Plot.sv_temp_effect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="handlem">
<h3><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">HandleM</a><a class="headerlink" href="#handlem" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.HandleM">
<em class="property">class </em><code class="sig-name descname">HandleM</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ana.multiple.MultipleM</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Measurement Handler:</strong> This class represents all other
measurements and is the interface to other measurement objets.</p>
</aside>
<dl class="py method">
<dt id="ana.HandleM.get_custom_header">
<code class="sig-name descname">get_custom_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'RAW'</span></em>, <em class="sig-param"><span class="n">instruments</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.get_custom_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM.get_custom_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Help Function to get column names for EVE Measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em><em>, </em><em>optional</em>) – Kind of measurement, default: ‘RAW’</p></li>
<li><p><strong>instruments</strong> (<em>list</em><em>, </em><em>optional</em>) – Used instruments in order of
appearance, default: [‘t’, ‘LS’, ‘IPS’, ‘SR830’]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(list header, int skiprows)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.HandleM.get_info">
<code class="sig-name descname">get_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.get_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns information about all measurements
and splits it into groups (SA/RAV/MFN/VH).</p>
</dd></dl>

<dl class="py method">
<dt id="ana.HandleM.load_files">
<code class="sig-name descname">load_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.load_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM.load_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all files from a specific directory and creates objects for
found measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>str</em>) – directory to search in</p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.HandleM.load_folder">
<code class="sig-name descname">load_folder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_list</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.load_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM.load_folder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.HandleM.parse_data">
<code class="sig-name descname">parse_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.parse_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM.parse_data" title="Permalink to this definition">¶</a></dt>
<dd><p>imports data and sets info variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">parse_data</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Nr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span> <span class="n">kw</span><span class="p">)</span> <span class="p">})</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict</em>) – Data to parse</p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.HandleM.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.HandleM.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting a Measurement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lofm</strong> – list of measurements</p></li>
<li><p><strong>figsize</strong> – tuple size of figure</p></li>
<li><p><strong>show_fit</strong> – bool</p></li>
<li><p><strong>fit_range</strong> – tuple/list</p></li>
<li><p><strong>plot_settings</strong> – list</p></li>
<li><p><strong>grid_options</strong> – list</p></li>
<li><p><strong>f_settings</strong> – 1/f line</p></li>
<li><p><strong>f2_settings</strong> – 1/f^2 line</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure, Axis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>warning</strong> – lofm not available.</p></li>
<li><p><strong>KeyError</strong> – Measurement does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="mfn">
<h3><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">MFN</a><a class="headerlink" href="#mfn" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.MFN">
<em class="property">class </em><code class="sig-name descname">MFN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">files</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ana.multiple.MultipleM</span></code></p>
<p>Magnetic Flux Noise Measurements.
Class to handle and plot MFN Measurements
taken with the SR830 DAQ.</p>
<p>if a measurement number is given the files are
loaded from folder:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">data/MFN/m%s/*.dat</span></code></p>
</div></blockquote>
<p>else: files must be a list of filenames:</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="container-1">
<div class="code-block-caption"><span class="caption-number">Listing 4 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-1" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">arg</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/MFN/mXXX/m[0-9.]*.dat&#39;</span><span class="p">)</span>
<span class="n">mfn</span> <span class="o">=</span> <span class="n">MFN</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> – list of files or measurement number.</p></li>
<li><p><strong>kwargs</strong> – Different additional parameters.</p></li>
<li><p><strong>nr</strong> (<em>int</em>) – Measurement number
(default: None).</p></li>
<li><p><strong>calc_first</strong> (<em>bool</em>) – Calculating first spectrum
(default: True).</p></li>
<li><p><strong>calc_second</strong> (<em>bool</em>) – Calculating second spectrum
(default: False).</p></li>
<li><p><strong>downsample</strong> (<em>bool</em>) – downsample timesignal for first spectrum
(default: False).</p></li>
<li><p><strong>num_first_spectra</strong> (<em>int</em>) – Number of spectra to average
(default: 64).</p></li>
<li><p><strong>timeconstant</strong> (<em>float</em>) – Lock-In timeconstant to cut first spectrum
at corresponding frequency (see <code class="docutils literal notranslate"><span class="pre">cut_fmax</span></code>).</p></li>
<li><p><strong>cut_fmax</strong> (<em>float</em>) – Cut first spectrum at this frequency
(default: <span class="math notranslate nohighlight">\(f_{max} = \frac{\tau}{2\pi}\)</span>).</p></li>
<li><p><strong>default_cm</strong> (<em>matplotlib.cm</em>) – matplotlib color map for contour plots
(default: style[‘default_cm’]).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ana.MFN.cut_fmax">
<code class="sig-name descname">cut_fmax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmax</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.cut_fmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.cut_fmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut frequencies higher than maximum allowed frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fmax</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.load_meas">
<code class="sig-name descname">load_meas</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">files</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.load_meas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.load_meas" title="Permalink to this definition">¶</a></dt>
<dd><p>Loading a single magnetic flux noise DAQ measurement.</p>
<p>Files in measrument folder contain multiple measurements
with one measurement per field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>files</strong> – files to load</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame Data, dict Measurement Objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.load_voltages">
<code class="sig-name descname">load_voltages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nr</span><span class="o">=</span><span class="default_value">508</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">(16, 12)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.load_voltages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.load_voltages" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_alpha">
<code class="sig-name descname">plot_alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field</span></em>, <em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a spectrum and plots the slope alpha.
:param s: pandas.DataFrame of the spectrum
:param ax: axis where to plot the data.
:return: linear regression fit</p>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_compare_timesignals">
<code class="sig-name descname">plot_compare_timesignals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_compare_timesignals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_compare_timesignals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a grid of 2x2 subplots to compare timesignals and histogram.
:param fields: list
:param factor: float Default: 1e3 (mV)
:param nrows: int Default: len(fields)
:param ncols: int Default: 2
:param sharey: bool Default: True
:param figsize: tuple Default: (11.69, 8.27) in
:param plot_range: int Default: -1</p>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_field_contour">
<code class="sig-name descname">plot_field_contour</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax31</span></em>, <em class="sig-param"><span class="n">show_field</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_field_contour"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_field_contour" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_first_and_second">
<code class="sig-name descname">plot_first_and_second</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_first_and_second"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_first_and_second" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_info">
<code class="sig-name descname">plot_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">show_field</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots basic mfn infos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_field</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_info2">
<code class="sig-name descname">plot_info2</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_info2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_info2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_multiple_histograms">
<code class="sig-name descname">plot_multiple_histograms</code><span class="sig-paren">(</span><em class="sig-param">steps=4</em>, <em class="sig-param">fields=Series([]</em>, <em class="sig-param">dtype: float64)</em>, <em class="sig-param">factor=1000.0</em>, <em class="sig-param">xlim=(-1.3</em>, <em class="sig-param">1.3)</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_multiple_histograms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_multiple_histograms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots multiple histograms using seaborn <code class="docutils literal notranslate"><span class="pre">sns.FacetGrid</span></code>
with kdeplot.</p>
<dl class="simple">
<dt>default kwargs for subplots:</dt><dd><p>kde1_kwargs = dict(clip_on=True, shade=True, alpha=1, lw=1.5, bw=.2)
kde2_kwargs = kde1_kwargs.update(dict(lw=2, color=’w’)
dist_kwargs = dict(hist=True, norm_hist=True, hist_kws={‘alpha’: .5})
ax_kwargs = dict(y=0, lw=2, clip_on=True).set(xlim=(-1.3,1.3))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_noise_chararcteristics">
<code class="sig-name descname">plot_noise_chararcteristics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fields</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_noise_chararcteristics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_noise_chararcteristics" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>fields</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_various_noise_fits">
<code class="sig-name descname">plot_various_noise_fits</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_various_noise_fits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_various_noise_fits" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_various_noise_repr">
<code class="sig-name descname">plot_various_noise_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_various_noise_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_various_noise_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.MFN.plot_various_timesignals">
<code class="sig-name descname">plot_various_timesignals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fields</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_various_timesignals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.plot_various_timesignals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a grid of 9 subplots with different timesignals
:param fields: list
:param nrows: int Default: len(fields)
:param ncols: int Default: 2
:param sharey: bool Default: True
:param figsize: tuple Default: (11.69, 8.27) in
:param plot_range: int Default: -1</p>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.spectra_field_contour">
<code class="sig-name descname">spectra_field_contour</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.spectra_field_contour"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.spectra_field_contour" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.subtract_mean">
<code class="sig-name descname">subtract_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.subtract_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.subtract_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts mean value from timesignal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> (<em>bool</em>) – Change variable inside this object?</p></li>
<li><p><strong>fields</strong> – list of fields to fit</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>normalized timesignal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MFN.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MFN.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="low-level-python-backend">
<h2><a class="toc-backref" href="#toc-entry-6" role="doc-backlink">Low Level Python Backend</a><a class="headerlink" href="#low-level-python-backend" title="Permalink to this headline">¶</a></h2>
<section id="measurementclass">
<h3><a class="toc-backref" href="#toc-entry-7" role="doc-backlink">MeasurementClass</a><a class="headerlink" href="#measurementclass" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.measurement.MeasurementClass">
<em class="property">class </em><code class="sig-name descname">MeasurementClass</code><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.measurement.MeasurementClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The main measurement class for all measurements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>MeasurementClass:</strong>
This Class is the parent of all other measurement classes.</p>
</aside>
<p>All measurements have the following variables:</p>
<dl class="simple">
<dt>name: str/None</dt><dd><p>The name of the Measurement Class (e.g. SA, RAW, etc.)</p>
</dd>
<dt>info: dict</dt><dd><dl class="simple">
<dt>Contains informations about the measurement. Typical keys are:</dt><dd><p>Nr: float, the number of the measurement,</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="ana.measurement.MeasurementClass.calc_log">
<code class="sig-name descname">calc_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">keys</span><span class="o">=</span><span class="default_value">['f', 'Vx', 'Vy']</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass.calc_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.measurement.MeasurementClass.calc_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.measurement.MeasurementClass.get_info_from_name">
<code class="sig-name descname">get_info_from_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass.get_info_from_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.measurement.MeasurementClass.get_info_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‘key-value’ pairs
separated by ‘_’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.measurement.MeasurementClass.i">
<code class="sig-name descname">i</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass.i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.measurement.MeasurementClass.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> – <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#system-message-2"><span class="problematic" id="problematic-2">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="singlem">
<h3><a class="toc-backref" href="#toc-entry-8" role="doc-backlink">SingleM</a><a class="headerlink" href="#singlem" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.SingleM">
<em class="property">class </em><code class="sig-name descname">SingleM</code><a class="reference internal" href="../../_modules/ana/single.html#SingleM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.SingleM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.measurement.MeasurementClass" title="ana.measurement.MeasurementClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.measurement.MeasurementClass</span></code></a></p>
<p>The main constructor for all single measurements.</p>
<dl class="py method">
<dt id="ana.SingleM.calc_log">
<code class="sig-name descname">calc_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">keys</span><span class="o">=</span><span class="default_value">['f', 'Vx', 'Vy']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.calc_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.SingleM.fit_variable">
<code class="sig-name descname">fit_variable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/single.html#SingleM.fit_variable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.SingleM.fit_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SingleM.get_info_from_name">
<code class="sig-name descname">get_info_from_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.get_info_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‘key-value’ pairs
separated by ‘_’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SingleM.i">
<code class="sig-name descname">i</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> – <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#system-message-4"><span class="problematic" id="problematic-4">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SingleM.linear_regression">
<code class="sig-name descname">linear_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.linear_regression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<section id="raw">
<h4><a class="toc-backref" href="#toc-entry-9" role="doc-backlink">RAW</a><a class="headerlink" href="#raw" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ana.RAW">
<em class="property">class </em><code class="sig-name descname">RAW</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ana.single.SingleM</span></code></p>
<dl class="simple">
<dt>RAW Measurement:</dt><dd><p>Measurements with time signal only.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="container-2">
<div class="code-block-caption"><span class="caption-number">Listing 5 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-2" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>
     <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s1">&#39;Add Info&#39;</span><span class="p">:</span> <span class="s1">&#39;Important Informations&#39;</span><span class="p">}</span>
     <span class="p">}</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">ana</span><span class="o">.</span><span class="n">RAW</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Different possibilities.</p></li>
<li><p><strong>rate</strong> (<em>float</em><em>, </em><em>default: 2e-4</em>) – At which rate was the timesignal measured (samplingrate) [Hz]</p></li>
<li><p><strong>nof_first_spectra</strong> (<em>int</em><em>, </em><em>default: 64</em>) – Cut timesignal into # pieces and average.</p></li>
<li><p><strong>first_spectra_highest_frequency</strong> (<em>float</em><em>, </em><em>default: rate/8</em>) – Cut higher frequencies in final spectrum than this.</p></li>
<li><p><strong>downsample</strong> – Downsample the timesignal before calculation.</p></li>
<li><p><strong>calc_first</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Triggers calculation of first spectrum.</p></li>
<li><p><strong>highest_octave</strong> (<em>int</em><em>, </em><em>default: 64</em>) – The highest octave starting point [Hz] of the second spectrum.</p></li>
<li><p><strong>minimum_points_in_octave</strong> (<em>int</em><em>, </em><em>default: 10</em>) – If octave would contain less points, stop.</p></li>
<li><p><strong>calc_second</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Triggers calculation of second spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Info<span class="colon">:</span></dt>
<dd class="field-even"><p>First Spectrum parameters</p>
</dd>
<dt class="field-odd">Info<span class="colon">:</span></dt>
<dd class="field-odd"><p>Second Spectrum parameters</p>
</dd>
</dl>
<dl class="py method">
<dt id="ana.RAW.calc_first_spectrum">
<code class="sig-name descname">calc_first_spectrum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.calc_first_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.calc_first_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the variable <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> to a
<code class="xref py py-class docutils literal notranslate"><span class="pre">spectrumanalyzer.SpectrumAnalyzer</span></code> object.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Calculates the first spectrum.</p>
</aside>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NameError</strong> – spectrumanalyzer is not installed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.calc_log">
<code class="sig-name descname">calc_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">keys</span><span class="o">=</span><span class="default_value">['f', 'Vx', 'Vy']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.calc_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.RAW.calc_second_spectrum">
<code class="sig-name descname">calc_second_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.calc_second_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.calc_second_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating the second spectrum.</p>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.calc_time_signal_second_spectrum">
<code class="sig-name descname">calc_time_signal_second_spectrum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.calc_time_signal_second_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.calc_time_signal_second_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.RAW.check_timesignal">
<code class="sig-name descname">check_timesignal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timesignal</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.check_timesignal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.check_timesignal" title="Permalink to this definition">¶</a></dt>
<dd><p>converts pd.DataFrame[‘Vx’] and Series into numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timesignal</strong> – input timesignal</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted timesignal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.fit_variable">
<code class="sig-name descname">fit_variable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.fit_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.get_info_from_name">
<code class="sig-name descname">get_info_from_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.get_info_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‘key-value’ pairs
separated by ‘_’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.i">
<code class="sig-name descname">i</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> – <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#system-message-6"><span class="problematic" id="problematic-6">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.linear_regression">
<code class="sig-name descname">linear_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.linear_regression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.RAW.plot_spectrum">
<code class="sig-name descname">plot_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.plot_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.plot_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.RAW.plot_time">
<code class="sig-name descname">plot_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.plot_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.plot_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.RAW.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reading data from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – </p></li>
<li><p><strong>base to read data from.</strong> (<em>Filename</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.subtract_mean">
<code class="sig-name descname">subtract_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.subtract_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.subtract_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts mean value from timesignal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Change variable inside this object?</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>normalized timesignal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.RAW.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.RAW.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writing data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="sa">
<h4><a class="toc-backref" href="#toc-entry-10" role="doc-backlink">SA</a><a class="headerlink" href="#sa" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ana.SA">
<em class="property">class </em><code class="sig-name descname">SA</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/signalanalyzer.html#SA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.SA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ana.single.SingleM</span></code></p>
<p>Loads and analyzes datafiles from <a href="#system-message-7"><span class="problematic" id="problematic-7">:instrument:`SR785`</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>* ValueError</strong> – </p>
</dd>
</dl>
<dl class="py method">
<dt id="ana.SA.calc_log">
<code class="sig-name descname">calc_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">keys</span><span class="o">=</span><span class="default_value">['f', 'Vx', 'Vy']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.calc_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.SA.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_range</span><span class="o">=</span><span class="default_value">(0.01, 0.7)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/signalanalyzer.html#SA.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.SA.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a linear regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>tuple</strong> (<em>fit_range</em>) – (1e-2, 1e0).):</p></li>
<li><p><strong>optional</strong> – (1e-2, 1e0).):</p></li>
<li><p><strong>default</strong> – (1e-2, 1e0).):</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SA.fit_variable">
<code class="sig-name descname">fit_variable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.fit_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SA.get_info_from_name">
<code class="sig-name descname">get_info_from_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.get_info_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‘key-value’ pairs
separated by ‘_’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SA.i">
<code class="sig-name descname">i</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> – <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#system-message-9"><span class="problematic" id="problematic-9">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.SA.linear_regression">
<code class="sig-name descname">linear_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.linear_regression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.SA.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/signalanalyzer.html#SA.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.SA.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the Data on given Axis or creating a new Plot for plotting.</p>
<div class="literal-block-wrapper docutils container" id="container-3">
<div class="code-block-caption"><span class="caption-number">Listing 6 </span><span class="caption-text">Signature</span><a class="headerlink" href="#container-3" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">plot_x</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">plot_y</span><span class="o">=</span><span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>

        <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">),</span> <span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;f [Hz]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;S_VH [V2/Hz]&#39;</span><span class="p">,</span>

<span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – </p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <strong>dont_set_plot_settings</strong> is True, all kwargs below are not
used.</p>
</aside>
</dd></dl>

</dd></dl>

</section>
<section id="hloop">
<h4><a class="toc-backref" href="#toc-entry-11" role="doc-backlink">Hloop</a><a class="headerlink" href="#hloop" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="ana.Hloop">
<em class="property">class </em><code class="sig-name descname">Hloop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">measurement_number</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ana.single.SingleM</span></code></p>
<p>This class represents the measurement of a hysteresis loop. It evaluates
and plots the data.</p>
<p>It collects all files that match the following regex:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/Hloop/[mM]</span><span class="si">%s</span><span class="s2">_*.dat&quot;</span> <span class="o">%</span> <span class="n">measurement_number</span><span class="p">)</span>
</pre></div>
</div>
<p>The files should contain a file that contains the word “up” or “down”
indicating the direction of the field sweep.</p>
<p>If one file contains the word ‘Gradio’ it expects a gradiometry
measurement. If the filename contains the word ‘Parallel’ it expects a
parallel measurement. If the filename contains neither of these words the
variables need to be set manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>measurement_number</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="ana.Hloop.calc_B">
<code class="sig-name descname">calc_B</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">V</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.calc_B"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.calc_B" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>V</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.calc_log">
<code class="sig-name descname">calc_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">keys</span><span class="o">=</span><span class="default_value">['f', 'Vx', 'Vy']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.calc_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.Hloop.calculate_fitted_strayfield">
<code class="sig-name descname">calculate_fitted_strayfield</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.calculate_fitted_strayfield"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.calculate_fitted_strayfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the strayfield of the fitted signal and stores it in up
and down sweeps.</p>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.calculate_strayfield">
<code class="sig-name descname">calculate_strayfield</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.calculate_strayfield"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.calculate_strayfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the strayfield of the signal and stores it in up and down
sweeps.</p>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">cond=Series([]</em>, <em class="sig-param">dtype: float64)</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fitting the Voltage Signal.</p>
<p>For Parallel measurement:</p>
<blockquote>
<div><p>the empty cross Vx13 is subtracted from the signal Vx8/Vx9</p>
</div></blockquote>
<p>For gradiometry:</p>
<blockquote>
<div><p>A condition can be added to determine the amount of
datapoints to fit (default: B &lt; B_min + 150mT).</p>
</div></blockquote>
<div class="literal-block-wrapper docutils container" id="container-4">
<div class="code-block-caption"><span class="caption-number">Listing 7 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-4" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>
 <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cond</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.fit_variable">
<code class="sig-name descname">fit_variable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.fit_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_bhminmax">
<code class="sig-name descname">get_bhminmax</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_bhminmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_bhminmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum and maximum of the measured hall voltage
converted to strayfield.</p>
<div class="literal-block-wrapper docutils container" id="container-5">
<div class="code-block-caption"><span class="caption-number">Listing 8 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-5" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bhmin</span><span class="p">,</span> <span class="n">bhmax</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_coercive_field">
<code class="sig-name descname">get_coercive_field</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_coercive_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_coercive_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean and coercive fields calculated.</p>
<div class="literal-block-wrapper docutils container" id="container-6">
<div class="code-block-caption"><span class="caption-number">Listing 9 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-6" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">,</span> <span class="n">coer1</span><span class="p">,</span> <span class="n">coer2</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_coercive_field</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coercive Field (up sweep): (</span><span class="si">%.3f</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coer1</span><span class="p">,</span> <span class="n">mean</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coercive Field (down sweep): (</span><span class="si">%.3f</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coer2</span><span class="p">,</span> <span class="n">mean</span><span class="p">))</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_default_title">
<code class="sig-name descname">get_default_title</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_default_title"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_default_title" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_downminusup">
<code class="sig-name descname">get_downminusup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">100000.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_downminusup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_downminusup" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the magnetic field and difference between down and up sweep.</p>
<div class="literal-block-wrapper docutils container" id="container-7">
<div class="code-block-caption"><span class="caption-number">Listing 10 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-7" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">B</span><span class="p">,</span> <span class="n">Vx</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">Vx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_downminusup_strayfield">
<code class="sig-name descname">get_downminusup_strayfield</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">100000.0</span></em>, <em class="sig-param"><span class="n">fitted_data</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_downminusup_strayfield"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_downminusup_strayfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the magnetic field and difference between down and up sweep.</p>
<div class="literal-block-wrapper docutils container" id="container-8">
<div class="code-block-caption"><span class="caption-number">Listing 11 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-8" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B_ext</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">Bx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – </p></li>
<li><p><strong>fitted_data</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_info_from_name">
<code class="sig-name descname">get_info_from_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.get_info_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‘key-value’ pairs
separated by ‘_’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_minmax">
<code class="sig-name descname">get_minmax</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_minmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_minmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum and maximum of the field and voltage.</p>
<div class="literal-block-wrapper docutils container" id="container-9">
<div class="code-block-caption"><span class="caption-number">Listing 12 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-9" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.get_remanence">
<code class="sig-name descname">get_remanence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_remanence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.get_remanence" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the remanent voltage calculated.</p>
<div class="literal-block-wrapper docutils container" id="container-10">
<div class="code-block-caption"><span class="caption-number">Listing 13 </span><span class="caption-text">Example</span><a class="headerlink" href="#container-10" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rem1</span><span class="p">,</span> <span class="n">rem2</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_remanence</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remanent Voltage (up sweep): (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rem1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remanent Voltage (down sweep): (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rem2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.i">
<code class="sig-name descname">i</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> – <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#system-message-11"><span class="problematic" id="problematic-11">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.linear_regression">
<code class="sig-name descname">linear_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.linear_regression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.Hloop.plot_downminusup">
<code class="sig-name descname">plot_downminusup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">figtitle</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_downminusup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.plot_downminusup" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the difference between the down and up sweep. ax: Matplotlib
Axis to plot on. figtitle: can be set to a manual figure title.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>figtitle</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.plot_hloop">
<code class="sig-name descname">plot_hloop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">figtitle</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_fitted</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_rem</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_coer</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_hloop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.plot_hloop" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the hysteresis loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – Matplotlib Axis to plot on.</p></li>
<li><p><strong>figtitle</strong> – can be set to a manual figure title.</p></li>
<li><p><strong>show_fitted</strong> – plot the fitted curve.</p></li>
<li><p><strong>show_rem</strong> – show the remanent voltage.</p></li>
<li><p><strong>show_coer</strong> – show the coercive field.</p></li>
<li><p><strong>show_original</strong> – plots the RAW data.</p></li>
<li><p><strong>show_linear_fit</strong> – plots the linear fitting line used for the fit</p></li>
</ul>
</dd>
</dl>
<p>(only gradiometry).</p>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.plot_hysteresis">
<code class="sig-name descname">plot_hysteresis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">'B'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_hysteresis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.plot_hysteresis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.Hloop.plot_strayfield">
<code class="sig-name descname">plot_strayfield</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">figtitle</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_strayfield"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.plot_strayfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the strayfield of the data. Strayfield is calculated using the
electron concentration at 0 degree measured before
(hardcoded in __init__).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.axis</em>) – where should we plot.</p></li>
<li><p><strong>figtitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Choose your own title above the figure.</p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.remove_zero">
<code class="sig-name descname">remove_zero</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">columns</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.remove_zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.remove_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the values 0.0 from up and down sweep where the lock-in
didn’t return any values (read error will be saved as 0.0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>columns</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.Hloop.set_factor">
<code class="sig-name descname">set_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">factor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.set_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.Hloop.set_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplying the Voltage by a Factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>factor</strong> – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="multiplem">
<h3><a class="toc-backref" href="#toc-entry-12" role="doc-backlink">MultipleM</a><a class="headerlink" href="#multiplem" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.MultipleM">
<em class="property">class </em><code class="sig-name descname">MultipleM</code><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MultipleM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.measurement.MeasurementClass" title="ana.measurement.MeasurementClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.measurement.MeasurementClass</span></code></a></p>
<p>MultipleM:</p>
<p>Main parent class for all multiple measurements. These Measurements
are represent by one data variable.</p>
<p>All multiple measurements have a variable called <code class="docutils literal notranslate"><span class="pre">multi_info</span></code> which
contains a pandas.DataFrame with parameter settings to single
measurements.</p>
<p>All multiple measurements can be represented by</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">ana</span><span class="o">.</span><span class="n">MultipleM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">Nr. 0: Hloop</span>
<span class="go">Nr. 0: RAW</span>
</pre></div>
</div>
<dl class="py method">
<dt id="ana.MultipleM.calc_log">
<code class="sig-name descname">calc_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">keys</span><span class="o">=</span><span class="default_value">['f', 'Vx', 'Vy']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.calc_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.MultipleM.get_info_from_name">
<code class="sig-name descname">get_info_from_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.get_info_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‘key-value’ pairs
separated by ‘_’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MultipleM.get_lofm">
<code class="sig-name descname">get_lofm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span></em>, <em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM.get_lofm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MultipleM.get_lofm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns the List of Measurements (lofm) for plot functions</dt><dd><p>(see <a class="reference internal" href="#ana.HandleM.plot" title="ana.HandleM.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ana.HandleM.plot()</span></code></a>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>dict</em>) – Measurement Numbers pointing to label format
variables: e.g. <code class="docutils literal notranslate"><span class="pre">{nr:</span> <span class="pre">[(-1,</span> <span class="pre">1),</span> <span class="pre">'Plusses',</span> <span class="pre">'5</span> <span class="pre">mT/min']}</span></code></p></li>
<li><p><strong>label</strong> (<em>str</em>) – Label to show in plots: e.g.
<code class="docutils literal notranslate"><span class="pre">&quot;Show</span> <span class="pre">%s</span> <span class="pre">-&gt;</span> <span class="pre">%s</span> <span class="pre">(%s)</span> <span class="pre">%s</span> <span class="pre">&quot;</span></code> -&gt; will be string formated using
to_show</p></li>
<li><p><strong>(</strong><strong>dict</strong> (<em>options</em>) – empty): Additional plotting
parameters</p></li>
<li><p><strong>optional</strong> – empty): Additional plotting
parameters</p></li>
<li><p><strong>default</strong> – empty): Additional plotting
parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of Measurements with description: <code class="docutils literal notranslate"><span class="pre">{nr:</span> <span class="pre">[labels]}</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MultipleM.get_lofm_sweeps">
<code class="sig-name descname">get_lofm_sweeps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">to_show</span></em>, <em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM.get_lofm_sweeps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MultipleM.get_lofm_sweeps" title="Permalink to this definition">¶</a></dt>
<dd><p>Workaround to get list of measurements for sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>dict</em>) – Measurement Numbers pointing to label format
variables: e.g. `` {nr: [-1, 1, ‘Plusses’, ‘2 mT/min’]}</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Label to show in plots: e.g. “Show %s -&gt; %s (%s) %s ”
-&gt; will be formated using to_show</p></li>
<li><p><strong>(</strong><strong>dict</strong> (<em>options</em>) – empty): Additional plotting options</p></li>
<li><p><strong>default</strong> – empty): Additional plotting options</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of Measurements with description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MultipleM.i">
<code class="sig-name descname">i</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> – <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#system-message-13"><span class="problematic" id="problematic-13">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.MultipleM.query">
<code class="sig-name descname">query</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">request</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.query" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.MultipleM.read_csv">
<code class="sig-name descname">read_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM.read_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.MultipleM.read_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates multi_info DataFrame. Reads csv and adds information to
self.multi_info</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="plottingclass">
<h3><a class="toc-backref" href="#toc-entry-13" role="doc-backlink">PlottingClass</a><a class="headerlink" href="#plottingclass" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="ana.plotting.PlottingClass">
<em class="property">class </em><code class="sig-name descname">PlottingClass</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">style</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the basic plotting style.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**style</strong> – </p>
</dd>
</dl>
<dl class="py method">
<dt id="ana.plotting.PlottingClass.draw_oneoverf">
<code class="sig-name descname">draw_oneoverf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.draw_oneoverf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass.draw_oneoverf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>**kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plotting.PlottingClass.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.plotting.PlottingClass.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="ana.plotting.PlottingClass.get_style">
<code class="sig-name descname">get_style</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">custom</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.get_style"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass.get_style" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>custom</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plotting.PlottingClass.save_plot">
<code class="sig-name descname">save_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">fext</span><span class="o">=</span><span class="default_value">'png'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.save_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass.save_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current plot as file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Filename</p></li>
<li><p><strong>fext</strong> (<em>str</em>) – Extension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plotting.PlottingClass.set_plot_settings">
<code class="sig-name descname">set_plot_settings</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.set_plot_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass.set_plot_settings" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plotting.PlottingClass.set_style">
<code class="sig-name descname">set_style</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">style</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.set_style"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass.set_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the Style for plots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>dict</em><em>, </em><em>None</em><em>, or </em><em>one of {paper</em><em>, </em><em>notebook</em><em>, </em><em>talk</em><em>, </em><em>poster}</em>) – A dictionary of parameters or the name of a preconfigured set.</p></li>
<li><p><strong>style</strong> (<em>dict</em><em>, </em><em>None</em><em>, or </em><em>one of {darkgrid</em><em>, </em><em>whitegrid</em><em>, </em><em>dark</em><em>, </em><em>white</em><em>, </em><em>ticks}</em>) – </p></li>
<li><p><strong>default</strong> (<em>bool</em>) – if True it sets default
<code class="code docutils literal notranslate"><span class="pre">size=talk</span></code> and
<code class="code docutils literal notranslate"><span class="pre">style=whitegrid</span></code></p></li>
<li><p><strong>notebook</strong> (<em>bool</em>) – if True it sets default
<code class="code docutils literal notranslate"><span class="pre">size=notebook</span></code> and
<code class="code docutils literal notranslate"><span class="pre">style=ticks</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ana.plotting.PlottingClass.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.plotting.PlottingClass.update" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-ana.functions">
<span id="functions"></span><h3><a class="toc-backref" href="#toc-entry-14" role="doc-backlink">Functions</a><a class="headerlink" href="#module-ana.functions" title="Permalink to this headline">¶</a></h3>
<p>Helps to handle measurements and style plots.</p>
<dl class="py function">
<dt id="ana.functions.getpath">
<code class="sig-name descname">getpath</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">arg</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/functions.html#getpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.functions.getpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">glob</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*arg</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ana.functions.timing">
<code class="sig-name descname">timing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/functions.html#timing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ana.functions.timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps a function to measure the time it takes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="source-code">
<h2><a class="toc-backref" href="#toc-entry-15" role="doc-backlink">Source Code</a><a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h2>
<section id="plot-1">
<h3><a class="toc-backref" href="#toc-entry-16" role="doc-backlink">Plot</a><a class="headerlink" href="#plot-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">   1</span>
<span class="normal">   2</span>
<span class="normal">   3</span>
<span class="normal">   4</span>
<span class="normal">   5</span>
<span class="normal">   6</span>
<span class="normal">   7</span>
<span class="normal">   8</span>
<span class="normal">   9</span>
<span class="normal">  10</span>
<span class="normal">  11</span>
<span class="normal">  12</span>
<span class="normal">  13</span>
<span class="normal">  14</span>
<span class="normal">  15</span>
<span class="normal">  16</span>
<span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A small class used to plot figures for a presentation.&quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">meas</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="mi">57</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span> <span class="o">=</span> <span class="n">HandleM</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data/SR785&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)),</span>
                               <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span><span class="nb">dict</span><span class="p">())</span>
                               <span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>

        <span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;talk&#39;</span><span class="p">),</span>
                          <span class="n">style</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;ticks&#39;</span><span class="p">),</span>
                          <span class="n">palette</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;palette&#39;</span><span class="p">,</span> <span class="s1">&#39;deep&#39;</span><span class="p">),</span>
                          <span class="n">grid</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                          <span class="n">latex</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
                          <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_single_hloop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">54</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-single-1&#39;</span><span class="p">,</span>
                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a single measurement. Default: 0deg</span>

<span class="sd">        Args:</span>
<span class="sd">            nr:</span>
<span class="sd">            filename (str, optional): File to write. The default is</span>
<span class="sd">                &#39;hloop-single-1&#39;.</span>
<span class="sd">            xlim / ylim: limit the plots axes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            {filename}.pdf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.64</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-1&#39;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares Plusses and Crosses between two angles (4 Subplots).</span>
<span class="sd">        Default: 0 and 45 Writes file hloop-compare-1.pdf</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (list, optional): List of 4 measurement numbers, </span>
<span class="sd">                defaults to [54, 55]</span>
<span class="sd">            filename (str, optional): DESCRIPTION, defaults to &#39;hloop-compare-1&#39;</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">plot_args</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span><span class="nb">dict</span><span class="p">()))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">4.45</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff_yticks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

        <span class="n">title_style</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bfseries </span><span class="se">\\</span><span class="s1">Huge &#39;</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="p">[</span><span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_style</span> <span class="o">+</span> <span class="n">struct</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = +45^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">,</span>
          <span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = -45^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.8</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.8</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="mf">3.45</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="mf">3.45</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops_95</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-95&#39;</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares +95/100/105/110deg with -85/80/75/70deg for (180deg</span>
<span class="sd">        Comparison)</span>

<span class="sd">        :param filename:Filename to save. The default is &#39;hloop-compare-95&#39;.</span>
<span class="sd">        :type filename: str, optional</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (list, optional): Measurement numbers to plot. The default</span>
<span class="sd">                is a[95]+a[-85].</span>
<span class="sd">            filename:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            {filename}.pdf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Crosses&#39;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;crosses_xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crosses_xlim&#39;</span><span class="p">))</span>

            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="c1"># inset.set_ylabel(&quot;$\Delta B_z\\;[\\mathrm{mT}]$&quot;)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Crosses&#39;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                        <span class="s1">&#39;crosses_xlim&#39;</span><span class="p">):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crosses_xlim&#39;</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops_90</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">155</span><span class="p">],</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-90&#39;</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares +90deg with -90deg for (180deg Comparison)</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [57,155].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-compare-90&#39;.</span>
<span class="sd">            **kwargs (TYPE): mirror: bool, optional</span>
<span class="sd">                    should we mirror the hloop? The default is False</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">))</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">cur_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                   <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># Plusses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="sd">&quot;&quot;&quot;if nr == 57:</span>
<span class="sd">                ax.set_title(&#39;m57: Plusses ($90^\circ$)&#39;)</span>
<span class="sd">            else:</span>
<span class="sd">                ax.set_title(&#39;m155: Plusses ($-90^\circ$)&#39;)&quot;&quot;&quot;</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">)):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">(</span>
                    <span class="n">fitted_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference (fitted)&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff_yticks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>

            <span class="c1"># Crosses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="sd">&quot;&quot;&quot;if nr == 57:</span>
<span class="sd">                ax.set_title(&#39;M57: Crosses ($90^\circ$)&#39;)</span>
<span class="sd">            else:</span>
<span class="sd">                ax.set_title(&#39;M155: Crosses ($-90^\circ$)&#39;)&quot;&quot;&quot;</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
                <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference (fitted)&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>

        <span class="n">title_style</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bfseries </span><span class="se">\\</span><span class="s1">Huge &#39;</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Crosses&#39;</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_style</span> <span class="o">+</span> <span class="n">struct</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = +90^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">,</span>
                          <span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = -90^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops_90_nofit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">155</span><span class="p">],</span>
                             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-90&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares +90deg with -90deg for (180deg Comparison) Using not fitted</span>
<span class="sd">        data</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [57,155].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-compare-90&#39;.</span>
<span class="sd">            **kwargs (TYPE): mirror: bool, optional</span>
<span class="sd">                    should we mirror the hloop? The default is False</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">))</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">cur_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                   <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># Plusses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (Empty)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (Empty)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Plusses ($90^\circ$)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M155: Plusses ($-90^\circ$)&#39;</span><span class="p">)</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">)):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.59</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>

            <span class="c1"># Crosses</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (Empty)&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (Empty)&#39;</span><span class="p">)</span>

            <span class="c1"># Set Limits (x and y Axis)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Crosses ($90^\circ$)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M155: Crosses ($-90^\circ$)&#39;</span><span class="p">)</span>

            <span class="c1"># Inset with Difference</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
                <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.5$&#39;</span><span class="p">])</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.5$&#39;</span><span class="p">])</span>

            <span class="c1"># if nr == 57 and not kwargs.get(&#39;mirror&#39;):</span>
            <span class="c1">#    ax.legend(loc=&#39;upper left&#39;)#, ncol=2)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">],</span>
                     <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Outputs hloop-compare-3.pdf (not used anymore)</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is a[85]+a[100].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-compare-3&#39;.</span>
<span class="sd">            **kwargs (TYPE): DESCRIPTION.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">58</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]):</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
                     <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-repeat&#39;</span><span class="p">,</span>
                     <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="mi">350</span><span class="p">),</span>
                     <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">inset_xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                     <span class="n">inset_ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)</span>
                     <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compares two measurements at the same Angle (repeated</span>
<span class="sd">            measurements).</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [139,140].</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-repeat&#39;.</span>
<span class="sd">            xlim (TYPE, optional): DESCRIPTION. The default is (-350, 350).</span>
<span class="sd">            ylim:</span>
<span class="sd">            inset_xlim (TYPE, optional): DESCRIPTION. The default is (-30, 30).</span>
<span class="sd">            inset_ylim (TYPE, optional): DESCRIPTION. The default is (.15,</span>
<span class="sd">                1.25).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="c1"># ax = axes[i//2][i%2]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">bmin1</span><span class="p">,</span> <span class="n">bmax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
            <span class="n">bmin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bmin1</span><span class="p">)</span>
            <span class="n">bmax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bmax1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bmin</span><span class="p">)</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bmax</span><span class="p">)</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;M</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> ($</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span>
                                                       <span class="s1">&#39;Structure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                                                       <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\_&#39;</span><span class="p">),</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span>
                                                       <span class="s1">&#39;Angle&#39;</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">])</span>
        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.055</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset2</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_ylim</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.43</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop_gradient3</span><span class="p">(</span><span class="n">inset3</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="n">to_show</span><span class="p">,</span>
                                      <span class="n">limit</span><span class="o">=</span><span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
            <span class="c1"># inset3.set_xticklabels([&#39;&#39;])</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops_compare_90</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">414</span><span class="p">,</span> <span class="mi">415</span><span class="p">],</span>
                               <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;plusses&#39;</span><span class="p">,</span>
                               <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-repeat-414&#39;</span><span class="p">,</span>
                               <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span>
                               <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.36</span><span class="p">,</span> <span class="mf">.76</span><span class="p">),</span>
                               <span class="n">inset_xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">),</span>
                               <span class="n">inset_ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.75</span><span class="p">),</span>
                               <span class="n">insets</span><span class="o">=</span><span class="p">[((</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.75</span><span class="p">),</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">))],</span>
                               <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
                               <span class="n">nograd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">nodiff</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                               <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compares multiple measurements at 90 deg (repeated</span>
<span class="sd">            measurements).</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [414,415].</span>
<span class="sd">            structure:</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-repeat-414&#39;.</span>
<span class="sd">            xlim (TYPE, optional): DESCRIPTION. The default is (-750, 750).</span>
<span class="sd">            ylim:</span>
<span class="sd">            inset_xlim (TYPE, optional): DESCRIPTION. The default is (-100,</span>
<span class="sd">                100).</span>
<span class="sd">            inset_ylim (TYPE, optional): DESCRIPTION. The default is (-1.25,</span>
<span class="sd">                .75).</span>
<span class="sd">            legend_loc:</span>
<span class="sd">            nograd:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Bx8&#39;</span>
        <span class="k">elif</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;crosses&#39;</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Bx9&#39;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
            <span class="c1"># ax = axes[i//2][i%2]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>  <span class="c1"># Load measurement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">remove_zero</span><span class="p">()</span>  <span class="c1"># Remove measurement Errors</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">show_plusses</span><span class="o">=</span><span class="p">(</span>
                                                  <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">),</span>
                                          <span class="n">show_crosses</span><span class="o">=</span><span class="p">(</span>
                                                  <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;crosses&#39;</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>

            <span class="n">legend</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;m</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">,</span> <span class="s2">&quot;m</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">]</span>

        <span class="n">m_numbers</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">to_show</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">textbf{</span><span class="si">%s</span><span class="s2">} ($</span><span class="si">%s</span><span class="s2">^{</span><span class="se">\\</span><span class="s2">circ}$)&quot;</span> <span class="o">%</span> <span class="p">(</span>
                                                <span class="n">structure</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">all_insets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nodiff</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">:</span>
                        <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">(</span>
                            <span class="n">fitted_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span>
                        <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span>
                        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
                        <span class="n">B_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
                        <span class="n">B_stray</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B_ext</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B_ext</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>

        <span class="n">subfig</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">bbox</span><span class="p">,</span> <span class="p">(</span><span class="n">inset_xlim</span><span class="p">,</span> <span class="n">inset_ylim</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="ow">in</span> <span class="n">insets</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset2</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
                    <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
                <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_ylim</span><span class="p">)</span>

            <span class="p">(</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">ann_xx</span><span class="p">),</span> <span class="p">(</span><span class="n">ann_yy</span><span class="p">,</span> <span class="n">ann_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">inset2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="n">inset2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ann_x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ann_xx</span> <span class="o">-</span> <span class="n">ann_x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.05</span>
            <span class="n">ann_y</span> <span class="o">-=</span> <span class="p">(</span><span class="n">ann_y</span> <span class="o">-</span> <span class="n">ann_yy</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.20</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ann_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">subfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span>
                          <span class="n">fontdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
                          <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.1&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;#ccf&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

            <span class="c1"># Draw Area into big plot</span>
            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nograd</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
                <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.08</span><span class="p">,</span> <span class="mf">.67</span><span class="p">,</span> <span class="mf">.27</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset3</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop_gradient3</span><span class="p">(</span><span class="n">inset3</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                          <span class="n">column</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_show</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">all_insets</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloops4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-parallel&#39;</span><span class="p">,</span>
                     <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;M57: $90^</span><span class="se">\\</span><span class="s2">circ$ Parallel measurement&quot;</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a single measurement (default: 90deg parallel)</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="sd">                &#39;hloop-parallel&#39;.</span>
<span class="sd">            figtitle (TYPE, optional): DESCRIPTION. The default is &quot;M57:</span>
<span class="sd">                $90^\circ$ Parallel measurement&quot;.</span>
<span class="sd">            **kwargs (TYPE): DESCRIPTION.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># self.mset_factor(-1)</span>
        <span class="c1"># self.mfactor = 1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span>
                               <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span> <span class="o">+=</span> <span class="mf">.25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span> <span class="o">+=</span> <span class="mf">.25</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">.46</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.23</span><span class="p">)</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference Plusses&quot;</span><span class="p">)</span>

            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.22</span><span class="p">)</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
            <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
            <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                        <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference Crosses&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_cubes_trees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots difference between RAW data from Cubes and Trees (1st</span>
<span class="sd">        Generation)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data/Data/</span><span class="si">%s</span><span class="s1">deg_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">struct</span><span class="p">)</span> <span class="k">for</span>
                     <span class="n">angle</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">]</span> <span class="k">for</span>
                     <span class="n">struct</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cubes&#39;</span><span class="p">,</span> <span class="s1">&#39;Trees&#39;</span><span class="p">]</span>
                     <span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_list</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">load_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">.dat&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span> <span class="k">for</span>
                          <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span>
            <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">file_list</span><span class="o">=</span><span class="n">load_files</span><span class="p">)</span>
            <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$V_x [</span><span class="se">\\</span><span class="s2">mathrm{</span><span class="se">\\</span><span class="s2">mu V}]$&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu_0 H_</span><span class="si">{ext}</span><span class="s2">$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
            <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;cubes&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">struct</span> <span class="o">=</span> <span class="s1">&#39;Cubes&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">struct</span> <span class="o">=</span> <span class="s2">&quot;Trees&quot;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> ($</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)))</span>

            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.69</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
                <span class="c1"># inset.set_title(&quot;Difference&quot;)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;compare-cubes-trees.pdf&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloop_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-gradient&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>

<span class="sd">        Args:</span>
<span class="sd">            limit:</span>
<span class="sd">            filename:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">grad1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
                 <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
        <span class="n">grad12</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">grad1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">grad12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Plusses&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Crosses&#39;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Gradient (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                    <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                    <span class="n">g2</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloop_gradient2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-gradient&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>

<span class="sd">        Args:</span>
<span class="sd">            limit:</span>
<span class="sd">            filename:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: Gradient (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Up&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span>
                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Down&#39;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                    <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloop_gradient3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                             <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Vx8&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>

<span class="sd">        Args:</span>
<span class="sd">            ax:</span>
<span class="sd">            to_show:</span>
<span class="sd">            limit:</span>
<span class="sd">            column:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.m.style.set_style(default=True, grid=True,</span>
        <span class="c1">#        style=&#39;ticks&#39;,</span>
        <span class="c1">#        size=&#39;talk&#39;,</span>
        <span class="c1">#        palette=&#39;Paired&#39;,</span>
        <span class="c1">#        latex=True,)</span>

        <span class="n">limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gradient&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">column</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;Up&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;Down&#39;</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
                        <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">direction</span><span class="p">))</span>

        <span class="c1"># ax.set_xlim(-limit, limit)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_hloop_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the Temperature of a Hloop measurement.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: Sample Temperature&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Sample Temp&#39;</span><span class="p">]),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Sample Temp&#39;</span><span class="p">]),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $[</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mK}</span><span class="s1">]$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hloop-90-temp.pdf&#39;</span><span class="p">)</span>

    <span class="c1">#### Plot Static Fields</span>
    <span class="k">def</span> <span class="nf">plot_static_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;static-field&#39;</span><span class="p">,</span>
                           <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the Signal Analyzer (SA) Data for static fields (not sweeping)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Plusses (25 mT)&#39;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
            <span class="s1">&#39;Plusses (-25 mT)&#39;</span><span class="p">:</span> <span class="mi">361</span><span class="p">,</span>
            <span class="s1">&#39;Plusses (-9.4 mT)&#39;</span><span class="p">:</span> <span class="mi">282</span><span class="p">,</span>
            <span class="s1">&#39;Crosses (-9.4 mT)&#39;</span><span class="p">:</span> <span class="mi">283</span><span class="p">,</span>
            <span class="s1">&#39;Plusses (0 T)&#39;</span><span class="p">:</span> <span class="mi">281</span><span class="p">,</span>
            <span class="s1">&#39;Crosses (0 T)&#39;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span>
            <span class="s1">&#39;Empty (0 T)&#39;</span><span class="p">:</span> <span class="mi">310</span><span class="p">,</span>
            <span class="c1"># &#39;Crosses (250 mT)&#39;: 315,</span>
        <span class="p">}</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">j</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="p">{}]})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                 <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                                 <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                 <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Static Field&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">5e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="p">)</span>

        <span class="c1"># ax = plt.gca()</span>
        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.58</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.4</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                                       <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                                       <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
                                       <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># &#39; ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># &#39; ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

                <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
                        <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()][</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span>

                <span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">iloc</span><span class="p">[((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()][</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#000099&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9999FF&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">9.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.4</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mf">9.4</span><span class="p">),</span> <span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mf">9.4</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FF3333&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

                <span class="c1"># ana.set_relative_yticks(inset)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

    <span class="c1">#### Sweeping Field</span>
    <span class="k">def</span> <span class="nf">first_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;vacant-sweeps&#39;</span><span class="p">,</span>
                     <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;First field sweeps (plus minus 50/75/100/etc.)</span>

<span class="sd">        Args:</span>
<span class="sd">            add: adding more data</span>
<span class="sd">            filename: saving as pdf (default: vacant-sweeps)</span>

<span class="sd">        Returns:</span>
<span class="sd">            vacant-sweeps.pdf:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># 382: [(-25,25), &#39;Plusses&#39;, 5, {}],</span>
            <span class="mi">362</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">363</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">364</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">366</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">365</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="c1"># 352: [(&quot;-M_s \\rightarrow -25&quot;,25), &#39;Plusses&#39;, .1],</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="mi">336</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="mi">331</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
                <span class="mi">332</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
                <span class="mi">333</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
            <span class="p">})</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="s2"> </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 9e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Huge </span><span class="se">\\</span><span class="s1">textbf{b) Sweeping Inside the Hysteresis (Plusses)}&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">7e-2</span><span class="p">)),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span> <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.74</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="c1"># Plotting Lines for each measurement</span>
                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">76</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">114</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">176</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">221</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">132</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">82</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">175</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
                                 <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
                           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>

                <span class="c1"># X-Ticks (labels)</span>
                <span class="n">xt_labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">xt_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">xt_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xt_labels</span><span class="p">)</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.44</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.09</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">2e-1</span><span class="p">))</span>
                <span class="n">voltage</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;end field&#39;</span><span class="p">:</span> <span class="n">voltage</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;End field [$\mu_0 \mathrm{H_</span><span class="si">{ext}</span><span class="s1">}$]&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mf">8e-7</span><span class="p">,</span> <span class="mf">9e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">])</span>

            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;End field [$\mu_0 \mathrm{H_</span><span class="si">{ext}</span><span class="s1">}$]&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">i2data</span>

    <span class="k">def</span> <span class="nf">compare_voltages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;compare-voltages&#39;</span><span class="p">,</span>
                         <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare different applied Voltages.</span>

<span class="sd">        Returns:</span>
<span class="sd">            compare-voltages.pdf:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">to_show</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">377</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">mu</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{A}</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span>
            <span class="p">),</span> <span class="p">{}]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 7e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Current Amplitudes (SR785)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">7e-2</span><span class="p">)),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                                <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1.5e-1</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.38</span><span class="p">,</span> <span class="mf">.26</span><span class="p">,</span> <span class="mf">.26</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
                <span class="c1"># inset.set_xticks([-45+10*_ for _ in range(10)], minor=True)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
                           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
                <span class="c1"># inset.set_xlabel(&#39;&#39;)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.54</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.3</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
                <span class="n">voltage</span> <span class="o">=</span> <span class="n">content</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;voltage&#39;</span><span class="p">:</span> <span class="n">voltage</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current [$</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{A}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current [$</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{A}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">i2data</span>

    <span class="k">def</span> <span class="nf">compare_sweeprates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;compare-sweeprates&#39;</span><span class="p">,</span>
                           <span class="n">show_inset</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare different Sweeprates, fits the data and</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">382</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
            <span class="mi">354</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="mi">351</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="mi">355</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span>
            <span class="mi">353</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.25</span><span class="p">],</span>
            <span class="mi">352</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">frac{</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">}{</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{min}</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">),</span> <span class="p">{}]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 5e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sweeprates (SR785)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1.5e-1</span><span class="p">,),</span>
                                <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.33</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>

                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
                <span class="n">sweep_rate</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sweeprate&#39;</span><span class="p">:</span> <span class="n">sweep_rate</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sweep_rate</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
                <span class="s1">&#39;Sweeprate $</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{d}{dt}</span><span class="s1"> \mu_0 H_</span><span class="si">{ext}</span><span class="s1"> </span><span class="se">\\</span><span class="s1">left[</span><span class="se">\\</span><span class="s1">frac{</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">}{</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{min}</span><span class="s1">}</span><span class="se">\\</span><span class="s1">right]$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="c1"># Only save if necessary</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">i2data</span>

    <span class="k">def</span> <span class="nf">fast_sweeprate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">320</span><span class="p">,</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">323</span><span class="p">,</span> <span class="mi">329</span><span class="p">,</span> <span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;FastSR-1&#39;</span><span class="p">,</span> <span class="n">pos2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Huge </span><span class="se">\\</span><span class="s1">textbf{a) Large Field Sweeps}&#39;</span><span class="p">,</span>
                       <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;anas Fast Sweeps over large sweep ranges (1T)</span>

<span class="sd">        Args:</span>
<span class="sd">            show_numbers:</span>
<span class="sd">            xlim:</span>
<span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is &#39;FastSR-1&#39;.</span>
<span class="sd">            pos2:</span>
<span class="sd">            title:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">320</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">321</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">325</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">326</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">323</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">324</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">329</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">322</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">327</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">328</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
            <span class="mi">336</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">333</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">.75</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">332</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">.3</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
            <span class="mi">331</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">4.7</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="ow">in</span> <span class="n">show_numbers</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">leg_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{</span><span class="si">%s</span><span class="s1">} $</span><span class="se">\\</span><span class="s1">;</span><span class="se">\\</span><span class="s1">mathbf{</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{T}</span><span class="s1">}$&#39;</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">leg_str</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>   <span class="c1"># Structure</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="c1"># Field from</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="c1"># Field to</span>
                <span class="c1"># content[2], # Sweeprate</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lofm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
            <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                                 <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                 <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">),</span>
                                       <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ffff99&#39;</span><span class="p">,</span>
                                                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">3e-2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="c1"># self.eva[i]._draw_oneoverf(ax, xmin=1e-2, ymin=1e-6)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
                 <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">pos2</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.32</span><span class="p">,</span> <span class="mf">.72</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Crosses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.45</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">pos2</span><span class="p">:</span>
                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">300</span> <span class="o">+</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span>
                                     <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">[((</span><span class="mi">202</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">178</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">214</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">300</span><span class="p">),</span>
                                      <span class="p">((</span><span class="mi">106</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">61</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">154</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">100</span><span class="p">)]:</span>
                        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span>
                                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="c1"># inset.fill([-500, -500, 500, 500], [y1, y2, y2, y1], &#39;blue&#39;, alpha=.1)</span>
                <span class="c1"># inset.annotate(&quot;&quot;, xy=(25, .35), xytext=(-25, .2),</span>
                <span class="c1">#             arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&#39;blue&#39;))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sv_temp_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;sv-temp-effect&#39;</span><span class="p">,</span>
                       <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">351</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="mi">355</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
            <span class="mi">356</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
            <span class="mi">357</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="mi">358</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="mi">359</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">;\mathrm</span><span class="si">{K}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="p">),</span> <span class="p">{}]</span>
            <span class="c1"># self.eva[nr].Vx *= grad</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="c1"># fit_range=(2e-2, 7e-1),</span>
                                <span class="c1"># show_fit=True,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="c1">#Temperature Effect&#39;,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">7e-2</span>
                                <span class="p">)</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
            <span class="c1"># Inset with Strayfield</span>
            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.75</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span> <span class="s1">&#39;Down&#39;</span><span class="p">],</span>
                             <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

        <span class="c1"># Inset showing fitted data</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span>
                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">temp</span><span class="p">,</span>
                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">}</span>

                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$\mathrm</span><span class="si">{K}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$\mathrm</span><span class="si">{K}</span><span class="s1">$]&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Only save if necessary</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">i2data</span>

    <span class="k">def</span> <span class="nf">multiple_fspans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;multiple-fspans&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>

        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">340</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">349</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">338</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">342</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25 </span><span class="se">\\</span><span class="s2">rightarrow 8.3&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                  <span class="o">+</span><span class="mf">0.11</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">343</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25 </span><span class="se">\\</span><span class="s2">rightarrow -8.3&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                  <span class="mf">0.11</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">$ mT </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{mT}{min}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                      <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps ($B = </span><span class="se">\\</span><span class="s1">pm 25 mT$)&#39;</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-3</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                          <span class="c1"># ylim=()</span>
                      <span class="p">),</span>
                      <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
                                      <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
                      <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="p">)</span>
                      <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Dark2&#39;</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.44</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                   <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span> <span class="s1">&#39;Down&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="n">s</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">)</span>
            <span class="c1"># inset.plot([8.3, 8.3], [y1, y2], &#39;b-.&#39;, alpha=.8)</span>

        <span class="c1"># Only save if necessary</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">negative_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Testing without file output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">340</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">338</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">348</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow 36.56&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">347</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow 36.56&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">$ mT </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{mT}{min}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (measurement Plan \#2)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-3</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="c1"># ylim=()</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">6e-3</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;muted&#39;</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.28</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mf">291.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">291.13</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span>
                       <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">611</span><span class="p">,</span> <span class="o">-</span><span class="mi">611</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">291</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">measplan12</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="c1"># sns.color_palette(&quot;Reds_r&quot;, 14)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">383</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">384</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">385</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)),</span>
                                 <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses $0.5\;\mathrm</span><span class="si">{mT}</span><span class="s1">/\mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">3e-3</span><span class="p">,</span> <span class="mf">6e-7</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="mi">5</span><span class="p">)]:</span>  <span class="c1"># + [-300-50*i for i in range(5)] + [-575]:</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="c1"># for j in [-300-50*i for i in range(5)] + [-575]:</span>
            <span class="c1">#    inset.fill([j, j, j-50, j-50], [y1, y2, y2, y1], alpha=.4)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Without Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2e-2</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;With Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.01e-2</span><span class="p">,</span> <span class="mf">.8e-3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">37</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;self.measplan12-1.pdf&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">measplan12_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="c1"># sns.color_palette(&quot;Reds_r&quot;, 14)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">_</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">391</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span>
                                <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">625</span>
        <span class="n">to_show</span><span class="p">[</span><span class="mi">397</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                        <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}]</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses $0.5\;\mathrm</span><span class="si">{mT}</span><span class="s1">/\mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-4</span><span class="p">,</span> <span class="mf">2e-7</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">300</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]:</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;self.measplan12-2.pdf&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">measplan12_full</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;measplan12-full&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;measurement Plan #12 All 14 measurements in one Graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># c1 = sns.color_palette(&quot;twilight&quot;, 14)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>

        <span class="c1"># Choosing measurement Numbers to plot</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">383</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
            <span class="mi">384</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">385</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)),</span>
                                 <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">_</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]):</span>
            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="p">(</span><span class="mi">391</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span>
                                <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">625</span>
        <span class="n">to_show</span><span class="p">[</span><span class="mi">397</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
                        <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}]</span>

        <span class="c1"># Converting them to a list of measurements (lofm)</span>
        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses;&#39;</span> <span class="o">+</span> \
                                          <span class="s1">&#39; $</span><span class="se">\\</span><span class="s1">Delta B = 50</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$;&#39;</span> <span class="o">+</span> \
                                          <span class="s1">&#39; $0.5</span><span class="se">\\</span><span class="s1">;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">5e-2</span><span class="p">,</span> <span class="mf">5e-8</span><span class="p">),</span>
                                    <span class="n">legend_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">),</span>
                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
                                <span class="p">),</span>
                                <span class="p">)</span>

        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.26</span><span class="p">),</span>
                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span>
                                   <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
                                   <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span> <span class="o">+</span> \
                     <span class="p">[</span><span class="o">-</span><span class="mi">300</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]:</span>
                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>

            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Without Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2e-2</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;With Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.01e-2</span><span class="p">,</span> <span class="mf">4e-4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">35</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width_pt</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;Set figure dimensions to sit nicely in our document.</span>
<span class="sd">        </span>
<span class="sd">        Source: https://jwalton.info/Matplotlib-latex-PGF/</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        width_pt: float</span>
<span class="sd">                Document width in points</span>
<span class="sd">        fraction: float, optional</span>
<span class="sd">                Fraction of the width which you wish the figure to occupy</span>
<span class="sd">        subplots: array-like, optional</span>
<span class="sd">                The number of rows and columns of subplots.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig_dim: tuple</span>
<span class="sd">                Dimensions of figure in inches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Width of figure (in pts)</span>
        <span class="n">fig_width_pt</span> <span class="o">=</span> <span class="n">width_pt</span> <span class="o">*</span> <span class="n">fraction</span>
        <span class="c1"># Convert from pt to inches</span>
        <span class="n">inches_per_pt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">72.27</span>

        <span class="c1"># Golden ratio to set aesthetic figure height</span>
        <span class="n">golden_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">**</span> <span class="mf">.5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Figure width in inches</span>
        <span class="n">fig_width_in</span> <span class="o">=</span> <span class="n">fig_width_pt</span> <span class="o">*</span> <span class="n">inches_per_pt</span>
        <span class="c1"># Figure height in inches</span>
        <span class="n">fig_height_in</span> <span class="o">=</span> <span class="n">fig_width_in</span> <span class="o">*</span> <span class="n">golden_ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">subplots</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">fig_width_in</span><span class="p">,</span> <span class="n">fig_height_in</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="handlem-1">
<h3><a class="toc-backref" href="#toc-entry-17" role="doc-backlink">HandleM</a><a class="headerlink" href="#handlem-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">HandleM</span><span class="p">(</span><span class="n">MultipleM</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            args:</span>
<span class="sd">            kwargs:</span>

<span class="sd">        Note:</span>
<span class="sd">            **Measurement Handler:** This class represents all other</span>
<span class="sd">            measurements and is the interface to other measurement objets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Handle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sa_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hloop_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_process_data</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;directory&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_files</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;directory&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            key:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Measurement Nr. </span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Measurement Nr. </span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">d</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Nr == </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            key:</span>
<span class="sd">            val:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Setting Items is not allowed.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            key:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads all files from a specific directory and creates objects for</span>
<span class="sd">        found measurements.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory (str): directory to search in</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;**/*.dat&#39;</span><span class="p">]),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_folder</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No Files found: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">file_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_custom_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;RAW&#39;</span><span class="p">,</span>
                          <span class="n">instruments</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Help Function to get column names for EVE Measurements.</span>

<span class="sd">        Args:</span>
<span class="sd">            kind (str, optional): Kind of measurement, default: &#39;RAW&#39;</span>
<span class="sd">            instruments (list, optional): Used instruments in order of</span>
<span class="sd">                appearance, default: [&#39;t&#39;, &#39;LS&#39;, &#39;IPS&#39;, &#39;SR830&#39;]</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: (list header, int skiprows)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">instruments</span><span class="p">:</span>
            <span class="n">instruments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;IPS&#39;</span><span class="p">,</span> <span class="s1">&#39;SR830&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;RAW&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s2">&quot;Vx&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy&quot;</span><span class="p">],</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;SA&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vy&#39;</span><span class="p">],</span> <span class="mi">6</span>

        <span class="n">def_skiprows</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">def_header</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">instruments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;LS&#39;</span><span class="p">:</span>
                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Temp</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;IPS&#39;</span><span class="p">:</span>
                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;SR830&#39;</span><span class="p">:</span>
                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span>
                    <span class="s2">&quot;Vx&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth&quot;</span><span class="p">,</span>
                    <span class="c1">#                   [&quot;V%s%d&quot; % (var, gpib) for gpib in [8, 9, 13]</span>
                    <span class="c1">#                   for var in [&#39;x&#39;, &#39;y&#39;, &#39;r&#39;, &#39;th&#39;,]]</span>
                <span class="p">]</span>
        <span class="k">return</span> <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span>

    <span class="k">def</span> <span class="nf">load_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            file_list:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Start loading folder: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">d_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
            <span class="n">directory</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
            <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="s1">&#39;(.*)[mM]([0-9.]+)(.*)([Pp]lusses|[Cc]rosses|[Ee]mpty)(.*).dat&#39;</span><span class="p">,</span>
                <span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">regex</span><span class="p">:</span>
                <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(.*)[mM]([0-9.]+)(.*).dat&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">regex</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Regex doesn&#39;t match: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">folder</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">add_info</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
                    <span class="n">struct</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">m_type</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
                    <span class="n">struct</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">folder</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">m_type</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">add_info</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">nr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Not a valid Measurement Nr. (</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nr</span> <span class="o">+</span> \
                                  <span class="s1">&#39;Debug kind/struct/f (</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                      <span class="n">m_type</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
                <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
                <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_custom_header</span><span class="p">(</span><span class="s1">&#39;SA&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;SR830&#39;</span> <span class="ow">in</span> <span class="n">add_info</span><span class="p">:</span>
                <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_custom_header</span><span class="p">(</span><span class="s1">&#39;RAW&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_custom_header</span><span class="p">(</span>
                    <span class="n">instruments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;IPS&#39;</span><span class="p">,</span> <span class="s1">&#39;SR830&#39;</span><span class="p">])</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sep&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">),</span>
                               <span class="c1"># header=kwargs.get(&#39;header&#39;, def_header_index),</span>
                               <span class="n">names</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="n">def_header</span><span class="p">),</span>
                               <span class="n">skiprows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skiprows&#39;</span><span class="p">,</span> <span class="n">def_skiprows</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span> <span class="o">==</span> <span class="n">nr</span><span class="p">:</span>
                <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
                <span class="n">subnr</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span><span class="p">,</span> <span class="n">subnr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

            <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">nr</span><span class="p">,</span>
                    <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s1">&#39;folder&#39;</span><span class="p">:</span> <span class="n">folder</span><span class="p">,</span>
                    <span class="s1">&#39;technique&#39;</span><span class="p">:</span> <span class="n">m_type</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;Structure&#39;</span><span class="p">:</span> <span class="n">struct</span><span class="p">,</span>
                    <span class="s1">&#39;Additional&#39;</span><span class="p">:</span> <span class="n">add_info</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)}</span>
            <span class="k">if</span> <span class="n">subnr</span><span class="p">:</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;RAW&#39;</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;subnr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subnr</span>

            <span class="n">d_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_data</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;drop_unused_columns&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;Temp0&#39;</span> <span class="ow">in</span> <span class="n">def_header</span><span class="p">:</span>
                    <span class="n">d_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
                        <span class="p">[</span><span class="s2">&quot;Temp</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span> <span class="o">+</span> \
                        <span class="p">[</span><span class="s2">&quot;Vr&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth&quot;</span><span class="p">],</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="n">d_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;imports data and sets info variable.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           h.parse_data({&#39;data&#39;: pd.DataFrame,</span>
<span class="sd">               &#39;info&#39;: dict(Nr=0, ** kw) })</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict): Data to parse</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Start parsing data: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">m_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">nr</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]})</span>
            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Structure&#39;</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Angle&#39;</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;Angle&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Additional&#39;</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Additional&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;Additional&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">m_type</span> <span class="o">==</span> <span class="s1">&#39;SA&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">SA</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sa_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">m_type</span> <span class="o">==</span> <span class="s1">&#39;Hloop&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">down_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hloop_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">m_type</span> <span class="o">==</span> <span class="s1">&#39;RAW&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">RAW</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hloop_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s1">&#39;Measurement </span><span class="si">%s</span><span class="s1"> (type: </span><span class="si">%s</span><span class="s1">) not processed (unknown type).&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">nr</span><span class="p">,</span> <span class="n">m_type</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># self.info.set_index(&#39;Nr&#39;, inplace=True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Parsing Measurement Finished</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
                          <span class="s1">&#39;Debug size data/info (</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_process_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            nr:</span>
<span class="sd">            data:</span>
<span class="sd">            info:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">))</span>

        <span class="c1"># Logging statistical values for info</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># Converting Data to numeric</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">object</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Not Numeric column: </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>

            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_count&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_mean&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_var&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_min&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_max&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="n">d_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">nr</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
            <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="n">info</span>
        <span class="p">}}</span>
        <span class="k">return</span> <span class="n">d_dict</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting a Measurement</span>

<span class="sd">        Args:</span>
<span class="sd">            lofm: list of measurements</span>
<span class="sd">            figsize: tuple size of figure</span>
<span class="sd">            show_fit: bool</span>
<span class="sd">            fit_range: tuple/list</span>
<span class="sd">            plot_settings: list</span>
<span class="sd">            grid_options: list</span>
<span class="sd">            f_settings: 1/f line</span>
<span class="sd">            f2_settings: 1/f^2 line</span>
<span class="sd">            </span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: Figure, Axis</span>

<span class="sd">        Raises:</span>
<span class="sd">            warning: lofm not available.</span>
<span class="sd">            KeyError: Measurement does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lofm&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lofm</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No list of measurements (lofm) available.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lofm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">plot_options</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">):</span>
                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">))</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_fit&#39;</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">)),</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit m</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_fit_label&#39;</span><span class="p">):</span>
                    <span class="n">label</span> <span class="o">+=</span> <span class="s1">&#39; $</span><span class="se">\\</span><span class="s1">alpha = </span><span class="si">%.3f</span><span class="s1">, S_R(f=0) = 10^{</span><span class="si">%.3f</span><span class="s1">}$&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm_S&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span> <span class="o">*</span> \
                                          <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>
                <span class="n">plot_options</span><span class="p">[</span><span class="s1">&#39;plot_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;norm&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                              <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">plot_options</span><span class="p">)</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_settings&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">tmp</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">plot_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
            <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^\circ$) Field sweeps&#39;</span><span class="p">,</span>
            <span class="n">grid</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ffff99&#39;</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">))</span>
        <span class="n">plot_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="o">**</span><span class="n">plot_settings</span><span class="p">)</span>

        <span class="n">grid_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
        <span class="n">grid_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid_options&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="o">**</span><span class="n">grid_options</span><span class="p">)</span>

        <span class="c1"># Draw 1 over f lines</span>
        <span class="n">f_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
        <span class="n">f_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f_settings&#39;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">f2_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">f2_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f2_settings&#39;</span><span class="p">,</span> <span class="p">{}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">f_settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">f2_settings</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;HandleM</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ret</span> <span class="o">+</span> <span class="s1">&#39;Empty&#39;</span>

        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;Nr. </span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="s1"> Type: </span><span class="si">%s</span><span class="se">\t</span><span class="s1"> Structure: </span><span class="si">%s</span><span class="se">\t</span><span class="s1">Technique: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">nr</span><span class="p">,</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">],</span>
                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns information about all measurements </span>
<span class="sd">        and splits it into groups (SA/RAV/MFN/VH).&quot;&quot;&quot;</span>
        
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
        <span class="n">sa</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SA&#39;</span><span class="p">]</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RAW&#39;</span><span class="p">]</span>
        <span class="n">mfn</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MFN&#39;</span><span class="p">]</span>
        <span class="n">vh</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;VH&#39;</span><span class="p">]</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vh</span><span class="o">=</span><span class="n">vh</span><span class="p">,</span> <span class="n">mfn</span><span class="o">=</span><span class="n">mfn</span><span class="p">,</span> <span class="n">sa</span><span class="o">=</span><span class="n">sa</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">info</span><span class="p">,</span> <span class="n">groups</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="mfn-1">
<h3><a class="toc-backref" href="#toc-entry-18" role="doc-backlink">MFN</a><a class="headerlink" href="#mfn-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">   1</span>
<span class="normal">   2</span>
<span class="normal">   3</span>
<span class="normal">   4</span>
<span class="normal">   5</span>
<span class="normal">   6</span>
<span class="normal">   7</span>
<span class="normal">   8</span>
<span class="normal">   9</span>
<span class="normal">  10</span>
<span class="normal">  11</span>
<span class="normal">  12</span>
<span class="normal">  13</span>
<span class="normal">  14</span>
<span class="normal">  15</span>
<span class="normal">  16</span>
<span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MFN</span><span class="p">(</span><span class="n">MultipleM</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Magnetic Flux Noise Measurements.</span>
<span class="sd">        Class to handle and plot MFN Measurements</span>
<span class="sd">        taken with the SR830 DAQ.</span>

<span class="sd">        if a measurement number is given the files are </span>
<span class="sd">        loaded from folder:</span>
<span class="sd">                ``data/MFN/m%s/*.dat``</span>
<span class="sd">        </span>
<span class="sd">        else: files must be a list of filenames:</span>

<span class="sd">            .. code:: python</span>
<span class="sd">               :linenos:</span>
<span class="sd">               :caption: Example</span>

<span class="sd">               arg = glob(&#39;data/MFN/mXXX/m[0-9.]*.dat&#39;)</span>
<span class="sd">               mfn = MFN(arg)</span>

<span class="sd">        :param files: list of files or measurement number.</span>
<span class="sd">        :param kwargs: Different additional parameters.</span>
<span class="sd">        :param int nr: Measurement number</span>
<span class="sd">           (default: None).</span>
<span class="sd">        :param bool calc_first: Calculating first spectrum</span>
<span class="sd">           (default: True).</span>
<span class="sd">        :param bool calc_second: Calculating second spectrum</span>
<span class="sd">           (default: False).</span>
<span class="sd">        :param bool downsample: downsample timesignal for first spectrum</span>
<span class="sd">           (default: False).</span>
<span class="sd">        :param int num_first_spectra: Number of spectra to average</span>
<span class="sd">           (default: 64).</span>
<span class="sd">        :param float timeconstant: Lock-In timeconstant to cut first spectrum</span>
<span class="sd">            at corresponding frequency (see ``cut_fmax``).</span>
<span class="sd">        :param float cut_fmax: Cut first spectrum at this frequency</span>
<span class="sd">           (default: :math:`f_{max} = \frac{\tau}{2\pi}`).</span>
<span class="sd">        :param default_cm: matplotlib color map for contour plots</span>
<span class="sd">           (default: style[&#39;default_cm&#39;]).</span>
<span class="sd">        :type default_cm: matplotlib.cm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Magnetic Flux Noise&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_cm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s1">&#39;default_cm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_cm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nr&#39;</span><span class="p">),</span>
            <span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_first&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_second&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num_first_spectra&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
            <span class="s1">&#39;downsample&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;downsample&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">files</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/MFN/m</span><span class="si">%s</span><span class="s1">/*&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;MFNMeasurement (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_meas</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Stop here if we have no data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Cut too long measurements</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;equalize_length&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__equalize_length</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">)</span>

        <span class="c1"># Cut higher frequencies if timeconstant is known</span>
        <span class="n">fmax_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">1e6</span>
        <span class="n">fmax_tc</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="mf">1e6</span>
        <span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">fmax_rate</span><span class="p">,</span> <span class="n">fmax_tc</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;fmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmax</span>
        <span class="k">if</span> <span class="n">fmax</span> <span class="o">&lt;</span> <span class="mf">1e6</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cut_fmax&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cut_fmax</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cut_fmax&#39;</span><span class="p">,</span> <span class="n">fmax</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">load_meas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loading a single magnetic flux noise DAQ measurement.</span>
<span class="sd">        </span>
<span class="sd">        Files in measrument folder contain multiple measurements</span>
<span class="sd">        with one measurement per field.</span>

<span class="sd">        :param files: files to load</span>
<span class="sd">        </span>
<span class="sd">        :return: DataFrame Data, dict Measurement Objects</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">max_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">meas</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Field&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Vx&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Vy&#39;</span><span class="p">:</span> <span class="p">[]})</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">info_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_info_from_name</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

            <span class="n">field</span> <span class="o">=</span> <span class="n">info_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="n">info_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nr&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nr</span>

            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vx</span>

            <span class="n">max_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span>
                <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">nr</span><span class="p">,</span>
                    <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
                    <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="n">max_len</span> <span class="o">*</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_len</span> <span class="o">*</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

            <span class="c1"># Calculate the first and second spectrum</span>
            <span class="n">meas</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_meas</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">meas</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">meas</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

            <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">{</span><span class="s1">&#39;Field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
                 <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">max_len</span><span class="p">],</span>
                 <span class="s1">&#39;Vx&#39;</span><span class="p">:</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">max_len</span><span class="p">]</span> <span class="o">*</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
                 <span class="s1">&#39;Vy&#39;</span><span class="p">:</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">max_len</span><span class="p">]</span> <span class="o">*</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
                 <span class="p">})</span>
            <span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_data</span><span class="p">,</span> <span class="n">tmp_df</span><span class="p">])</span>  <span class="c1"># , how=&#39;outer&#39;)</span>

        <span class="k">return</span> <span class="n">all_data</span><span class="p">,</span> <span class="n">meas</span>

    <span class="k">def</span> <span class="nf">_get_raw_meas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the RAW Measurement.</span>
<span class="sd">        :param dict data: time signal and info</span>
<span class="sd">        :param bool calculate_second_by_hand: if we calc</span>
<span class="sd">        :return: RAWMeasurement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">RAW</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                  <span class="n">rate</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">],</span>
                  <span class="n">nof_first_spectra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
                  <span class="n">calc_first</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">],</span>
                  <span class="n">calc_second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">],</span>
                  <span class="n">downsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;downsample&#39;</span><span class="p">],</span>
                  <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;raw_kwargs&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
                  <span class="p">)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calculate_second_by_hand&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">calc_second_spectrum</span><span class="p">(</span>
                <span class="n">highest_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;highest_octave&#39;</span><span class="p">,</span> <span class="n">ret</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
                <span class="n">minimum_points_in_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;minimum_points_in_octave&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="n">peak_filter</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;peak_filter&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">cut_fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cut frequencies higher than maximum allowed frequencies.</span>

<span class="sd">        Args:</span>
<span class="sd">            fmax:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Drop all frequencies larger than fmax</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span>
            <span class="n">s</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Frequency &gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fmax</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                   <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
                   <span class="p">)</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">fmax</span><span class="p">]</span>
            <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span> <span class="o">=</span> <span class="n">freq</span>

            <span class="c1"># Reset First Spectrum Variables</span>
            <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">finalize_first_spectrum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">spec</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">freq</span><span class="p">,</span>
                <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectrum_avg</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span>  <span class="c1"># copy</span>
            <span class="p">})</span>

    <span class="k">def</span> <span class="nf">__equalize_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check that data for all fields have same amount of data.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if all fields have same amount of data</span>
        <span class="n">nofvalues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fields_with_more_data</span> <span class="o">=</span> <span class="n">nofvalues</span><span class="p">[</span>
                <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span> <span class="o">&gt;</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">fields_with_less_data</span> <span class="o">=</span> <span class="n">nofvalues</span><span class="p">[</span>
                <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span> <span class="o">&lt;</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;Not all fields have same amount of data (median = </span><span class="si">%s</span><span class="s1">):</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.5</span><span class="p">))</span>
                <span class="o">+</span> <span class="s1">&#39;Fields with more data: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fields_with_more_data</span>
                <span class="o">+</span> <span class="s1">&#39;Fields with less data: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fields_with_less_data</span>
                <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
                <span class="o">+</span> <span class="s1">&#39;To avoid data loss use the option &quot;equalize_length=False&quot;!&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="s1">&#39;Field == </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span>
                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_with_more_data</span><span class="p">:</span>
                    <span class="c1"># Cut data</span>
                    <span class="n">cut_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
                               <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">())]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cut_data</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># recalculate Spectrum</span>
                        <span class="n">rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_meas</span><span class="p">(</span>
                            <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
                             <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
                                 <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
                                 <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="n">rate</span><span class="p">,</span>
                             <span class="p">}</span>
                             <span class="p">},</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Remove field from measurements</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s1">&#39;This field (</span><span class="si">%s</span><span class="s1">) has more data &#39;</span>
                        <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">) than median (</span><span class="si">%s</span><span class="s1">): Cutting data!&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">field</span><span class="p">,</span>
                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">field</span><span class="p">],</span>
                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_with_less_data</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s1">&#39;This field (</span><span class="si">%s</span><span class="s1">) has less data &#39;</span>
                        <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">) than median (</span><span class="si">%s</span><span class="s1">): Deleting field from data!&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">field</span><span class="p">,</span>
                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">field</span><span class="p">],</span>
                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_first_and_second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">),</span> <span class="p">)</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="c1"># Setting shortcuts</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">s</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span>

            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;second_spectra&#39;</span><span class="p">):</span>
                <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;+x*ds&quot;</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;rbgyk&quot;</span>
                <span class="k">for</span> <span class="n">octave</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                        <span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
                    <span class="n">second</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">[</span><span class="n">octave</span><span class="p">]</span>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                             <span class="n">second</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                             <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">octave</span><span class="p">],</span> <span class="n">marker</span><span class="p">[</span><span class="n">octave</span><span class="p">])</span>
                             <span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sum$ Second Spectrum&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S$ [a.u.]&#39;</span><span class="p">)</span>

        <span class="c1"># Legend for second spectrum</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;second_spectra&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">octave</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> Octave&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">octave</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: $</span><span class="se">\\</span><span class="s1">sum$ First Spectrum Noise&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;nr&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
            <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle S_V </span><span class="se">\\</span><span class="s1">rangle$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">^2/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ax1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">plot_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits a spectrum and plots the slope alpha.</span>
<span class="sd">        :param s: pandas.DataFrame of the spectrum</span>
<span class="sd">        :param ax: axis where to plot the data.</span>
<span class="sd">        :return: linear regression fit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="c1"># Fitting alpha</span>
        <span class="n">s</span><span class="p">[</span><span class="s1">&#39;lnf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="s1">&#39;lnS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>

        <span class="n">fit_indices</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
            <span class="n">s</span><span class="o">.</span><span class="n">lnf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fit_indices</span><span class="p">],</span>
            <span class="n">s</span><span class="o">.</span><span class="n">lnS</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fit_indices</span><span class="p">])</span>

        <span class="n">plt_obj</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha_symbol&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">plt_obj</span>

    <span class="k">def</span> <span class="nf">plot_info2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">):</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">)</span>
            <span class="p">(</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">)</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_noise_chararcteristics</span><span class="p">(</span><span class="n">ax11</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour</span><span class="p">(</span><span class="n">ax12</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_noise_chararcteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ax:</span>
<span class="sd">            fields:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="n">par2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

        <span class="n">spectra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
            <span class="c1"># Setting shortcut for Average Spectrum s</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">meas</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">s</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span>

            <span class="n">spectra_df</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span>

            <span class="n">f</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_alpha</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">par2</span><span class="p">,</span> <span class="n">alpha_symbol</span><span class="o">=</span><span class="s2">&quot;bo&quot;</span><span class="p">,</span>
                                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span>

            <span class="n">integral</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="s1">&#39;gd&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Integral&#39;</span><span class="p">)</span>
            <span class="n">intercept</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span>
                                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S(f=1~</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">integral</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
        <span class="c1"># (&#39;Integral&#39;, &#39;$S(f=1~\\mathrm{Hz})$&#39;, &#39;$\\alpha$&#39;))</span>

    <span class="k">def</span> <span class="nf">plot_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_field</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots basic mfn infos</span>

<span class="sd">        Args:</span>
<span class="sd">            show_field:</span>
<span class="sd">            kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">),</span>
              <span class="p">(</span><span class="n">ax21</span><span class="p">,</span> <span class="n">ax22</span><span class="p">),</span>
              <span class="p">(</span><span class="n">ax31</span><span class="p">,</span> <span class="n">ax32</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">),</span>
                                           <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gridspec_kw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()),</span>
                                           <span class="c1">#  wspace=.3,</span>
                                           <span class="c1">#  hspace=.45)</span>
                                           <span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="n">spectra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">second</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">spectra_fit</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
            <span class="c1"># Setting shortcut for Average Spectrum s</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">meas</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">s</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span>

            <span class="n">spectra_df</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span>

            <span class="n">ax11</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> T&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>

            <span class="n">f</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_alpha</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">ax21</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span>
            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">ax22</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
            <span class="n">spectra_fit</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">],</span>
                <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]}</span>

            <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>

            <span class="n">time_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">std</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">ax32</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;second_spectra&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">second</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_fit_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">spectra_fit</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_fit_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Field&#39;</span>

        <span class="c1"># Plot Contour Plot of Averaged Spectra per Field</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_field_contour&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour</span><span class="p">(</span><span class="n">ax12</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_second_sum&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;+x*ds&quot;</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;rbgyk&quot;</span>
                <span class="k">for</span> <span class="n">octave</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span>
                            <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
                    <span class="n">ax12</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span>
                                  <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">[</span>
                                  <span class="n">octave</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                              <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">octave</span><span class="p">],</span> <span class="n">marker</span><span class="p">[</span><span class="n">octave</span><span class="p">])</span>
                              <span class="p">)</span>
                <span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_2 (f)$&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_second_freq&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span>
                    <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array_second_spectra</span>
                <span class="n">smin</span><span class="p">,</span> <span class="n">smax</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">second</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smin</span><span class="p">),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smax</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>
                <span class="n">cs</span> <span class="o">=</span> <span class="n">ax12</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span>
                                   <span class="n">frequencies</span><span class="p">,</span>
                                   <span class="n">second</span><span class="p">,</span>
                                   <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">smin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">smax</span><span class="p">),</span>
                                   <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                                   <span class="n">cmap</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contour_cm&#39;</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">)),</span>
                                   <span class="p">)</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">)</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>
                <span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
                <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Second Spectrum over Field&#39;</span><span class="p">)</span>
                <span class="n">ax12</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">$ [$T$]&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Field == @show_field&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">)</span>

        <span class="c1"># # Plot 1/f line in Spectrum</span>
        <span class="c1"># xmin, ymin = kwargs.get(&#39;xymin&#39;, (2e-1, 5e-14))</span>
        <span class="c1"># factor, alpha = (1.5, 2)</span>
        <span class="c1"># ax11.plot([xmin, xmin * factor],</span>
        <span class="c1">#           [ymin, ymin / (factor ** alpha)],</span>
        <span class="c1">#           &#39;k--&#39;)</span>
        <span class="c1"># ax11.annotate(&#39;$1/f^{}$&#39;.format(alpha),</span>
        <span class="c1">#               (</span>
        <span class="c1">#                   xmin * np.sqrt(factor),</span>
        <span class="c1">#                   ymin / (factor ** (alpha / 2))</span>
        <span class="c1">#                )</span>
        <span class="c1">#               )</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disable_PSD_grid&#39;</span><span class="p">):</span>
            <span class="c1">#ax11.set_xticks([.2+_/10 for _ in range(9)], minor=True)</span>
            <span class="n">ax11</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>

        <span class="c1"># Set nice title and axis labels</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{I. PSD}&#39;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$f$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_V (f) \cdot f$&#39;</span><span class="p">)</span>

        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{III. Slope} $</span><span class="se">\\</span><span class="s1">mathbf{S_V \sim 1/f^{</span><span class="se">\\</span><span class="s1">alpha}}$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>

        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{IV. PSD Integral}&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax22</span><span class="p">,</span> <span class="n">ax12</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_field_contour</span><span class="p">(</span><span class="n">ax31</span><span class="p">,</span> <span class="n">show_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax32</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{VI. Hysteresis Loop}&#39;</span><span class="p">)</span>
        <span class="n">ax32</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$V_H$ [$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)))</span>
        <span class="n">ax32</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">$ [$T$]&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notitle&#39;</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;m</span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">431</span><span class="p">)</span>
                     <span class="o">+</span> <span class="s1">&#39;Rate=$</span><span class="si">%d</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$, &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span>
                     <span class="o">+</span> <span class="s1">&#39;Length=$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{s}</span><span class="s1">$ </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">],</span>
                                                         <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                                             <span class="s1">&#39;add_info&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">plot_field_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax31</span><span class="p">,</span> <span class="n">show_field</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Show specific field</span>
        <span class="n">field_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">show_field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not find timesignal for field (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span>
                              <span class="n">show_field</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">field_spectra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">show_field</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_timesignal&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">field_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax31</span><span class="p">)</span>
                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                        <span class="s1">&#39;Timesignal ($</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> = </span><span class="si">%.2f</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">show_field</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">))</span>
                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
                        <span class="s1">&#39;$V_H$ [$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)))</span>

                    <span class="c1"># show chunksize of first spectra generated</span>
                    <span class="n">num</span> <span class="o">=</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_first_spectra</span>
                    <span class="n">len_first_spectra</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">field_data</span><span class="p">)</span> <span class="o">/</span> <span class="n">num</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
                        <span class="n">x</span> <span class="o">=</span> <span class="n">field_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">len_first_spectra</span> <span class="o">*</span> <span class="n">i</span><span class="p">)][</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
                        <span class="n">ax31</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">field_spectra</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span>
                    <span class="n">freq</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                    <span class="n">first_spectra</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">freq_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
                    <span class="n">first_spectra</span> <span class="o">=</span> <span class="n">first_spectra</span> <span class="o">*</span> <span class="n">freq_table</span>
                    <span class="n">freq</span> <span class="o">=</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">freq</span>
                    <span class="n">smin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smin&#39;</span><span class="p">,</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
                    <span class="n">smax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smax&#39;</span><span class="p">,</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smin</span><span class="p">),</span>
                                         <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smax</span><span class="p">),</span>
                                         <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;numlevels&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
                    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span>
                                    <span class="n">field_spectra</span><span class="o">.</span><span class="n">num</span><span class="p">)</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax31</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                        <span class="n">times</span><span class="p">,</span>  <span class="c1"># x = Time</span>
                        <span class="n">freq</span><span class="p">,</span>  <span class="c1"># y = Frequency</span>
                        <span class="n">first_spectra</span><span class="p">,</span>  <span class="c1"># z = all spectra</span>
                        <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">smin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">smax</span><span class="p">),</span>
                        <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contour_cm&#39;</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">)),</span>
                        <span class="c1"># levels=kwargs.get(&#39;contour_levels&#39;),</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                        <span class="p">{</span><span class="s1">&#39;S</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_</span><span class="p">):</span> <span class="n">times</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">field_spectra</span><span class="o">.</span><span class="n">num</span><span class="p">)},</span>
                        <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax31</span><span class="p">)</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$S_V^{(n)} (f) \cdot f$&#39;</span><span class="p">)</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>
                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{V. Time-resolved PSD} ($</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> = &#39;</span>
                        <span class="s1">&#39;</span><span class="si">%.0f</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">show_field</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f$ [Hz]&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not plot field (H = </span><span class="si">%s</span><span class="s2">) data: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                                  <span class="p">(</span><span class="n">show_field</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can not plot field (H = </span><span class="si">%s</span><span class="s2">) data: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                                 <span class="p">(</span><span class="n">show_field</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="n">ax31</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_various_noise_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                 <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">.45</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">4</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
                    <span class="s1">&#39;Field&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
                <span class="c1"># Setting shortcut for Average Spectrum s</span>
                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$S_V (f=</span><span class="si">%.3f</span><span class="s1">)$&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">plot_various_noise_fits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                 <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                 <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">.45</span><span class="p">),</span>
                                 <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fit_range</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_ranges&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">))):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)][</span><span class="n">i</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
                <span class="c1"># Setting shortcut for Average Spectrum s</span>
                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span>
                <span class="n">fit</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lnf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">fit_range</span><span class="p">],</span>
                                             <span class="n">s</span><span class="o">.</span><span class="n">lnS</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">fit_range</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;intercept&#39;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Fit Range = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fit_range</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Noise Fit at 1 Hz&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">plot_compare_timesignals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plots a grid of 2x2 subplots to compare timesignals and histogram.</span>
<span class="sd">        Args:</span>
<span class="sd">            fields: list</span>
<span class="sd">            factor: float Default: 1e3 (mV)</span>
<span class="sd">            nrows: int Default: len(fields)</span>
<span class="sd">            ncols: int Default: 2</span>
<span class="sd">            sharey: bool Default: True</span>
<span class="sd">            figsize: tuple Default: (11.69, 8.27) in</span>
<span class="sd">            plot_range: int Default: -1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                 <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)),</span>
                                 <span class="n">sharey</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharey&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
                                 <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">)),</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subplot_kw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
        <span class="n">twinax</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colors&#39;</span><span class="p">,[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;purple&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span> <span class="o">==</span>
                          <span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_range&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_kw&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">twinax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">())</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">twinax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dist_kw&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$V_H (</span><span class="se">\\</span><span class="s1">mathbf{</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">=</span><span class="si">%s</span><span class="se">\\</span><span class="s1">,mT})$&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">))])</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">twinax</span>

    <span class="k">def</span> <span class="nf">plot_various_timesignals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plots a grid of 9 subplots with different timesignals</span>
<span class="sd">        Args:</span>
<span class="sd">            fields: list</span>
<span class="sd">            nrows: int Default: len(fields)</span>
<span class="sd">            ncols: int Default: 2</span>
<span class="sd">            sharey: bool Default: True</span>
<span class="sd">            figsize: tuple Default: (11.69, 8.27) in</span>
<span class="sd">            plot_range: int Default: -1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)),</span>
                                 <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                 <span class="n">sharey</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharey&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                                 <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>
                                 <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)][</span><span class="n">i</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span> <span class="o">==</span>
                          <span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_range&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$V_H (</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">=</span><span class="si">%.1f</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">)$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">spectra_field_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ax:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="c1"># Create variable for third dimension</span>
        <span class="n">spectra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">average_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span>
            <span class="n">spectra_df</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">average_spectrum</span><span class="o">.</span><span class="n">S</span> <span class="o">*</span> \
                <span class="n">average_spectrum</span><span class="o">.</span><span class="n">freq</span>
        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span>
        <span class="n">smin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smin&#39;</span><span class="p">,</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="n">smax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smax&#39;</span><span class="p">,</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smin</span><span class="p">),</span>
                             <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smax</span><span class="p">),</span>
                             <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;numlevels&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

        <span class="n">size_fields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
        <span class="n">size_freq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">size_freq</span><span class="p">,</span> <span class="n">size_fields</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot plot contour:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
                              <span class="s1">&#39;spectra_df.shape (</span><span class="si">%s</span><span class="s1">) != &#39;</span> <span class="o">+</span> \
                              <span class="s1">&#39;size_freq (</span><span class="si">%s</span><span class="s1">), size_fields (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="p">(</span>
                                  <span class="n">spectra_df</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">size_freq</span><span class="p">,</span> <span class="n">size_fields</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">size_fields</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">size_freq</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot plot contour: &#39;</span> <span class="o">+</span> \
                              <span class="s1">&#39;size_freq (</span><span class="si">%s</span><span class="s1">), size_fields (</span><span class="si">%s</span><span class="s1">) incorrect&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                  <span class="n">size_freq</span><span class="p">,</span> <span class="n">size_fields</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">fields</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">spectra_df</span><span class="p">,</span>
                         <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">smin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">smax</span><span class="p">),</span>
                         <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                         <span class="n">cmap</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contour_cm&#39;</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">)),</span>
                         <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour_df</span> <span class="o">=</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour_df</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frequencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V}</span><span class="s1"> (f) \cdot f$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{II. PSD Contour Plot}&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write data to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (str):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_fields.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">m</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_spectrum_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">field</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write data to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (str):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_fields.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">RAW</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]},</span>
                    <span class="n">rate</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_spectrum_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span>
                                                                     <span class="n">field</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">subtract_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subtracts mean value from timesignal.</span>

<span class="sd">        :param inplace: Change variable inside this object?</span>
<span class="sd">        :type inplace: bool</span>

<span class="sd">        :param fields: list of fields to fit</span>

<span class="sd">        :return: normalized timesignal</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df_fit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == @field&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">signal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span>

            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Field</span> <span class="o">==</span> <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">signal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span>

            <span class="n">df_fit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_fit</span><span class="p">,</span> <span class="n">signal</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">df_fit</span>

    <span class="k">def</span> <span class="nf">plot_multiple_histograms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                 <span class="n">fields</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
                                 <span class="n">factor</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span>
                                 <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots multiple histograms using seaborn ``sns.FacetGrid``</span>
<span class="sd">           with kdeplot.</span>
<span class="sd">           </span>
<span class="sd">           default kwargs for subplots:</span>
<span class="sd">            kde1_kwargs = dict(clip_on=True, shade=True, alpha=1, lw=1.5, bw=.2)</span>
<span class="sd">            kde2_kwargs = kde1_kwargs.update(dict(lw=2, color=&#39;w&#39;)</span>
<span class="sd">            dist_kwargs = dict(hist=True, norm_hist=True, hist_kws={&#39;alpha&#39;: .5})</span>
<span class="sd">            ax_kwargs = dict(y=0, lw=2, clip_on=True).set(xlim=(-1.3,1.3))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fields</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="n">field_range</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">fields</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="n">stepsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">field_range</span> <span class="o">/</span> <span class="n">steps</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">stepsize</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">stepsize</span>
            <span class="n">df_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtract_mean</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field &gt;= @start and Field &lt; @end&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">factor</span>

            <span class="c1"># Initialize the FacetGrid object</span>
            <span class="n">pal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">dark_palette</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="s1">&#39;huls&#39;</span><span class="p">)</span>
            <span class="n">face_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">pal</span><span class="p">)</span>
            <span class="n">face_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;face_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">kde1_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
            <span class="n">kde1_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kde1_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">kde2_kwargs</span> <span class="o">=</span> <span class="n">kde1_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">kde2_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
            <span class="n">kde2_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kde2_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">dist_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">})</span>
            <span class="n">dist_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dist_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">ax_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Field&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Field&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">face_kwargs</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="s2">&quot;normedVx&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kde1_kwargs</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="s2">&quot;normedVx&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kde2_kwargs</span><span class="p">)</span>
            <span class="c1"># g.map(sns.distplot, &quot;normedVx&quot;, **dist_kwargs)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">,</span> <span class="o">**</span><span class="n">ax_kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;adjust_hspace&#39;</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span> <span class="n">label</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s2">&quot;normedVx&quot;</span><span class="p">)</span>

            <span class="c1"># Set the subplots to overlap</span>
            <span class="n">g</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">-</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;adjust_hspace&#39;</span><span class="p">,</span> <span class="mf">.3</span><span class="p">))</span>

            <span class="c1"># Remove axes details that don&#39;t play well with overlap</span>
            <span class="n">g</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>  <span class="c1"># , xticks=[-100 + 50*_ for _ in range(5)])</span>
            <span class="n">g</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;mV&#39;</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mf">1e3</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mu</span><span class="si">{}</span><span class="s1">V&#39;</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mf">1e6</span> <span class="k">else</span> <span class="s1">&#39;V&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$V_H$ [$</span><span class="se">\\</span><span class="s1">mathrm{</span><span class="si">%s</span><span class="s1">}$]&#39;</span> <span class="o">%</span> <span class="n">unit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_voltages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">508</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)):</span>
        <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">datapath</span><span class="p">):</span>
            <span class="n">meas_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">meas_info</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">datapath</span><span class="p">:</span>
                <span class="n">f_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_info_from_name</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">sr</span> <span class="o">=</span> <span class="n">f_info</span><span class="p">[</span><span class="s1">&#39;Vin&#39;</span><span class="p">]</span>
                <span class="n">nr</span> <span class="o">=</span> <span class="n">f_info</span><span class="p">[</span><span class="s1">&#39;nr&#39;</span><span class="p">]</span>
                <span class="n">meas_info</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_info</span>
                <span class="n">meas_data</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">new_df</span> <span class="o">=</span> <span class="n">meas_data</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span>
                <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">all_data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_data</span><span class="p">[</span><span class="n">nr</span><span class="p">],</span> <span class="n">new_df</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">all_data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span>
            <span class="k">return</span> <span class="n">meas_data</span><span class="p">,</span> <span class="n">meas_info</span><span class="p">,</span> <span class="n">all_data</span>

        <span class="k">def</span> <span class="nf">calc_PSD</span><span class="p">(</span><span class="n">meas_data</span><span class="p">):</span>
            <span class="n">meas_obj</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">data_df</span> <span class="ow">in</span> <span class="n">meas_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">:</span>
                    <span class="n">avg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">1024</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vx</span>

                <span class="n">max_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span>
                    <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">meas_info</span><span class="p">[</span><span class="n">sr</span><span class="p">][</span><span class="s1">&#39;nr&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                        <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="n">max_len</span> <span class="o">*</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="n">meas_obj</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span> <span class="o">=</span> <span class="n">RAW</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                                   <span class="n">rate</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">],</span>
                                   <span class="n">nof_first_spectra</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                   <span class="n">calc_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">downsample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="p">)</span>
            <span class="k">return</span> <span class="n">meas_obj</span>

        <span class="k">def</span> <span class="nf">merge_data</span><span class="p">(</span><span class="n">meas_obj</span><span class="p">,</span> <span class="n">cutoff_frequency</span><span class="o">=</span><span class="mf">.9</span><span class="p">):</span>
            <span class="n">diff_voltages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meas_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">avg_spec</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="n">cutoff_frequency</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">newdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span>
                <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span>
                <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">diff_voltages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="n">newdf</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">diff_voltages</span>

        <span class="k">def</span> <span class="nf">plot_PSD_classic</span><span class="p">(</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">groupby_category</span><span class="o">=</span><span class="s1">&#39;Vin&#39;</span><span class="p">,</span>
                             <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;science&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;bright&#39;</span><span class="p">,</span> <span class="p">}]):</span>
            <span class="n">set_style</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="c1"># g = sns.relplot(x=&#39;freq&#39;, y=&#39;S&#39;, hue=&#39;Vin&#39;, data=diff_voltages, height=5, kind=&#39;line&#39;)</span>
            <span class="n">grouped</span> <span class="o">=</span> <span class="n">diff_voltages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupby_category</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
                                              <span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                              <span class="n">label</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
                                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">,</span>
                                              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1">$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">^2/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">,</span>
                                              <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="c1"># save_plot(&#39;m506&#39;, &#39;png&#39;)</span>

        <span class="k">def</span> <span class="nf">show_PSD_classic</span><span class="p">(</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">groupby_category</span><span class="o">=</span><span class="s1">&#39;Vin&#39;</span><span class="p">,</span>
                             <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;science&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;bright&#39;</span><span class="p">,</span> <span class="p">}]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">set_style</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
            <span class="c1"># g = sns.relplot(x=&#39;freq&#39;, y=&#39;S&#39;, hue=&#39;Vin&#39;, data=diff_voltages, height=5, kind=&#39;line&#39;)</span>
            <span class="n">grouped</span> <span class="o">=</span> <span class="n">diff_voltages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupby_category</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
                                              <span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                              <span class="n">label</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
                                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">,</span>
                                              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1">$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">^2/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">,</span>
                                              <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="n">datapath</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./data/MFN/m</span><span class="si">%s</span><span class="s1">/*&#39;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">)</span>
        <span class="n">meas_data</span><span class="p">,</span> <span class="n">meas_info</span><span class="p">,</span> <span class="n">all_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">datapath</span><span class="p">)</span>
        <span class="n">meas_obj</span> <span class="o">=</span> <span class="n">calc_PSD</span><span class="p">(</span><span class="n">meas_data</span><span class="p">)</span>
        <span class="n">diff_voltages</span> <span class="o">=</span> <span class="n">merge_data</span><span class="p">(</span><span class="n">meas_obj</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">show_PSD_classic</span><span class="p">(</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: Compare different Voltages&#39;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.54</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                            <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
                            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
                            <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

        <span class="n">grouped</span> <span class="o">=</span> <span class="n">diff_voltages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Vin&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="n">fit_area</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;freq &gt; </span><span class="si">%f</span><span class="s1"> and freq &lt; </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
            <span class="n">fit_area</span><span class="p">[</span><span class="s1">&#39;lnf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
            <span class="n">fit_area</span><span class="p">[</span><span class="s1">&#39;lnS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
            <span class="n">fit</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">lnf</span><span class="p">,</span> <span class="n">fit_area</span><span class="o">.</span><span class="n">lnS</span><span class="p">)</span>
            <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="o">-</span><span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
            <span class="n">voltage</span> <span class="o">=</span> <span class="n">group</span>

            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
            <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

        <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Voltage [$\mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span><span class="p">)</span>
        <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
        <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Voltage [$\mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span><span class="p">)</span>
        <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="measurementclass-1">
<h3><a class="toc-backref" href="#toc-entry-19" role="doc-backlink">MeasurementClass</a><a class="headerlink" href="#measurementclass-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MeasurementClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The main measurement class for all measurements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. note:: **MeasurementClass:**</span>
<span class="sd">            This Class is the parent of all other measurement classes.</span>


<span class="sd">        All measurements have the following variables:</span>
<span class="sd">            </span>
<span class="sd">        name: str/None</span>
<span class="sd">            The name of the Measurement Class (e.g. SA, RAW, etc.)</span>

<span class="sd">        info: dict</span>
<span class="sd">            Contains informations about the measurement. Typical keys are:                </span>
<span class="sd">                Nr: float, the number of the measurement,</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_file</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">PlottingClass</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">i</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get  a specific measurement number information.</span>

<span class="sd">        </span>
<span class="sd">        :param *key: Will be passed to info.get</span>
<span class="sd">        </span>
<span class="sd">        :return: info.get(*key)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>


    <span class="fm">__repr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (Nr. </span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (Nr. </span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> \
        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    
    
    <span class="k">def</span> <span class="nf">get_info_from_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extracting information from filenames.</span>
<span class="sd">        Using a default regex first or trying to extract &#39;key-value&#39; pairs</span>
<span class="sd">        separated by &#39;_&#39;.</span>
<span class="sd">    </span>
<span class="sd">        :param name: filename that contains informations.</span>
<span class="sd">        :param kwargs:</span>
<span class="sd">            :str regex: Regular expression for the filename</span>
<span class="sd">        :return: dict(key=value)</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="c1"># Default Regex Structure</span>
        <span class="c1"># Nr,     Struct,         deg,        Type1</span>
        <span class="c1"># Type2, Field, Date, Time</span>
        <span class="c1"># I1, I2, Lock-In (Connections)</span>
        <span class="c1"># Voltage In, Resistors (R11, R12)</span>
        <span class="c1"># R13, R21</span>
        <span class="c1"># Capacitors (C11, C21)</span>
        <span class="c1"># Temp</span>
        <span class="n">def_regex</span> <span class="o">=</span> <span class="s2">&quot;.*[Mm]([0-9.]*)_([A-Za-z]*)_([0-9.-]*)deg_([A-Za-z]*)_&quot;</span> \
                    <span class="s2">&quot;([A-Za-z]*)_*B_([0-9.-]*)T_([0-9]*)_([0-9]*)_I1-([&quot;</span> \
                    <span class="s2">&quot;0-9</span><span class="se">\\</span><span class="s2">-]*)_I2-([0-9</span><span class="se">\\</span><span class="s2">-]*)_G[PB]I[BP].-([0-9</span><span class="se">\\</span><span class="s2">-]*)_Vin-([&quot;</span> \
                    <span class="s2">&quot;0-9.]*)V_R11-([0-9]*.)O_R12-([0-9.]*.)O_R13-([&quot;</span> \
                    <span class="s2">&quot;0-9.]*.)_R21-([0-9.]*.)O_C11-([0-9]*)_C21-([0-9]*)_T-([&quot;</span> \
                    <span class="s2">&quot;0-9]*)K.*&quot;</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;regex&#39;</span><span class="p">,</span> <span class="n">def_regex</span><span class="p">)</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    
        <span class="n">info_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">raw_info</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">raw_info</span><span class="p">:</span>
                <span class="n">regex_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;nr&#39;</span><span class="p">:</span> <span class="s1">&#39;m([0-9.]*)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;deg&#39;</span><span class="p">:</span> <span class="s1">&#39;((neg)?[0-9.-]*)deg&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;dir&#39;</span><span class="p">:</span> <span class="s1">&#39;([Uu]p|[Dd]own)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;(20[12][90][0-9]*)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;([012][0-9][0-6]*)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type1&#39;</span><span class="p">:</span> <span class="s1">&#39;(RAW|Hloop)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type2&#39;</span><span class="p">:</span> <span class="s1">&#39;(Parallel|Gradio)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;struct&#39;</span><span class="p">:</span> <span class="s1">&#39;([Pp]lusses|[Cc]rosses|[Ee]mpty)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;p?m?([0-9.-]+)m?T&#39;</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">):</span>
                    <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">continue</span>
    
                <span class="n">items</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">single_regex</span> <span class="ow">in</span> <span class="n">regex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">single_regex</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">reg</span><span class="p">:</span>
                            <span class="n">info_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">items</span>
                    <span class="n">info_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="n">info_dict</span><span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nr</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">type1</span><span class="p">,</span> \
                <span class="n">type2</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> \
                <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">lock_in</span><span class="p">,</span> \
                <span class="n">vin</span><span class="p">,</span> <span class="n">r11</span><span class="p">,</span> <span class="n">r12</span><span class="p">,</span> <span class="n">r13</span><span class="p">,</span> <span class="n">r21</span><span class="p">,</span> \
                <span class="n">c11</span><span class="p">,</span> <span class="n">c21</span><span class="p">,</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
                <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Expected float field and nr, got:&#39;</span>
                                  <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">nr</span><span class="p">))</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;srtuct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;deg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deg</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;type1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type1</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;type2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type2</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i1</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;i2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i2</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;lock_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lock_in</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r11&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r11</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r12&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r12</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r13</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r21&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r21</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vin</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;c11&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c11</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;c21&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c21</span>
            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
   
        <span class="bp">self</span><span class="o">.</span><span class="n">info_file</span> <span class="o">=</span> <span class="n">info_dict</span>
        
        <span class="k">return</span> <span class="n">info_dict</span>

    <span class="k">def</span> <span class="nf">calc_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vy&#39;</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ln</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="singlem-1">
<h3><a class="toc-backref" href="#toc-entry-20" role="doc-backlink">SingleM</a><a class="headerlink" href="#singlem-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SingleM</span><span class="p">(</span><span class="n">MeasurementClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The main constructor for all single measurements.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">linear_regression</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">fit_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applys a linear regression and adds result to DataFrame</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): Fit data</span>
<span class="sd">            x (np.ndarray): Fit variable.</span>
<span class="sd">            y (np.ndarray): Fit variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_regression</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
        <span class="k">return</span> <span class="n">df</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="raw-1">
<h3><a class="toc-backref" href="#toc-entry-21" role="doc-backlink">RAW</a><a class="headerlink" href="#raw-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RAW</span><span class="p">(</span><span class="n">SingleM</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RAW Measurement:</span>
<span class="sd">            Measurements with time signal only.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :linenos:</span>
<span class="sd">           :caption: Example</span>

<span class="sd">           data = np.array(timesignal, shape=(n,))</span>
<span class="sd">           data = {</span>
<span class="sd">                &#39;data&#39;: np.array(timesignal, shape=(n,))</span>
<span class="sd">                &#39;info&#39;: {&#39;Nr&#39;: 123, &#39;Add Info&#39;: &#39;Important Informations&#39;}</span>
<span class="sd">                }</span>
<span class="sd">           raw = ana.RAW(data)</span>

<span class="sd">        :param data: Different possibilities.</span>

<span class="sd">        :param rate: At which rate was the timesignal measured (samplingrate) [Hz]</span>
<span class="sd">        :type rate: float, default: 2e-4</span>

<span class="sd">        :info: First Spectrum parameters</span>
<span class="sd">        :param nof_first_spectra: Cut timesignal into # pieces and average.</span>
<span class="sd">        :type nof_first_spectra: int, default: 64</span>

<span class="sd">        :param first_spectra_highest_frequency: Cut higher frequencies in final spectrum than this.</span>
<span class="sd">        :type first_spectra_highest_frequency: float, default: rate/8</span>

<span class="sd">        :param downsample: Downsample the timesignal before calculation.</span>
<span class="sd">        :type downsamle: bool, default: True</span>

<span class="sd">        :param calc_first: Triggers calculation of first spectrum.</span>
<span class="sd">        :type calc_first: bool, default: False</span>

<span class="sd">        :info: Second Spectrum parameters</span>
<span class="sd">        :param highest_octave: The highest octave starting point [Hz] of the second spectrum.</span>
<span class="sd">        :type highest_octave: int, default: 64</span>

<span class="sd">        :param minimum_points_in_octave: If octave would contain less points, stop.</span>
<span class="sd">        :type minimum_points_in_octave: int, default: 10</span>

<span class="sd">        :param calc_second: Triggers calculation of second spectrum.</span>
<span class="sd">        :type calc_second: bool, default: False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;RAW&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RAW&#39;</span>
        <span class="c1"># Default Parameter for the first and second spectrum</span>
        <span class="n">timesignal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> 
                              <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timesignal&#39;</span><span class="p">,</span> 
                                         <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
                                         <span class="p">)</span>
                              <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span> <span class="mf">2e-4</span><span class="p">)</span>

        <span class="c1"># Define dummies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_spectrum_time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_timesignal</span><span class="p">(</span><span class="n">timesignal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;highest_octave&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_points_in_octave</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;minimum_points_in_octave&#39;</span><span class="p">,</span>
                                                   <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shifting_method</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">short_mode</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;lowpass&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passband_factor</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_analog</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downsample</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;downsample&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_max</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;first_spectra_highest_frequency&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nof_first_spectra&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s2">&quot;Time&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
            <span class="s2">&quot;Num&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span>
            <span class="s2">&quot;Rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
            <span class="s2">&quot;Avg&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">,</span>
            <span class="s2">&quot;downsample&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">,</span>
            <span class="s2">&quot;f_max&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">,</span>
            <span class="s2">&quot;NofSpectra&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">,</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_first&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_first_spectrum</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="k">return</span> 
            
            <span class="n">max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="c1"># &quot;f_min&quot;: freq[0],</span>
                <span class="c1"># &#39;f_max&#39;: freq.max(),</span>
                <span class="s2">&quot;f_min&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="s1">&#39;f_max&#39;</span><span class="p">:</span> <span class="n">max_freq</span><span class="p">,</span>
            <span class="p">})</span>

            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_second&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_second_spectrum</span><span class="p">(</span><span class="n">highest_octave</span><span class="o">=</span><span class="n">max_freq</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_timesignal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timesignal</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; converts pd.DataFrame[&#39;Vx&#39;] and Series into numpy array.</span>

<span class="sd">        :param timesignal: input timesignal</span>
<span class="sd">        :return: converted timesignal.</span>
<span class="sd">        :rtype: numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesignal</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">timesignal</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">timesignal</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1024.</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1024</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">ts</span>

    <span class="k">def</span> <span class="nf">calc_first_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the variable ``spectrum`` to a</span>
<span class="sd">        :class:`spectrumanalyzer.SpectrumAnalyzer` object.</span>

<span class="sd">        .. important::</span>
<span class="sd">            Calculates the first spectrum.</span>

<span class="sd">        </span>
<span class="sd">        :raises NameError: spectrumanalyzer is not installed</span>
<span class="sd">        :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">SpectrumAnalyzer</span><span class="p">(</span>
                <span class="c1"># filepath=filename,</span>
                <span class="n">timesignal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span>
                <span class="n">samplingrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
                <span class="n">averages</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">,</span>
                <span class="n">shifting_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shifting_method</span><span class="p">,</span>
                <span class="n">short_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">short_mode</span><span class="p">,</span>
                <span class="n">filter_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span><span class="p">,</span>
                <span class="n">passband_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">passband_factor</span><span class="p">,</span>
                <span class="n">filter_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">,</span>
                <span class="n">filter_analog</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_analog</span><span class="p">,</span>
                <span class="n">first_spectra_highest_frequency</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">,</span>
                <span class="n">downsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;SpectrumAnalyzer module not installed.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">spectrum_arr</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">cut_timesignal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spectrum_arr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span><span class="p">,</span>
            <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectrum</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">calc_second_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculating the second spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">calculate_second_spectrum</span><span class="p">(</span>
            <span class="n">highest_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;highest_octave&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span><span class="p">),</span>
            <span class="n">minimum_points_in_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;minimum_points_in_octave&#39;</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">minimum_points_in_octave</span><span class="p">),</span>
            <span class="n">peak_filter</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;peak_filter&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">freq2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="p">]</span>

        <span class="n">octaves</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_first_spectra</span><span class="p">),</span>
                <span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">]</span>
            <span class="n">points_in_octave</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))])</span>
            <span class="n">number_of_octaves</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="n">points_in_octave</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_points_in_octave</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">octaves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">octaves</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">],</span> <span class="n">octaves</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s1">&#39;NofOct&#39;</span><span class="p">:</span> <span class="n">number_of_octaves</span><span class="p">,</span>
        <span class="p">})</span>

        <span class="c1"># Calculate Timesignal if needed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skip_timesignal&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_time_signal_second_spectrum</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">calc_time_signal_second_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">time_signal_second_spectrum_transposed</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">time_signal_second_spectrum</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">second_spectrum_time_array</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">timestep_second_spectrum</span>
        <span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed</span><span class="p">),</span>
                      <span class="nb">len</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed_normalized</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
            <span class="n">time_signal_second_spectrum_transposed_normalized</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                    <span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> \
            <span class="n">time_signal_second_spectrum_transposed_normalized</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_spectrum_time_array</span> <span class="o">=</span> <span class="n">second_spectrum_time_array</span>


    <span class="k">def</span> <span class="nf">plot_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">subtract_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subtracts mean value from timesignal.</span>

<span class="sd">        :param inplace: Change variable inside this object?</span>
<span class="sd">        :type inplace: bool</span>

<span class="sd">        :return: normalized timesignal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">norm_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span> <span class="o">=</span> <span class="n">norm_ts</span>

        <span class="k">return</span> <span class="n">norm_ts</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writing data to a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="n">all_first_spectra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span>
        <span class="n">all_first_spectra</span><span class="p">[</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span>

        <span class="n">all_first_spectra</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_first.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># all_first_spectra.to_feather(&quot;%s_first.feather&quot; % file)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">all_second_spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">,</span>
                                          <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">all_second_spectra</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array_second_spectra</span>
        <span class="n">all_second_spectra</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_second.dat&#39;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span>
                                  <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># all_second_spectra.to_feather(&#39;%s_second.feather&#39; % file)</span>

        <span class="n">all_second_spectra_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">time_signal_second_spectrum</span><span class="p">)</span>
        <span class="n">all_second_spectra_time</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_second_time.dat&#39;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span>
                                       <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># all_second_spectra_time.to_feather(&#39;%s_second_time.feather&#39; % file)</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reading data from file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file: str</span>
<span class="sd">        Filename base to read data from.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">first_spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_first.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;First Spectrum at </span><span class="si">%s</span><span class="s1">_first.dat not found!&#39;</span><span class="p">,</span>
                              <span class="n">file</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">SpectrumAnalyzer</span><span class="p">(</span>
                <span class="n">timesignal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span>
                <span class="n">samplingrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
                <span class="n">averages</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">,</span>
                <span class="n">shifting_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shifting_method</span><span class="p">,</span>
                <span class="n">short_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">short_mode</span><span class="p">,</span>
                <span class="n">filter_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span><span class="p">,</span>
                <span class="n">passband_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">passband_factor</span><span class="p">,</span>
                <span class="n">filter_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">,</span>
                <span class="n">filter_analog</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_analog</span><span class="p">,</span>
                <span class="n">first_spectra_highest_frequency</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">,</span>
                <span class="n">downsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not create SpectrumAnalyzer Object: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="p">[[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Avg&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="s1">&#39;freq&#39;</span><span class="p">},</span>
                                 <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_first_spectra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">finalize_first_spectrum</span><span class="p">(</span>
                <span class="n">first_spectra</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Avg&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not load variables: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">second_spectrum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_second.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">second_spectrum_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_second_time.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Second Spectrum (</span><span class="si">%s</span><span class="s1">_second.dat) not found!&#39;</span><span class="p">,</span>
                             <span class="n">file</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array_second_spectra</span> <span class="o">=</span> \
                <span class="n">second_spectrum</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span> <span class="o">=</span> <span class="n">second_spectrum</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span>
                                                                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">time_signal_second_spectrum</span> <span class="o">=</span> <span class="n">second_spectrum_time</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not load second spectrum variables: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Second Spectrum loaded but not all variables&quot;</span>
                            <span class="s2">&quot;are implemented yet. Only access to </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;- second_spectra</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;- time_signal_second_spectrum</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;- frequency_span_array_second_spectra&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="sa-1">
<h3><a class="toc-backref" href="#toc-entry-22" role="doc-backlink">SA</a><a class="headerlink" href="#sa-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SA</span><span class="p">(</span><span class="n">SingleM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads and analyzes datafiles from :instrument:`SR785`&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            *args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            * ValueError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;SA&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;SA&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Not Able to find DataFrame. Please use SA_measurement(data).&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="c1"># Convert data to numeric values</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vx</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vy</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Unable to convert data to numeric.&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>

        <span class="c1"># Redirect functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_oneoverf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">draw_oneoverf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_plot_settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_plot_settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calc_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_log</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;SA Measurement (Nr. </span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>


    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the Data on given Axis or creating a new Plot for plotting.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :linenos:</span>
<span class="sd">           :caption: Signature</span>

<span class="sd">           plot(ax, label=None, color=None, linestyle=None,</span>
<span class="sd">               plot_x=&#39;f&#39;, plot_y=&#39;Vx&#39;, dont_set_plot_settings=False,</span>

<span class="sd">                   xscale=&#39;log&#39;, yscale=&#39;log&#39;, xlim=(None, None), ylim=(None,</span>
<span class="sd">                   None), legend_location=&#39;best&#39;, grid=None, title=None,</span>
<span class="sd">                   xlabel=&#39;f [Hz]&#39;, ylabel=&#39;S_VH [V2/Hz]&#39;,</span>

<span class="sd">           )</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Note:</span>
<span class="sd">            If **dont_set_plot_settings** is True, all kwargs below are not</span>
<span class="sd">            used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">plotargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">plotargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">plotargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;linestyle&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">plotargs</span><span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_x&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">)],</span>
                <span class="o">**</span><span class="n">plotargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dont_set_plot_settings&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;Fits a linear regression</span>

<span class="sd">        Args:</span>
<span class="sd">            fit_range (tuple, optional, default: (1e-2, 1e0).):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vy&#39;</span><span class="p">])</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">fit_range</span>

        <span class="n">fit_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xmax</span><span class="p">]</span>
        <span class="n">fit_area</span> <span class="o">=</span> <span class="n">fit_area</span><span class="p">[</span><span class="n">fit_area</span><span class="o">.</span><span class="n">f</span> <span class="o">&gt;</span> <span class="n">xmin</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">lnf</span><span class="p">,</span> <span class="n">fit_area</span><span class="o">.</span><span class="n">lnVx</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Slope&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">slope</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="hloop-1">
<h3><a class="toc-backref" href="#toc-entry-23" role="doc-backlink">Hloop</a><a class="headerlink" href="#hloop-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Hloop</span><span class="p">(</span><span class="n">SingleM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class represents the measurement of a hysteresis loop. It evaluates</span>
<span class="sd">    and plots the data.</span>

<span class="sd">    It collects all files that match the following regex:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">       files = glob(&quot;data/Hloop/[mM]%s_*.dat&quot; % measurement_number)</span>

<span class="sd">    The files should contain a file that contains the word &quot;up&quot; or &quot;down&quot;</span>
<span class="sd">    indicating the direction of the field sweep.</span>

<span class="sd">    If one file contains the word &#39;Gradio&#39; it expects a gradiometry</span>
<span class="sd">    measurement. If the filename contains the word &#39;Parallel&#39; it expects a</span>
<span class="sd">    parallel measurement. If the filename contains neither of these words the</span>
<span class="sd">    variables need to be set manually.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement_number</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            measurement_number:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Hloop&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Hloop&#39;</span>
        <span class="c1"># Defining Constants</span>
        <span class="n">header_gradio</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth8&quot;</span><span class="p">,</span> <span class="s2">&quot;TempRO CU&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;TempRO YOKE&quot;</span><span class="p">,</span> <span class="s2">&quot;TempCX CU&quot;</span><span class="p">,</span> <span class="s2">&quot;SampTemp&quot;</span><span class="p">,</span> <span class="s2">&quot;Temp1K Pot&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;TempCharcoal&quot;</span><span class="p">]</span>
        <span class="n">header_parallel</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx9&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Vy9&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr9&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth9&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx13&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy13&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr13&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Vth13&quot;</span><span class="p">,</span> <span class="s2">&quot;TempRO CU&quot;</span><span class="p">,</span> <span class="s2">&quot;TempRO YOKE&quot;</span><span class="p">,</span> <span class="s2">&quot;TempCX CU&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;SampTemp&quot;</span><span class="p">,</span> <span class="s2">&quot;Temp1K Pot&quot;</span><span class="p">,</span> <span class="s2">&quot;TempCharcoal&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span>
                       <span class="mi">330</span><span class="p">]</span>  <span class="c1"># Condensators in pF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">392</span><span class="p">,</span> <span class="mi">475</span><span class="p">,</span> <span class="mi">562</span><span class="p">,</span> <span class="mi">619</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">825</span><span class="p">,</span> <span class="mi">909</span><span class="p">,</span>
                       <span class="mf">1e3</span><span class="p">]</span>  <span class="c1"># Resistors in k Ohm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mf">1369288448319507.5</span>  <span class="c1"># Carrier Concentration calculated from perp. sweep</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">measurement_number</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">measurement_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/Hloop/[mM]</span><span class="si">%s</span><span class="s2">_*.dat&quot;</span> <span class="o">%</span> <span class="n">measurement_number</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">measurement_number</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file_list&#39;</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">files</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
                <span class="s2">&quot;No File for measurement Nr. </span><span class="si">%s</span><span class="s2"> found.&quot;</span> <span class="o">%</span> <span class="n">measurement_number</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">file_info</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Gradio&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                        <span class="s2">&quot;.*[Mm]([0-9.]*)_([A-Za-z]*)_([0-9.-]*)deg_&quot;</span>
                        <span class="s2">&quot;([A-Za-z]*)_&quot;</span>
                        <span class="s2">&quot;([A-Za-z]*)_*([A-Za-z]*)_([0-9]*)_([0-9]*)_&quot;</span>
                        <span class="s2">&quot;I1-([0-9\-]*)_I2-([0-9\-]*)_G.*-([0-9\-]*)_&quot;</span>
                        <span class="s2">&quot;Vin-([0-9.]*)V_R11-([0-9]*.)O_R12-([0-9.]*.)O_&quot;</span>
                        <span class="s2">&quot;R13-([0-9.]*.)_R21-([0-9.]*.)O_&quot;</span>
                        <span class="s2">&quot;C11-([0-9]*)_C21-([0-9]*)_&quot;</span>
                        <span class="s2">&quot;T-([0-9]*)K_SR-([0-9.]*)-T-min&quot;</span><span class="p">,</span>
                        <span class="n">fname</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not fitting Regex&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
                    <span class="n">m_no</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">m_type</span><span class="p">,</span> \
                        <span class="n">m_dir</span><span class="p">,</span> <span class="n">m_type2</span><span class="p">,</span> <span class="n">m_date</span><span class="p">,</span> <span class="n">m_time</span><span class="p">,</span> \
                        <span class="n">m_i1</span><span class="p">,</span> <span class="n">m_i2</span><span class="p">,</span> <span class="n">m_li1</span><span class="p">,</span> \
                        <span class="n">m_vin</span><span class="p">,</span> <span class="n">m_r11</span><span class="p">,</span> <span class="n">m_r12</span><span class="p">,</span> \
                        <span class="n">m_r13</span><span class="p">,</span> <span class="n">m_r21</span><span class="p">,</span> \
                        <span class="n">m_c11</span><span class="p">,</span> <span class="n">m_c21</span><span class="p">,</span> \
                        <span class="n">m_T</span><span class="p">,</span> <span class="n">m_SR</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
                    <span class="n">header</span> <span class="o">=</span> <span class="n">header_gradio</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="n">fname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Parallel&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                        <span class="s2">&quot;.*[Mm]([0-9.]*)_([A-Za-z_]*)_([0-9.-]*)deg_([A-Za-z]*)_&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;([A-Za-z]*)_*([A-Za-z]*)_([0-9]*)_([0-9]*)_&quot;</span> \
                        <span class="o">+</span> <span class="s2">&quot;I-([0-9\-]*)_(G.*-[0-9\-]*)_&quot;</span> \
                        <span class="o">+</span> <span class="s2">&quot;Vin-([0-9.]*)V_R11-([0-9]*.)O&quot;</span> \
                        <span class="o">+</span> <span class="s2">&quot;.*_&quot;</span> \
                        <span class="o">+</span> <span class="s2">&quot;T-([0-9]*)K_SR-([0-9.]*)-T-min&quot;</span><span class="p">,</span>
                        <span class="n">fname</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not fitting Regex&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
                    <span class="n">m_no</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">m_type</span><span class="p">,</span> \
                    <span class="n">m_dir</span><span class="p">,</span> <span class="n">m_type2</span><span class="p">,</span> <span class="n">m_date</span><span class="p">,</span> <span class="n">m_time</span><span class="p">,</span> \
                    <span class="n">m_i1</span><span class="p">,</span> <span class="n">m_li1</span><span class="p">,</span> \
                    <span class="n">m_vin</span><span class="p">,</span> <span class="n">m_r11</span><span class="p">,</span> \
                    <span class="n">m_T</span><span class="p">,</span> <span class="n">m_SR</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
                    <span class="n">m_i2</span> <span class="o">=</span> <span class="n">m_r12</span> <span class="o">=</span> <span class="n">m_r13</span> <span class="o">=</span> <span class="n">m_r21</span> <span class="o">=</span> <span class="n">m_c11</span> <span class="o">=</span> <span class="n">m_c21</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                    <span class="n">header</span> <span class="o">=</span> <span class="n">header_parallel</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not fitting Regex&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">file_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_info_from_name</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type2&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Parallel&#39;</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">header_gradio</span> <span class="k">if</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type2&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Gradio&#39;</span> <span class="k">else</span> <span class="n">header_parallel</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">file_info</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> \
                        <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">file_info</span><span class="p">[</span><span class="s1">&#39;deg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">deg</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.01</span>
                <span class="n">m_dir</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dir&#39;</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;b.dat&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">m_dir</span> <span class="o">=</span> <span class="s1">&#39;up&#39;</span>


            <span class="c1">### Loading File</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">m_dir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fname_up</span> <span class="o">=</span> <span class="n">fname</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                                      <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="mf">1e3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fname_down</span> <span class="o">=</span> <span class="n">fname</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                                        <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="mf">1e3</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;down_only&#39;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;up_only&#39;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span> <span class="o">=</span> <span class="n">measurement_number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Mirror all Angles bigger than 90</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;force_mirror&#39;</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auto_mirror&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> \
                 <span class="nb">float</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">file_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">file_info</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span>
                                     <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type2&#39;</span><span class="p">)),</span>
                <span class="s1">&#39;Structure&#39;</span><span class="p">:</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;struct&#39;</span><span class="p">),</span>
                <span class="s1">&#39;Angle&#39;</span><span class="p">:</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span>
            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m_datetime</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">m_date</span><span class="p">[</span><span class="mi">6</span><span class="p">:],</span> <span class="n">m_date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">m_date</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">m_time</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">m_time</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m_type</span><span class="p">,</span> <span class="n">m_type2</span><span class="p">),</span>
                <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">m_datetime</span><span class="p">,</span>
                <span class="s1">&#39;Structure&#39;</span><span class="p">:</span> <span class="n">struct</span><span class="p">,</span>
                <span class="s1">&#39;Angle&#39;</span><span class="p">:</span> <span class="n">deg</span><span class="p">,</span>
                <span class="s1">&#39;I1&#39;</span><span class="p">:</span> <span class="n">m_i1</span><span class="p">,</span>
                <span class="s1">&#39;I2&#39;</span><span class="p">:</span> <span class="n">m_i2</span><span class="p">,</span>
                <span class="s1">&#39;Vin&#39;</span><span class="p">:</span> <span class="n">m_vin</span><span class="p">,</span>
                <span class="s1">&#39;R11&#39;</span><span class="p">:</span> <span class="n">m_r11</span><span class="p">,</span>
                <span class="s1">&#39;R12&#39;</span><span class="p">:</span> <span class="n">m_r12</span><span class="p">,</span>
                <span class="s1">&#39;R13&#39;</span><span class="p">:</span> <span class="n">m_r13</span><span class="p">,</span>
                <span class="s1">&#39;R21&#39;</span><span class="p">:</span> <span class="n">m_r21</span><span class="p">,</span>
                <span class="s1">&#39;C11&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">m_c11</span><span class="p">)],</span>
                <span class="s1">&#39;C21&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">m_c21</span><span class="p">)],</span>
                <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">m_T</span><span class="p">,</span>
                <span class="s1">&#39;SR&#39;</span><span class="p">:</span> <span class="n">m_SR</span><span class="p">,</span>
                <span class="s1">&#39;Additional&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>

        <span class="c1"># Update data from kwargs</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">set_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Multiplying the Voltage by a Factor</span>

<span class="sd">        Args:</span>
<span class="sd">            factor:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            V:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s1">&#39;electron volt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">V</span> <span class="o">/</span> <span class="mf">2.5e-6</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">B</span>

    <span class="k">def</span> <span class="nf">remove_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes the values 0.0 from up and down sweep where the lock-in</span>
<span class="sd">        didn&#39;t return any values (read error will be saved as 0.0).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set Columns to remove values from</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx9&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx13&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]</span>

        <span class="c1"># Remove zero values from columns (= measurement error)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fitting the Voltage Signal.</span>

<span class="sd">        For Parallel measurement:</span>

<span class="sd">           the empty cross Vx13 is subtracted from the signal Vx8/Vx9</span>

<span class="sd">        For gradiometry:</span>

<span class="sd">           A condition can be added to determine the amount of</span>
<span class="sd">           datapoints to fit (default: B &lt; B_min + 150mT).</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">            cond = (self.up.B &lt; self.up.B.min() + 150)</span>
<span class="sd">            m.fit(cond)</span>

<span class="sd">        Args:</span>
<span class="sd">            cond:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set Fitting Condition</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">empty</span><span class="p">):</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>

        <span class="c1">### Fitting Graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx13</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx13</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx13</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx13</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">fit</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">fit_area</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span> <span class="o">+</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span> <span class="o">+</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">)</span>
            <span class="n">fit_area</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span>
                               <span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span> <span class="o">+</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">fit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">fit</span>

    <span class="k">def</span> <span class="nf">plot_hloop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">show_fitted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">show_rem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_coer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the hysteresis loop.</span>

<span class="sd">        :param ax: Matplotlib Axis to plot on.</span>
<span class="sd">        :param figtitle: can be set to a manual figure title.</span>
<span class="sd">        :param show_fitted: plot the fitted curve.</span>
<span class="sd">        :param show_rem: show the remanent voltage.</span>
<span class="sd">        :param show_coer: show the coercive field.</span>
<span class="sd">        :param show_original: plots the RAW data.</span>
<span class="sd">        :param show_linear_fit: plots the linear fitting line used for the fit</span>
<span class="sd">        (only gradiometry).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_original&#39;</span><span class="p">):</span>  <span class="c1"># Drawing RAW Data</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up (LI 9)&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down (LI 9)&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up (LI 13)&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down (LI 13)&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_fitted</span><span class="p">:</span>  <span class="c1"># Drawing fitted data</span>
            <span class="c1"># Already fitted?</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;down_fitted&#39;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Up (fitted)&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Down (fitted)&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_linear_fit&#39;</span><span class="p">):</span>  <span class="c1"># Drawing linear Fit</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear Fit&#39;</span><span class="p">)</span>

        <span class="c1">### Remanent Field ###</span>
        <span class="k">if</span> <span class="n">show_rem</span><span class="p">:</span>
            <span class="n">rem1</span><span class="p">,</span> <span class="n">rem2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_remanence</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
                    <span class="s1">&#39;r-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;.5&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$V_</span><span class="si">{rem}</span><span class="s2"> = </span><span class="si">%.3f</span><span class="s2"> </span><span class="se">\\</span><span class="s2">mu V$&quot;</span> <span class="o">%</span> <span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span>
                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$V_</span><span class="si">{rem}</span><span class="s2"> = </span><span class="si">%.3f</span><span class="s2"> </span><span class="se">\\</span><span class="s2">mu V$&quot;</span> <span class="o">%</span> <span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span>
                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>

        <span class="c1">### Coercive Field</span>
        <span class="k">if</span> <span class="n">show_coer</span><span class="p">:</span>
            <span class="n">mean</span><span class="p">,</span> <span class="n">coer</span><span class="p">,</span> <span class="n">coer2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coercive_field</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">mean</span><span class="p">],</span> <span class="s1">&#39;r-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;.5&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coer</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$B_</span><span class="si">{coer}</span><span class="s2"> = </span><span class="si">%.4f</span><span class="s2"> T$&quot;</span> <span class="o">%</span> <span class="n">coer</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">coer</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$B_</span><span class="si">{coer}</span><span class="s2"> = </span><span class="si">%.4f</span><span class="s2"> T$&quot;</span> <span class="o">%</span> <span class="n">coer2</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>

        <span class="c1"># Making a nice plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$B</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>

        <span class="c1"># Setting correct Y Label</span>
        <span class="n">yunit</span> <span class="o">=</span> <span class="s1">&#39;$V_x$&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">==</span> <span class="mf">1e3</span><span class="p">):</span>
            <span class="n">yunit</span> <span class="o">+=</span> <span class="s1">&#39; $[</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mV}</span><span class="s1">]$&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">==</span> <span class="mf">1e6</span><span class="p">):</span>
            <span class="n">yunit</span> <span class="o">+=</span> <span class="s1">&#39; $[</span><span class="se">\\</span><span class="s1">mathrm{</span><span class="se">\\</span><span class="s1">mu V}]$&#39;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">yunit</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">figtitle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">figtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">figtitle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the strayfield of the signal and stores it in up and down</span>
<span class="sd">        sweeps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_fitted_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the strayfield of the fitted signal and stores it in up</span>
<span class="sd">        and down sweeps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the strayfield of the data. Strayfield is calculated using the</span>
<span class="sd">        electron concentration at 0 degree measured before</span>
<span class="sd">        (hardcoded in __init__).</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): where should we plot.</span>
<span class="sd">            figtitle (str, optional): Choose your own title above the figure.</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_strayfield</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_original&#39;</span><span class="p">):</span>  <span class="c1"># Drawing RAW Data</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_fitted&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>  <span class="c1"># Drawing fitted data</span>
            <span class="c1"># Already fitted?</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;down_fitted&#39;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_fitted_strayfield</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_plusses&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Up (fitted)&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Down (fitted)&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_crosses&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>

        <span class="c1"># Making a nice plot</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nolegend&#39;</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu_0 H_</span><span class="si">{ext}</span><span class="s2">$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>

        <span class="c1"># Setting correct Y Label</span>
        <span class="n">bhmin</span><span class="p">,</span> <span class="n">bhmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bhmin</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">bhmax</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>

        <span class="c1"># Setting Title</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">figtitle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">figtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
                <span class="n">figtitle</span> <span class="o">=</span> <span class="s2">&quot;M</span><span class="si">%s</span><span class="s2">: $</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">figtitle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_downminusup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting the difference between the down and up sweep. ax: Matplotlib</span>
<span class="sd">        Axis to plot on. figtitle: can be set to a manual figure title.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax:</span>
<span class="sd">            figtitle:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">B</span><span class="p">,</span> <span class="n">vx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">vx</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$B [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$V_x [</span><span class="se">\\</span><span class="s2">mathrm{</span><span class="se">\\</span><span class="s2">mu V}]$&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">figtitle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">figtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">figtitle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_downminusup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">1e5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the magnetic field and difference between down and up sweep.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">            B, Vx = meas.get_downminusup() plt.plot(B, Vx)</span>

<span class="sd">        Args:</span>
<span class="sd">            n:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span>

    <span class="k">def</span> <span class="nf">get_downminusup_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">1e5</span><span class="p">,</span> <span class="n">fitted_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the magnetic field and difference between down and up sweep.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">           B_ext, Bx = meas.get_downminusup_strayfield() plt.plot(B_ext, Bx)</span>

<span class="sd">        Args:</span>
<span class="sd">            n:</span>
<span class="sd">            fitted_data:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fitted_data</span><span class="p">:</span>
            <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span>
            <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span>
            <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span>
        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">)</span>
        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span>

    <span class="k">def</span> <span class="nf">get_coercive_field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the mean and coercive fields calculated.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">           mean, coer1, coer2 = meas.get_coercive_field()</span>
<span class="sd">           print(&#39;Coercive Field (up sweep): (%.3f, %.3f)&#39; % (coer1, mean))</span>
<span class="sd">           print(&#39;Coercive Field (down sweep): (%.3f, %.3f)&#39; % (coer2, mean))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span>
            <span class="s1">&#39;Vx8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">coer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span> \
                                              <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">350</span><span class="p">][</span>
                                              <span class="s1">&#39;Vx8&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
        <span class="n">coer2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span> \
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">350</span><span class="p">][</span>
                                                 <span class="s1">&#39;Vx8&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">coer</span><span class="p">,</span> <span class="n">coer2</span>

    <span class="k">def</span> <span class="nf">plot_hysteresis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_downminusup</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_remanence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the remanent voltage calculated.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">           rem1, rem2 = meas.get_remanence()</span>
<span class="sd">           print(&#39;Remanent Voltage (up sweep): (%d, %.3f)&#39; % (0, rem1))</span>
<span class="sd">           print(&#39;Remanent Voltage (down sweep): (%d, %.3f)&#39; % (0, rem2))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rem1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
        <span class="n">rem2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">rem1</span><span class="p">,</span> <span class="n">rem2</span>

    <span class="k">def</span> <span class="nf">get_minmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the minimum and maximum of the field and voltage.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">           bmin, bmax, vmin, vmax = meas.get_minmax()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
        <span class="n">bmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="n">max_8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">max_9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">max_13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">max_8</span><span class="p">,</span> <span class="n">max_9</span><span class="p">,</span> <span class="n">max_13</span><span class="p">])</span>

            <span class="n">min_8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">min_9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">min_13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">min_8</span><span class="p">,</span> <span class="n">min_9</span><span class="p">,</span> <span class="n">min_13</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>

    <span class="k">def</span> <span class="nf">get_bhminmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the minimum and maximum of the measured hall voltage</span>
<span class="sd">        converted to strayfield.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :caption: Example</span>

<span class="sd">           bhmin, bhmax = meas.get_bhminmax()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
        <span class="n">min_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="n">max_9</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">max_8</span><span class="p">,</span> <span class="n">max_9</span><span class="p">])</span>

            <span class="n">min_9</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">min_8</span><span class="p">,</span> <span class="n">min_9</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">max_8</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="n">min_8</span>

        <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>

    <span class="k">def</span> <span class="nf">get_default_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;m</span><span class="si">%s</span><span class="s2">: $</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1">^</span><span class="se">\\</span><span class="s1">circ$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">],</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="multiplem-1">
<h3><a class="toc-backref" href="#toc-entry-24" role="doc-backlink">MultipleM</a><a class="headerlink" href="#multiplem-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MultipleM</span><span class="p">(</span><span class="n">MeasurementClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;MultipleM:</span>

<span class="sd">        Main parent class for all multiple measurements. These Measurements</span>
<span class="sd">        are represent by one data variable.</span>

<span class="sd">        All multiple measurements have a variable called ``multi_info`` which</span>
<span class="sd">        contains a pandas.DataFrame with parameter settings to single</span>
<span class="sd">        measurements.</span>

<span class="sd">        All multiple measurements can be represented by</span>

<span class="sd">            &gt;&gt;&gt; m = ana.MultipleM()</span>
<span class="sd">            &gt;&gt;&gt; m</span>
<span class="sd">            Nr. 0: Hloop</span>
<span class="sd">            Nr. 0: RAW</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;data/mfn_info.csv&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/mfn_info.csv&#39;</span><span class="p">)</span>
    
    
    <span class="n">query</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_lofm_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Workaround to get list of measurements for sweeps.</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (dict): Measurement Numbers pointing to label format</span>
<span class="sd">                variables: e.g. `` {nr: [-1, 1, &#39;Plusses&#39;, &#39;2 mT/min&#39;]}</span>
<span class="sd">            label (str): Label to show in plots: e.g. &quot;Show %s -&gt; %s (%s) %s &quot;</span>
<span class="sd">                -&gt; will be formated using to_show</span>
<span class="sd">            options (dict, default: empty): Additional plotting options</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: List of Measurements with description</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lofm</span><span class="p">(</span><span class="n">to_show</span><span class="p">,</span> 
                             <span class="n">label</span><span class="p">,</span> 
                             <span class="n">options</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;Updates multi_info DataFrame. Reads csv and adds information to</span>
<span class="sd">        self.multi_info</span>

<span class="sd">        Args:</span>
<span class="sd">            *args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">get_lofm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Returns the List of Measurements (lofm) for plot functions</span>
<span class="sd">            (see :meth:`ana.HandleM.plot`).</span>

<span class="sd">        Args:</span>
<span class="sd">            to_show (dict): Measurement Numbers pointing to label format</span>
<span class="sd">                variables: e.g. ``{nr: [(-1, 1), &#39;Plusses&#39;, &#39;5 mT/min&#39;]}``</span>
<span class="sd">            label (str): Label to show in plots: e.g.</span>
<span class="sd">                ``&quot;Show %s -&gt; %s (%s) %s &quot;`` -&gt; will be string formated using</span>
<span class="sd">                to_show</span>
<span class="sd">            options (dict, optional, default: empty): Additional plotting</span>
<span class="sd">                parameters</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: List of Measurements with description: ``{nr: [labels]}``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">form</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="c1"># elif isinstance(content[0], str) or \</span>
            <span class="c1">#         isinstance(content[0], int) or \</span>
            <span class="c1">#         isinstance(content[0], float):</span>
            <span class="c1">#    form = content[0], content[1], content[2]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">form</span> <span class="o">=</span> <span class="n">content</span>
                
            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="o">%</span> <span class="n">form</span><span class="p">,</span> <span class="n">options</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">lofm</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="plottingclass-1">
<h3><a class="toc-backref" href="#toc-entry-25" role="doc-backlink">PlottingClass</a><a class="headerlink" href="#plottingclass-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PlottingClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Defines the basic plotting style.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            **style:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dpi&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s1">&#39;figure.autolayout&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
            <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
            <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
            <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;lines.markersize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
            <span class="s1">&#39;mpl_style&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;latex&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;default_cm&#39;</span><span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Default Plotting Class&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">default_style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">)</span>

    <span class="n">get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> \
                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            other:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            key:</span>
<span class="sd">            value:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># Set Plotting Style</span>
    <span class="k">def</span> <span class="nf">set_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the Style for plots</span>
<span class="sd">    </span>
<span class="sd">        :param size: A dictionary of parameters or the name of a preconfigured set.</span>
<span class="sd">        :type size: dict, None, or one of {paper, notebook, talk, poster}</span>

<span class="sd">        :param style:</span>
<span class="sd">        :type style: dict, None, or one of {darkgrid, whitegrid, dark, white, ticks}</span>
<span class="sd">    </span>
<span class="sd">        :param default: if True it sets default</span>
<span class="sd">            :code:`size=talk` and</span>
<span class="sd">            :code:`style=whitegrid`</span>
<span class="sd">        :type default: bool</span>

<span class="sd">        :param notebook: if True it sets default</span>
<span class="sd">            :code:`size=notebook` and</span>
<span class="sd">            :code:`style=ticks`</span>

<span class="sd">        :type notebook: bool</span>

<span class="sd">    </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>
<span class="sd">    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
            <span class="n">def_size</span> <span class="o">=</span> <span class="s1">&#39;talk&#39;</span>
            <span class="n">def_style</span> <span class="o">=</span> <span class="s1">&#39;whitegrid&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">):</span>
            <span class="n">def_size</span> <span class="o">=</span> <span class="s1">&#39;notebook&#39;</span>
            <span class="n">def_style</span> <span class="o">=</span> <span class="s1">&#39;ticks&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">def_size</span> <span class="o">=</span> <span class="s1">&#39;talk&#39;</span>
            <span class="n">def_style</span> <span class="o">=</span> <span class="s1">&#39;whitegrid&#39;</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="n">def_size</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">def_style</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;palette&#39;</span><span class="p">,</span> <span class="s1">&#39;deep&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;font-scale&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span>

        <span class="n">latex</span> <span class="o">=</span> <span class="s1">&#39;latex&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">latex</span>
        <span class="k">if</span> <span class="n">latex</span><span class="p">:</span>  <span class="c1"># True activates latex output in fonts!</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span>
                <span class="s1">&#39;text.latex.preamble&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;set_mpl_params&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_params&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="s1">&#39;figure.dpi&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
                <span class="s1">&#39;savefig.dpi&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
                <span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">),</span>
                <span class="s1">&#39;figure.autolayout&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
                <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;lines.markersize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                <span class="s1">&#39;figure.subplot.hspace&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                <span class="s1">&#39;figure.subplot.wspace&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                <span class="s1">&#39;savefig.transparent&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;savefig.bbox&#39;</span><span class="p">:</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span>
                <span class="s1">&#39;savefig.pad_inches&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="p">})</span>
            <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;figure.autolayout&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;font.size&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;lines.markersize&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span>
            <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="n">update_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">update_keys</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> \
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">([</span><span class="n">_</span> <span class="ow">in</span> <span class="n">style</span> \
                                        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">])</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="p">})</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_style&#39;</span><span class="p">):</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_style&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            custom:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">custom</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_style&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">set_plot_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">))</span>

        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">xmin</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ymin</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_settings&#39;</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_location&#39;</span><span class="p">,</span> <span class="s1">&#39;best&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_settings&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">])</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;$f$ [Hz]&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1">$ [${V^2}$/</span><span class="si">{Hz}</span><span class="s1">]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_oneoverf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Draw 1/f</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ax:</span>
<span class="sd">            **kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">)</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_label&#39;</span><span class="p">):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_label&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$1/f$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$1/f^</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">alpha</span>

        <span class="n">mean_x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mean_x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">factor</span><span class="p">)))</span>
        <span class="n">mean_y</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mean_y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">/</span> <span class="p">(</span><span class="n">factor</span> <span class="o">**</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disable&#39;</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">*</span> <span class="n">factor</span><span class="p">],</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">/</span> <span class="p">(</span><span class="n">factor</span> <span class="o">**</span> <span class="n">alpha</span><span class="p">)],</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">mean_x</span><span class="p">,</span> <span class="n">mean_y</span><span class="p">),</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;an_color&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">),</span>
                        <span class="n">size</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;an_size&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">save_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">fext</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Saves the current plot as file.</span>

<span class="sd">        Args:</span>
<span class="sd">            fname (str): Filename</span>
<span class="sd">            fext (str): Extension</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fext</span> <span class="o">==</span> <span class="s1">&#39;pgf&#39;</span><span class="p">:</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s2">&quot;pgf.texsystem&quot;</span><span class="p">:</span> <span class="s2">&quot;pdflatex&quot;</span><span class="p">,</span>
                <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                <span class="s1">&#39;text.usetex&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;pgf.rcfonts&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;text.latex.preamble&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\usepackage[utf8]</span><span class="si">{inputenc}</span><span class="s1">\DeclareUnicodeCharacter</span><span class="si">{2212}</span><span class="s1">{-}&#39;</span>
            <span class="p">})</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">fext</span><span class="p">),</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;pgf&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">fext</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</section>
<section id="functions-1">
<h3><a class="toc-backref" href="#toc-entry-26" role="doc-backlink">Functions</a><a class="headerlink" href="#functions-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># SPDX-FileCopyrightText: 2020/2021 Jonathan Pieper &lt;ody55eus@mailbox.org&gt;</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: GPL-3.0-or-later</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Helps to handle measurements and style plots.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="kn">from</span> <span class="nn">.plotting</span> <span class="kn">import</span> <span class="n">PlottingClass</span>
<span class="kn">from</span> <span class="nn">.measurement</span> <span class="kn">import</span> <span class="n">MeasurementClass</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">PlottingClass</span><span class="p">()</span>
<span class="n">set_sns</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_style</span>
<span class="n">set_plot_settings</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_plot_settings</span>

<span class="n">meas</span> <span class="o">=</span> <span class="n">MeasurementClass</span><span class="p">()</span>
<span class="n">get_info_from_name</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_info_from_name</span>


<span class="k">def</span> <span class="nf">getpath</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Alias for ``glob``.</span>

<span class="sd">    Args:</span>
<span class="sd">        *arg:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">glob</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">timing</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wraps a function to measure the time it takes.</span>

<span class="sd">    Args:</span>
<span class="sd">        f:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">te</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;func:</span><span class="si">%r</span><span class="s1"> took: </span><span class="si">%2.4f</span><span class="s1"> sec&#39;</span> <span class="o">%</span> \
          <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">te</span><span class="o">-</span><span class="n">ts</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">wrap</span>
</pre></div>
</td></tr></table></div>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020/2021, Jonathan Pieper.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>