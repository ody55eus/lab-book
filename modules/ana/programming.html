<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Programming Documentation &mdash; Lab Book 0.4 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Lab Book
          </a>
              <div class="version">
                0.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Lab Book</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/gitlab.html">GitLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/onenote/index.html">Original Lab Book</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">About the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/hloop/index.html">Magnetic Characterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/mfn/index.html">Magnetic Flux Noise (MFN)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Data Analysis Framework (Ana)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="README.html">Readme</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Programming Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#uml-diagram">UML Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#high-level-interface">High Level Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plot">Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handlem">HandleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mfn">MFN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#low-level-python-backend">Low Level Python Backend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#measurementclass">MeasurementClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#singlem">SingleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiplem">MultipleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plottingclass">PlottingClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ana.functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#source-code">Source Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id27">Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28">HandleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">MFN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">MeasurementClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id31">SingleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32">RAW</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33">SA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id34">Hloop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id35">MultipleM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id36">PlottingClass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sa/index.html">SpectrumAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eve/index.html">EVE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Python Scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../info/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../info/idx.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Lab Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Data Analysis Framework (Ana)</a> &raquo;</li>
      <li>Programming Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/modules/ana/programming.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="programming-documentation">
<h1>Programming Documentation<a class="headerlink" href="#programming-documentation" title="Permalink to this headline">ÔÉÅ</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#uml-diagram" id="id49">UML Diagram</a></p></li>
<li><p><a class="reference internal" href="#high-level-interface" id="id50">High Level Interface</a></p>
<ul>
<li><p><a class="reference internal" href="#plot" id="id51">Plot</a></p></li>
<li><p><a class="reference internal" href="#handlem" id="id52">HandleM</a></p></li>
<li><p><a class="reference internal" href="#mfn" id="id53">MFN</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#low-level-python-backend" id="id54">Low Level Python Backend</a></p>
<ul>
<li><p><a class="reference internal" href="#measurementclass" id="id55">MeasurementClass</a></p></li>
<li><p><a class="reference internal" href="#singlem" id="id56">SingleM</a></p>
<ul>
<li><p><a class="reference internal" href="#raw" id="id57">RAW</a></p></li>
<li><p><a class="reference internal" href="#sa" id="id58">SA</a></p></li>
<li><p><a class="reference internal" href="#hloop" id="id59">Hloop</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#multiplem" id="id60">MultipleM</a></p></li>
<li><p><a class="reference internal" href="#plottingclass" id="id61">PlottingClass</a></p></li>
<li><p><a class="reference internal" href="#module-ana.functions" id="id62">Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#source-code" id="id63">Source Code</a></p>
<ul>
<li><p><a class="reference internal" href="#id27" id="id64">Plot</a></p></li>
<li><p><a class="reference internal" href="#id28" id="id65">HandleM</a></p></li>
<li><p><a class="reference internal" href="#id29" id="id66">MFN</a></p></li>
<li><p><a class="reference internal" href="#id30" id="id67">MeasurementClass</a></p></li>
<li><p><a class="reference internal" href="#id31" id="id68">SingleM</a></p></li>
<li><p><a class="reference internal" href="#id32" id="id69">RAW</a></p></li>
<li><p><a class="reference internal" href="#id33" id="id70">SA</a></p></li>
<li><p><a class="reference internal" href="#id34" id="id71">Hloop</a></p></li>
<li><p><a class="reference internal" href="#id35" id="id72">MultipleM</a></p></li>
<li><p><a class="reference internal" href="#id36" id="id73">PlottingClass</a></p></li>
<li><p><a class="reference internal" href="#id37" id="id74">Functions</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="uml-diagram">
<h2><a class="toc-backref" href="#id49" role="doc-backlink">UML Diagram</a><a class="headerlink" href="#uml-diagram" title="Permalink to this headline">ÔÉÅ</a></h2>
<figure class="align-default" id="id38">
<img alt="../../_images/ana_uml.svg" src="../../_images/ana_uml.svg" /><figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">UML diagram of inheritance and created objects</span><a class="headerlink" href="#id38" title="Permalink to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</section>
<section id="high-level-interface">
<h2><a class="toc-backref" href="#id50" role="doc-backlink">High Level Interface</a><a class="headerlink" href="#high-level-interface" title="Permalink to this headline">ÔÉÅ</a></h2>
<section id="plot">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">Plot</a><a class="headerlink" href="#plot" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.plot.Plot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Plot</span></span><a class="reference internal" href="../../_modules/ana/plot.html#Plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A small class used to plot figures for a presentation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.compare_sweeprates">
<span class="sig-name descname"><span class="pre">compare_sweeprates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'compare-sweeprates'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.compare_sweeprates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.compare_sweeprates" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Compare different Sweeprates, fits the data and</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.compare_voltages">
<span class="sig-name descname"><span class="pre">compare_voltages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'compare-voltages'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.compare_voltages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.compare_voltages" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Compare different applied Voltages.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>compare-voltages.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.fast_sweeprate">
<span class="sig-name descname"><span class="pre">fast_sweeprate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[320,</span> <span class="pre">325,</span> <span class="pre">323,</span> <span class="pre">329]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FastSR-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\\Huge</span> <span class="pre">\\textbf{a)</span> <span class="pre">Large</span> <span class="pre">Field</span> <span class="pre">Sweeps}'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.fast_sweeprate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.fast_sweeprate" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>anas Fast Sweeps over large sweep ranges (1T)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_numbers</strong> ‚Äì </p></li>
<li><p><strong>xlim</strong> ‚Äì </p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is ‚ÄòFastSR-1‚Äô.</p></li>
<li><p><strong>pos2</strong> ‚Äì </p></li>
<li><p><strong>title</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.first_sweeps">
<span class="sig-name descname"><span class="pre">first_sweeps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vacant-sweeps'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.first_sweeps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.first_sweeps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>First field sweeps (plus minus 50/75/100/etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add</strong> ‚Äì adding more data</p></li>
<li><p><strong>filename</strong> ‚Äì saving as pdf (default: vacant-sweeps)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>vacant-sweeps.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.get_plot">
<span class="sig-name descname"><span class="pre">get_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.get_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.get_plot" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.measplan12">
<span class="sig-name descname"><span class="pre">measplan12</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.measplan12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.measplan12" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.measplan12_2">
<span class="sig-name descname"><span class="pre">measplan12_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.measplan12_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.measplan12_2" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.measplan12_full">
<span class="sig-name descname"><span class="pre">measplan12_full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'measplan12-full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.measplan12_full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.measplan12_full" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>measurement Plan #12 All 14 measurements in one Graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.multiple_fspans">
<span class="sig-name descname"><span class="pre">multiple_fspans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'multiple-fspans'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.multiple_fspans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.multiple_fspans" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.negative_sweeps">
<span class="sig-name descname"><span class="pre">negative_sweeps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.negative_sweeps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.negative_sweeps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Testing without file output.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_cubes_trees">
<span class="sig-name descname"><span class="pre">plot_cubes_trees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_cubes_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_cubes_trees" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots difference between RAW data from Cubes and Trees (1st
Generation)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloop_gradient">
<span class="sig-name descname"><span class="pre">plot_hloop_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-gradient'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_gradient" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting the gradient along the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> ‚Äì </p></li>
<li><p><strong>filename</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloop_gradient2">
<span class="sig-name descname"><span class="pre">plot_hloop_gradient2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-gradient'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_gradient2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_gradient2" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting the gradient along the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> ‚Äì </p></li>
<li><p><strong>filename</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloop_gradient3">
<span class="sig-name descname"><span class="pre">plot_hloop_gradient3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[139,</span> <span class="pre">140]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Vx8'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_gradient3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_gradient3" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting the gradient along the</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> ‚Äì </p></li>
<li><p><strong>to_show</strong> ‚Äì </p></li>
<li><p><strong>limit</strong> ‚Äì </p></li>
<li><p><strong>column</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloop_temp">
<span class="sig-name descname"><span class="pre">plot_hloop_temp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloop_temp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloop_temp" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots the Temperature of a Hloop measurement.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops">
<span class="sig-name descname"><span class="pre">plot_hloops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[54,</span> <span class="pre">55]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-compare-1'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Compares Plusses and Crosses between two angles (4 Subplots).
Default: 0 and 45 Writes file hloop-compare-1.pdf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>list</em><em>, </em><em>optional</em>) ‚Äì List of 4 measurement numbers,
defaults to [54, 55]</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION, defaults to ‚Äòhloop-compare-1‚Äô</p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops2">
<span class="sig-name descname"><span class="pre">plot_hloops2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[58,</span> <span class="pre">59,</span> <span class="pre">61,</span> <span class="pre">62]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-compare-3'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops2" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Outputs hloop-compare-3.pdf (not used anymore)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is a[85]+a[100].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is
‚Äòhloop-compare-3‚Äô.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) ‚Äì DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops3">
<span class="sig-name descname"><span class="pre">plot_hloops3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[139,</span> <span class="pre">140]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-repeat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">350,</span> <span class="pre">350)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">30,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.15,</span> <span class="pre">1.25)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops3" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><blockquote>
<div><p>Compares two measurements at the same Angle (repeated
measurements).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is [139,140].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is
‚Äòhloop-repeat‚Äô.</p></li>
<li><p><strong>xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is (-350, 350).</p></li>
<li><p><strong>ylim</strong> ‚Äì </p></li>
<li><p><strong>inset_xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is (-30, 30).</p></li>
<li><p><strong>inset_ylim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is (.15,
1.25).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops4">
<span class="sig-name descname"><span class="pre">plot_hloops4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-parallel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'M57:</span> <span class="pre">$90^\\circ$</span> <span class="pre">Parallel</span> <span class="pre">measurement'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops4" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a single measurement (default: 90deg parallel)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is
‚Äòhloop-parallel‚Äô.</p></li>
<li><p><strong>figtitle</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is ‚ÄúM57:
$90^circ$ Parallel measurement‚Äù.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) ‚Äì DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops_90">
<span class="sig-name descname"><span class="pre">plot_hloops_90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[57,</span> <span class="pre">155]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-compare-90'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_90" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Compares +90deg with -90deg for (180deg Comparison)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is [57,155].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is
‚Äòhloop-compare-90‚Äô.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) ‚Äì mirror: bool, optional
should we mirror the hloop? The default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops_90_nofit">
<span class="sig-name descname"><span class="pre">plot_hloops_90_nofit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[57,</span> <span class="pre">155]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-compare-90'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_90_nofit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_90_nofit" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Compares +90deg with -90deg for (180deg Comparison) Using not fitted
data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is [57,155].</p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is
‚Äòhloop-compare-90‚Äô.</p></li>
<li><p><strong>**kwargs</strong> (<em>TYPE</em>) ‚Äì mirror: bool, optional
should we mirror the hloop? The default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops_95">
<span class="sig-name descname"><span class="pre">plot_hloops_95</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[42,</span> <span class="pre">43,</span> <span class="pre">32,</span> <span class="pre">34]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-compare-95'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_95"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_95" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Compares +95/100/105/110deg with -85/80/75/70deg for (180deg
Comparison)</p>
<p>:param filename:Filename to save. The default is ‚Äòhloop-compare-95‚Äô.
:type filename: str, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>list</em><em>, </em><em>optional</em>) ‚Äì Measurement numbers to plot. The default
is a[95]+a[-85].</p></li>
<li><p><strong>filename</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{filename}.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_hloops_compare_90">
<span class="sig-name descname"><span class="pre">plot_hloops_compare_90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[414,</span> <span class="pre">415]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plusses'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-repeat-414'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">750,</span> <span class="pre">750)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">0.36,</span> <span class="pre">0.76)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">225,</span> <span class="pre">225)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">0.35,</span> <span class="pre">0.75)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[((0.05,</span> <span class="pre">0.05,</span> <span class="pre">0.35,</span> <span class="pre">0.35),</span> <span class="pre">((-</span> <span class="pre">225,</span> <span class="pre">225),</span> <span class="pre">(-</span> <span class="pre">0.35,</span> <span class="pre">0.75),</span> <span class="pre">'blue',</span> <span class="pre">0.1))]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nograd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">12)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_hloops_compare_90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_hloops_compare_90" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><blockquote>
<div><p>Compares multiple measurements at 90 deg (repeated
measurements).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is [414,415].</p></li>
<li><p><strong>structure</strong> ‚Äì </p></li>
<li><p><strong>filename</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is
‚Äòhloop-repeat-414‚Äô.</p></li>
<li><p><strong>xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is (-750, 750).</p></li>
<li><p><strong>ylim</strong> ‚Äì </p></li>
<li><p><strong>inset_xlim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is (-100,
100).</p></li>
<li><p><strong>inset_ylim</strong> (<em>TYPE</em><em>, </em><em>optional</em>) ‚Äì DESCRIPTION. The default is (-1.25,
.75).</p></li>
<li><p><strong>legend_loc</strong> ‚Äì </p></li>
<li><p><strong>nograd</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_single_hloop">
<span class="sig-name descname"><span class="pre">plot_single_hloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">54</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hloop-single-1'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_single_hloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_single_hloop" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a single measurement. Default: 0deg</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> ‚Äì </p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) ‚Äì File to write. The default is
‚Äòhloop-single-1‚Äô.</p></li>
<li><p><strong>ylim</strong> (<em>xlim /</em>) ‚Äì limit the plots axes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{filename}.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.plot_static_fields">
<span class="sig-name descname"><span class="pre">plot_static_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'static-field'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.plot_static_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.plot_static_fields" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plot the Signal Analyzer (SA) Data for static fields (not sweeping)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.set_plot_style">
<span class="sig-name descname"><span class="pre">set_plot_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.set_plot_style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.set_plot_style" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.set_size">
<span class="sig-name descname"><span class="pre">set_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.set_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.set_size" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Set figure dimensions to sit nicely in our document.</p>
<p>Source: <a class="reference external" href="https://jwalton.info/Matplotlib-latex-PGF/">https://jwalton.info/Matplotlib-latex-PGF/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width_pt</strong> (<em>float</em>) ‚Äì Document width in points</p></li>
<li><p><strong>fraction</strong> (<em>float</em><em>, </em><em>optional</em>) ‚Äì Fraction of the width which you wish the figure to occupy</p></li>
<li><p><strong>subplots</strong> (<em>array-like</em><em>, </em><em>optional</em>) ‚Äì The number of rows and columns of subplots.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig_dim</strong> ‚Äì Dimensions of figure in inches</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plot.Plot.sv_temp_effect">
<span class="sig-name descname"><span class="pre">sv_temp_effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sv-temp-effect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plot.html#Plot.sv_temp_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plot.Plot.sv_temp_effect" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="handlem">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">HandleM</a><a class="headerlink" href="#handlem" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.HandleM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HandleM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.MultipleM" title="ana.multiple.MultipleM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.multiple.MultipleM</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> ‚Äì </p></li>
<li><p><strong>kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Measurement Handler:</strong> This class represents all other
measurements and is the interface to other measurement objets.</p>
</aside>
<dl class="py method">
<dt class="sig sig-object py" id="ana.HandleM.get_custom_header">
<span class="sig-name descname"><span class="pre">get_custom_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RAW'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.get_custom_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM.get_custom_header" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Help Function to get column names for EVE Measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em><em>, </em><em>optional</em>) ‚Äì Kind of measurement, default: ‚ÄòRAW‚Äô</p></li>
<li><p><strong>instruments</strong> (<em>list</em><em>, </em><em>optional</em>) ‚Äì Used instruments in order of
appearance, default: [‚Äòt‚Äô, ‚ÄòLS‚Äô, ‚ÄòIPS‚Äô, ‚ÄòSR830‚Äô]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(list header, int skiprows)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.HandleM.get_info">
<span class="sig-name descname"><span class="pre">get_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.get_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM.get_info" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns information about all measurements
and splits it into groups (SA/RAV/MFN/VH).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.HandleM.load_files">
<span class="sig-name descname"><span class="pre">load_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.load_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM.load_files" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Loads all files from a specific directory and creates objects for
found measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>str</em>) ‚Äì directory to search in</p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.HandleM.load_folder">
<span class="sig-name descname"><span class="pre">load_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.load_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM.load_folder" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.HandleM.parse_data">
<span class="sig-name descname"><span class="pre">parse_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.parse_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM.parse_data" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>imports data and sets info variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">parse_data</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Nr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span> <span class="n">kw</span><span class="p">)</span> <span class="p">})</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict</em>) ‚Äì Data to parse</p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.HandleM.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/handle.html#HandleM.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.HandleM.plot" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting a Measurement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lofm</strong> ‚Äì list of measurements</p></li>
<li><p><strong>figsize</strong> ‚Äì tuple size of figure</p></li>
<li><p><strong>show_fit</strong> ‚Äì bool</p></li>
<li><p><strong>fit_range</strong> ‚Äì tuple/list</p></li>
<li><p><strong>plot_settings</strong> ‚Äì list</p></li>
<li><p><strong>grid_options</strong> ‚Äì list</p></li>
<li><p><strong>f_settings</strong> ‚Äì 1/f line</p></li>
<li><p><strong>f2_settings</strong> ‚Äì 1/f^2 line</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure, Axis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>warning</strong> ‚Äì lofm not available.</p></li>
<li><p><strong>KeyError</strong> ‚Äì Measurement does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="mfn">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">MFN</a><a class="headerlink" href="#mfn" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.MFN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MFN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.MultipleM" title="ana.multiple.MultipleM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.multiple.MultipleM</span></code></a></p>
<p>Magnetic Flux Noise Measurements.
Class to handle and plot MFN Measurements
taken with the SR830 DAQ.</p>
<p>if a measurement number is given the files are
loaded from folder:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">data/MFN/m%s/*.dat</span></code></p>
</div></blockquote>
<p>else: files must be a list of filenames:</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id39">
<div class="code-block-caption"><span class="caption-number">Listing 4 </span><span class="caption-text">Example</span><a class="headerlink" href="#id39" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">arg</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/MFN/mXXX/m[0-9.]*.dat&#39;</span><span class="p">)</span>
<span class="linenos">2</span><span class="n">mfn</span> <span class="o">=</span> <span class="n">MFN</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> ‚Äì list of files or measurement number.</p></li>
<li><p><strong>kwargs</strong> ‚Äì Different additional parameters.</p></li>
<li><p><strong>nr</strong> (<em>int</em>) ‚Äì Measurement number
(default: None).</p></li>
<li><p><strong>calc_first</strong> (<em>bool</em>) ‚Äì Calculating first spectrum
(default: True).</p></li>
<li><p><strong>calc_second</strong> (<em>bool</em>) ‚Äì Calculating second spectrum
(default: False).</p></li>
<li><p><strong>downsample</strong> (<em>bool</em>) ‚Äì downsample timesignal for first spectrum
(default: False).</p></li>
<li><p><strong>num_first_spectra</strong> (<em>int</em>) ‚Äì Number of spectra to average
(default: 64).</p></li>
<li><p><strong>timeconstant</strong> (<em>float</em>) ‚Äì Lock-In timeconstant to cut first spectrum
at corresponding frequency (see <code class="docutils literal notranslate"><span class="pre">cut_fmax</span></code>).</p></li>
<li><p><strong>cut_fmax</strong> (<em>float</em>) ‚Äì Cut first spectrum at this frequency
(default: <span class="math notranslate nohighlight">\(f_{max} = \frac{\tau}{2\pi}\)</span>).</p></li>
<li><p><strong>default_cm</strong> (<em>matplotlib.cm</em>) ‚Äì matplotlib color map for contour plots
(default: style[‚Äòdefault_cm‚Äô]).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.cut_fmax">
<span class="sig-name descname"><span class="pre">cut_fmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.cut_fmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.cut_fmax" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Cut frequencies higher than maximum allowed frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fmax</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.load_meas">
<span class="sig-name descname"><span class="pre">load_meas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.load_meas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.load_meas" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Loading a single magnetic flux noise DAQ measurement.</p>
<p>Files in measrument folder contain multiple measurements
with one measurement per field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>files</strong> ‚Äì files to load</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame Data, dict Measurement Objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.load_voltages">
<span class="sig-name descname"><span class="pre">load_voltages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">508</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">12)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.load_voltages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.load_voltages" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_alpha">
<span class="sig-name descname"><span class="pre">plot_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_alpha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_alpha" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Fits a spectrum and plots the slope alpha.
:param s: pandas.DataFrame of the spectrum
:param ax: axis where to plot the data.
:return: linear regression fit</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_compare_timesignals">
<span class="sig-name descname"><span class="pre">plot_compare_timesignals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_compare_timesignals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_compare_timesignals" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a grid of 2x2 subplots to compare timesignals and histogram.
:param fields: list
:param factor: float Default: 1e3 (mV)
:param nrows: int Default: len(fields)
:param ncols: int Default: 2
:param sharey: bool Default: True
:param figsize: tuple Default: (11.69, 8.27) in
:param plot_range: int Default: -1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_field_contour">
<span class="sig-name descname"><span class="pre">plot_field_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax31</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_field_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_field_contour" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_first_and_second">
<span class="sig-name descname"><span class="pre">plot_first_and_second</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_first_and_second"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_first_and_second" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_info">
<span class="sig-name descname"><span class="pre">plot_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_info" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots basic mfn infos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_field</strong> ‚Äì </p></li>
<li><p><strong>kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_info2">
<span class="sig-name descname"><span class="pre">plot_info2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_info2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_info2" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_multiple_histograms">
<span class="sig-name descname"><span class="pre">plot_multiple_histograms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields=Series([]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor=1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim=(-1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_multiple_histograms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_multiple_histograms" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots multiple histograms using seaborn <code class="docutils literal notranslate"><span class="pre">sns.FacetGrid</span></code>
with kdeplot.</p>
<dl class="simple">
<dt>default kwargs for subplots:</dt><dd><p>kde1_kwargs = dict(clip_on=True, shade=True, alpha=1, lw=1.5, bw=.2)
kde2_kwargs = kde1_kwargs.update(dict(lw=2, color=‚Äôw‚Äô)
dist_kwargs = dict(hist=True, norm_hist=True, hist_kws={‚Äòalpha‚Äô: .5})
ax_kwargs = dict(y=0, lw=2, clip_on=True).set(xlim=(-1.3,1.3))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_noise_chararcteristics">
<span class="sig-name descname"><span class="pre">plot_noise_chararcteristics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_noise_chararcteristics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_noise_chararcteristics" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> ‚Äì </p></li>
<li><p><strong>fields</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_various_noise_fits">
<span class="sig-name descname"><span class="pre">plot_various_noise_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_various_noise_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_various_noise_fits" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_various_noise_repr">
<span class="sig-name descname"><span class="pre">plot_various_noise_repr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_various_noise_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_various_noise_repr" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.plot_various_timesignals">
<span class="sig-name descname"><span class="pre">plot_various_timesignals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.plot_various_timesignals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.plot_various_timesignals" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a grid of 9 subplots with different timesignals
:param fields: list
:param nrows: int Default: len(fields)
:param ncols: int Default: 2
:param sharey: bool Default: True
:param figsize: tuple Default: (11.69, 8.27) in
:param plot_range: int Default: -1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.read" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Write data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.spectra_field_contour">
<span class="sig-name descname"><span class="pre">spectra_field_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.spectra_field_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.spectra_field_contour" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.subtract_mean">
<span class="sig-name descname"><span class="pre">subtract_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.subtract_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.subtract_mean" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Subtracts mean value from timesignal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> (<em>bool</em>) ‚Äì Change variable inside this object?</p></li>
<li><p><strong>fields</strong> ‚Äì list of fields to fit</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>normalized timesignal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MFN.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/mfn.html#MFN.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MFN.write" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Write data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) ‚Äì </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="low-level-python-backend">
<h2><a class="toc-backref" href="#id54" role="doc-backlink">Low Level Python Backend</a><a class="headerlink" href="#low-level-python-backend" title="Permalink to this headline">ÔÉÅ</a></h2>
<section id="measurementclass">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">MeasurementClass</a><a class="headerlink" href="#measurementclass" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.measurement.MeasurementClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MeasurementClass</span></span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.measurement.MeasurementClass" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The main measurement class for all measurements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>MeasurementClass:</strong>
This Class is the parent of all other measurement classes.</p>
</aside>
<p>All measurements have the following variables:</p>
<dl class="simple">
<dt>name: str/None</dt><dd><p>The name of the Measurement Class (e.g. SA, RAW, etc.)</p>
</dd>
<dt>info: dict</dt><dd><dl class="simple">
<dt>Contains informations about the measurement. Typical keys are:</dt><dd><p>Nr: float, the number of the measurement,</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ana.measurement.MeasurementClass.calc_log">
<span class="sig-name descname"><span class="pre">calc_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f',</span> <span class="pre">'Vx',</span> <span class="pre">'Vy']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass.calc_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.measurement.MeasurementClass.calc_log" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.measurement.MeasurementClass.get_info_from_name">
<span class="sig-name descname"><span class="pre">get_info_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass.get_info_from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.measurement.MeasurementClass.get_info_from_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‚Äòkey-value‚Äô pairs
separated by ‚Äò_‚Äô.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> ‚Äì filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> ‚Äì <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.measurement.MeasurementClass.i">
<span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/measurement.html#MeasurementClass.i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.measurement.MeasurementClass.i" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> ‚Äì <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#id3"><span class="problematic" id="id4">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="singlem">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">SingleM</a><a class="headerlink" href="#singlem" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.SingleM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SingleM</span></span><a class="reference internal" href="../../_modules/ana/single.html#SingleM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.SingleM" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.measurement.MeasurementClass" title="ana.measurement.MeasurementClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.measurement.MeasurementClass</span></code></a></p>
<p>The main constructor for all single measurements.</p>
<dl class="py method">
<dt class="sig sig-object py" id="ana.SingleM.calc_log">
<span class="sig-name descname"><span class="pre">calc_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f',</span> <span class="pre">'Vx',</span> <span class="pre">'Vy']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.calc_log" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SingleM.fit_variable">
<span class="sig-name descname"><span class="pre">fit_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/single.html#SingleM.fit_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.SingleM.fit_variable" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) ‚Äì Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SingleM.get_info_from_name">
<span class="sig-name descname"><span class="pre">get_info_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.get_info_from_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‚Äòkey-value‚Äô pairs
separated by ‚Äò_‚Äô.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> ‚Äì filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> ‚Äì <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SingleM.i">
<span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.i" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> ‚Äì <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#id7"><span class="problematic" id="id8">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SingleM.linear_regression">
<span class="sig-name descname"><span class="pre">linear_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SingleM.linear_regression" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

<section id="raw">
<h4><a class="toc-backref" href="#id57" role="doc-backlink">RAW</a><a class="headerlink" href="#raw" title="Permalink to this headline">ÔÉÅ</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="ana.RAW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RAW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.SingleM" title="ana.single.SingleM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.single.SingleM</span></code></a></p>
<dl class="simple">
<dt>RAW Measurement:</dt><dd><p>Measurements with time signal only.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id40">
<div class="code-block-caption"><span class="caption-number">Listing 5 </span><span class="caption-text">Example</span><a class="headerlink" href="#id40" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>
<span class="linenos">2</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">3</span>     <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>
<span class="linenos">4</span>     <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s1">&#39;Add Info&#39;</span><span class="p">:</span> <span class="s1">&#39;Important Informations&#39;</span><span class="p">}</span>
<span class="linenos">5</span>     <span class="p">}</span>
<span class="linenos">6</span><span class="n">raw</span> <span class="o">=</span> <span class="n">ana</span><span class="o">.</span><span class="n">RAW</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> ‚Äì Different possibilities.</p></li>
<li><p><strong>rate</strong> (<em>float</em><em>, </em><em>default: 2e-4</em>) ‚Äì At which rate was the timesignal measured (samplingrate) [Hz]</p></li>
<li><p><strong>nof_first_spectra</strong> (<em>int</em><em>, </em><em>default: 64</em>) ‚Äì Cut timesignal into # pieces and average.</p></li>
<li><p><strong>first_spectra_highest_frequency</strong> (<em>float</em><em>, </em><em>default: rate/8</em>) ‚Äì Cut higher frequencies in final spectrum than this.</p></li>
<li><p><strong>downsample</strong> ‚Äì Downsample the timesignal before calculation.</p></li>
<li><p><strong>calc_first</strong> (<em>bool</em><em>, </em><em>default: False</em>) ‚Äì Triggers calculation of first spectrum.</p></li>
<li><p><strong>highest_octave</strong> (<em>int</em><em>, </em><em>default: 64</em>) ‚Äì The highest octave starting point [Hz] of the second spectrum.</p></li>
<li><p><strong>minimum_points_in_octave</strong> (<em>int</em><em>, </em><em>default: 10</em>) ‚Äì If octave would contain less points, stop.</p></li>
<li><p><strong>calc_second</strong> (<em>bool</em><em>, </em><em>default: False</em>) ‚Äì Triggers calculation of second spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Info<span class="colon">:</span></dt>
<dd class="field-even"><p>First Spectrum parameters</p>
</dd>
<dt class="field-odd">Info<span class="colon">:</span></dt>
<dd class="field-odd"><p>Second Spectrum parameters</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.calc_first_spectrum">
<span class="sig-name descname"><span class="pre">calc_first_spectrum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.calc_first_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.calc_first_spectrum" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Sets the variable <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> to a
<code class="xref py py-class docutils literal notranslate"><span class="pre">spectrumanalyzer.SpectrumAnalyzer</span></code> object.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Calculates the first spectrum.</p>
</aside>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NameError</strong> ‚Äì spectrumanalyzer is not installed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.calc_log">
<span class="sig-name descname"><span class="pre">calc_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f',</span> <span class="pre">'Vx',</span> <span class="pre">'Vy']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.calc_log" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.calc_second_spectrum">
<span class="sig-name descname"><span class="pre">calc_second_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.calc_second_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.calc_second_spectrum" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Calculating the second spectrum.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.calc_time_signal_second_spectrum">
<span class="sig-name descname"><span class="pre">calc_time_signal_second_spectrum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.calc_time_signal_second_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.calc_time_signal_second_spectrum" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.check_timesignal">
<span class="sig-name descname"><span class="pre">check_timesignal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timesignal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.check_timesignal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.check_timesignal" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>converts pd.DataFrame[‚ÄòVx‚Äô] and Series into numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timesignal</strong> ‚Äì input timesignal</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted timesignal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.fit_variable">
<span class="sig-name descname"><span class="pre">fit_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.fit_variable" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) ‚Äì Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.get_info_from_name">
<span class="sig-name descname"><span class="pre">get_info_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.get_info_from_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‚Äòkey-value‚Äô pairs
separated by ‚Äò_‚Äô.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> ‚Äì filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> ‚Äì <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.i">
<span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.i" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> ‚Äì <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#id11"><span class="problematic" id="id12">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.linear_regression">
<span class="sig-name descname"><span class="pre">linear_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.RAW.linear_regression" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.plot_spectrum">
<span class="sig-name descname"><span class="pre">plot_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.plot_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.plot_spectrum" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.plot_time">
<span class="sig-name descname"><span class="pre">plot_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.plot_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.plot_time" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.read" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Reading data from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) ‚Äì </p></li>
<li><p><strong>from.</strong> (<em>Filename base to read data</em>) ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.subtract_mean">
<span class="sig-name descname"><span class="pre">subtract_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.subtract_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.subtract_mean" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Subtracts mean value from timesignal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) ‚Äì Change variable inside this object?</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>normalized timesignal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.RAW.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/raw.html#RAW.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.RAW.write" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Writing data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) ‚Äì </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="sa">
<h4><a class="toc-backref" href="#id58" role="doc-backlink">SA</a><a class="headerlink" href="#sa" title="Permalink to this headline">ÔÉÅ</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="ana.SA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/signalanalyzer.html#SA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.SA" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.SingleM" title="ana.single.SingleM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.single.SingleM</span></code></a></p>
<p>Loads and analyzes datafiles from <a href="#id13"><span class="problematic" id="id14">:instrument:`SR785`</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>* ValueError</strong> ‚Äì </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.calc_log">
<span class="sig-name descname"><span class="pre">calc_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f',</span> <span class="pre">'Vx',</span> <span class="pre">'Vy']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.calc_log" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/signalanalyzer.html#SA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.SA.fit" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Fits a linear regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>tuple</strong> (<em>fit_range</em>) ‚Äì (1e-2, 1e0).):</p></li>
<li><p><strong>optional</strong> ‚Äì (1e-2, 1e0).):</p></li>
<li><p><strong>default</strong> ‚Äì (1e-2, 1e0).):</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.fit_variable">
<span class="sig-name descname"><span class="pre">fit_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.fit_variable" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) ‚Äì Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.get_info_from_name">
<span class="sig-name descname"><span class="pre">get_info_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.get_info_from_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‚Äòkey-value‚Äô pairs
separated by ‚Äò_‚Äô.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> ‚Äì filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> ‚Äì <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.i">
<span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.i" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> ‚Äì <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#id17"><span class="problematic" id="id18">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.linear_regression">
<span class="sig-name descname"><span class="pre">linear_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.SA.linear_regression" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.SA.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/signalanalyzer.html#SA.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.SA.plot" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting the Data on given Axis or creating a new Plot for plotting.</p>
<div class="literal-block-wrapper docutils container" id="id41">
<div class="code-block-caption"><span class="caption-number">Listing 6 </span><span class="caption-text">Signature</span><a class="headerlink" href="#id41" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">2</span>    <span class="n">plot_x</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">plot_y</span><span class="o">=</span><span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">3</span>
<span class="linenos">4</span>        <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">5</span>        <span class="kc">None</span><span class="p">),</span> <span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">6</span>        <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;f [Hz]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;S_VH [V2/Hz]&#39;</span><span class="p">,</span>
<span class="linenos">7</span>
<span class="linenos">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> ‚Äì </p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <strong>dont_set_plot_settings</strong> is True, all kwargs below are not
used.</p>
</aside>
</dd></dl>

</dd></dl>

</section>
<section id="hloop">
<h4><a class="toc-backref" href="#id59" role="doc-backlink">Hloop</a><a class="headerlink" href="#hloop" title="Permalink to this headline">ÔÉÅ</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="ana.Hloop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Hloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurement_number</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.SingleM" title="ana.single.SingleM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.single.SingleM</span></code></a></p>
<p>This class represents the measurement of a hysteresis loop. It evaluates
and plots the data.</p>
<p>It collects all files that match the following regex:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/Hloop/[mM]</span><span class="si">%s</span><span class="s2">_*.dat&quot;</span> <span class="o">%</span> <span class="n">measurement_number</span><span class="p">)</span>
</pre></div>
</div>
<p>The files should contain a file that contains the word ‚Äúup‚Äù or ‚Äúdown‚Äù
indicating the direction of the field sweep.</p>
<p>If one file contains the word ‚ÄòGradio‚Äô it expects a gradiometry
measurement. If the filename contains the word ‚ÄòParallel‚Äô it expects a
parallel measurement. If the filename contains neither of these words the
variables need to be set manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>measurement_number</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.calc_B">
<span class="sig-name descname"><span class="pre">calc_B</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.calc_B"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.calc_B" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>V</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.calc_log">
<span class="sig-name descname"><span class="pre">calc_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f',</span> <span class="pre">'Vx',</span> <span class="pre">'Vy']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.calc_log" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.calculate_fitted_strayfield">
<span class="sig-name descname"><span class="pre">calculate_fitted_strayfield</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.calculate_fitted_strayfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.calculate_fitted_strayfield" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Calculates the strayfield of the fitted signal and stores it in up
and down sweeps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.calculate_strayfield">
<span class="sig-name descname"><span class="pre">calculate_strayfield</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.calculate_strayfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.calculate_strayfield" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Calculates the strayfield of the signal and stores it in up and down
sweeps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cond=Series([]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">float64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.fit" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Fitting the Voltage Signal.</p>
<p>For Parallel measurement:</p>
<blockquote>
<div><p>the empty cross Vx13 is subtracted from the signal Vx8/Vx9</p>
</div></blockquote>
<p>For gradiometry:</p>
<blockquote>
<div><p>A condition can be added to determine the amount of
datapoints to fit (default: B &lt; B_min + 150mT).</p>
</div></blockquote>
<div class="literal-block-wrapper docutils container" id="id42">
<div class="code-block-caption"><span class="caption-number">Listing 7 </span><span class="caption-text">Example</span><a class="headerlink" href="#id42" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>
 <span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cond</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.fit_variable">
<span class="sig-name descname"><span class="pre">fit_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.fit_variable" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Applys a linear regression and adds result to DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) ‚Äì Fit data</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) ‚Äì Fit variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_bhminmax">
<span class="sig-name descname"><span class="pre">get_bhminmax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_bhminmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_bhminmax" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the minimum and maximum of the measured hall voltage
converted to strayfield.</p>
<div class="literal-block-wrapper docutils container" id="id43">
<div class="code-block-caption"><span class="caption-number">Listing 8 </span><span class="caption-text">Example</span><a class="headerlink" href="#id43" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bhmin</span><span class="p">,</span> <span class="n">bhmax</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_coercive_field">
<span class="sig-name descname"><span class="pre">get_coercive_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_coercive_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_coercive_field" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the mean and coercive fields calculated.</p>
<div class="literal-block-wrapper docutils container" id="id44">
<div class="code-block-caption"><span class="caption-number">Listing 9 </span><span class="caption-text">Example</span><a class="headerlink" href="#id44" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">,</span> <span class="n">coer1</span><span class="p">,</span> <span class="n">coer2</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_coercive_field</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coercive Field (up sweep): (</span><span class="si">%.3f</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coer1</span><span class="p">,</span> <span class="n">mean</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coercive Field (down sweep): (</span><span class="si">%.3f</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coer2</span><span class="p">,</span> <span class="n">mean</span><span class="p">))</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_default_title">
<span class="sig-name descname"><span class="pre">get_default_title</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_default_title"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_default_title" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_downminusup">
<span class="sig-name descname"><span class="pre">get_downminusup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_downminusup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_downminusup" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the magnetic field and difference between down and up sweep.</p>
<div class="literal-block-wrapper docutils container" id="id45">
<div class="code-block-caption"><span class="caption-number">Listing 10 </span><span class="caption-text">Example</span><a class="headerlink" href="#id45" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">B</span><span class="p">,</span> <span class="n">Vx</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">Vx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_downminusup_strayfield">
<span class="sig-name descname"><span class="pre">get_downminusup_strayfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitted_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_downminusup_strayfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_downminusup_strayfield" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the magnetic field and difference between down and up sweep.</p>
<div class="literal-block-wrapper docutils container" id="id46">
<div class="code-block-caption"><span class="caption-number">Listing 11 </span><span class="caption-text">Example</span><a class="headerlink" href="#id46" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B_ext</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">Bx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> ‚Äì </p></li>
<li><p><strong>fitted_data</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_info_from_name">
<span class="sig-name descname"><span class="pre">get_info_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.get_info_from_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‚Äòkey-value‚Äô pairs
separated by ‚Äò_‚Äô.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> ‚Äì filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> ‚Äì <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_minmax">
<span class="sig-name descname"><span class="pre">get_minmax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_minmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_minmax" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the minimum and maximum of the field and voltage.</p>
<div class="literal-block-wrapper docutils container" id="id47">
<div class="code-block-caption"><span class="caption-number">Listing 12 </span><span class="caption-text">Example</span><a class="headerlink" href="#id47" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.get_remanence">
<span class="sig-name descname"><span class="pre">get_remanence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.get_remanence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.get_remanence" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the remanent voltage calculated.</p>
<div class="literal-block-wrapper docutils container" id="id48">
<div class="code-block-caption"><span class="caption-number">Listing 13 </span><span class="caption-text">Example</span><a class="headerlink" href="#id48" title="Permalink to this code">ÔÉÅ</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rem1</span><span class="p">,</span> <span class="n">rem2</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_remanence</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remanent Voltage (up sweep): (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rem1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remanent Voltage (down sweep): (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rem2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.i">
<span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.i" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> ‚Äì <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#id21"><span class="problematic" id="id22">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.linear_regression">
<span class="sig-name descname"><span class="pre">linear_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.Hloop.linear_regression" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.plot_downminusup">
<span class="sig-name descname"><span class="pre">plot_downminusup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_downminusup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.plot_downminusup" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting the difference between the down and up sweep. ax: Matplotlib
Axis to plot on. figtitle: can be set to a manual figure title.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> ‚Äì </p></li>
<li><p><strong>figtitle</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.plot_hloop">
<span class="sig-name descname"><span class="pre">plot_hloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fitted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_rem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_coer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_hloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.plot_hloop" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plotting the hysteresis loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> ‚Äì Matplotlib Axis to plot on.</p></li>
<li><p><strong>figtitle</strong> ‚Äì can be set to a manual figure title.</p></li>
<li><p><strong>show_fitted</strong> ‚Äì plot the fitted curve.</p></li>
<li><p><strong>show_rem</strong> ‚Äì show the remanent voltage.</p></li>
<li><p><strong>show_coer</strong> ‚Äì show the coercive field.</p></li>
<li><p><strong>show_original</strong> ‚Äì plots the RAW data.</p></li>
<li><p><strong>show_linear_fit</strong> ‚Äì plots the linear fitting line used for the fit</p></li>
</ul>
</dd>
</dl>
<p>(only gradiometry).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.plot_hysteresis">
<span class="sig-name descname"><span class="pre">plot_hysteresis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_hysteresis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.plot_hysteresis" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.plot_strayfield">
<span class="sig-name descname"><span class="pre">plot_strayfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.plot_strayfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.plot_strayfield" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots the strayfield of the data. Strayfield is calculated using the
electron concentration at 0 degree measured before
(hardcoded in __init__).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.axis</em>) ‚Äì where should we plot.</p></li>
<li><p><strong>figtitle</strong> (<em>str</em><em>, </em><em>optional</em>) ‚Äì Choose your own title above the figure.</p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.remove_zero">
<span class="sig-name descname"><span class="pre">remove_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.remove_zero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.remove_zero" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Removes the values 0.0 from up and down sweep where the lock-in
didn‚Äôt return any values (read error will be saved as 0.0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>columns</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.Hloop.set_factor">
<span class="sig-name descname"><span class="pre">set_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/hloop.html#Hloop.set_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.Hloop.set_factor" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Multiplying the Voltage by a Factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>factor</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="multiplem">
<h3><a class="toc-backref" href="#id60" role="doc-backlink">MultipleM</a><a class="headerlink" href="#multiplem" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.MultipleM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultipleM</span></span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MultipleM" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ana.measurement.MeasurementClass" title="ana.measurement.MeasurementClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">ana.measurement.MeasurementClass</span></code></a></p>
<p>MultipleM:</p>
<p>Main parent class for all multiple measurements. These Measurements
are represent by one data variable.</p>
<p>All multiple measurements have a variable called <code class="docutils literal notranslate"><span class="pre">multi_info</span></code> which
contains a pandas.DataFrame with parameter settings to single
measurements.</p>
<p>All multiple measurements can be represented by</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">ana</span><span class="o">.</span><span class="n">MultipleM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">Nr. 0: Hloop</span>
<span class="go">Nr. 0: RAW</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.calc_log">
<span class="sig-name descname"><span class="pre">calc_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['f',</span> <span class="pre">'Vx',</span> <span class="pre">'Vy']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.calc_log" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.get_info_from_name">
<span class="sig-name descname"><span class="pre">get_info_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.get_info_from_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Extracting information from filenames.
Using a default regex first or trying to extract ‚Äòkey-value‚Äô pairs
separated by ‚Äò_‚Äô.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> ‚Äì filename that contains informations.</p></li>
<li><p><strong>kwargs</strong> ‚Äì <dl class="field-list simple">
<dt class="field-odd">str regex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regular expression for the filename</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict(key=value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.get_lofm">
<span class="sig-name descname"><span class="pre">get_lofm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM.get_lofm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MultipleM.get_lofm" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="simple">
<dt>Returns the List of Measurements (lofm) for plot functions</dt><dd><p>(see <a class="reference internal" href="#ana.HandleM.plot" title="ana.HandleM.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ana.HandleM.plot()</span></code></a>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>dict</em>) ‚Äì Measurement Numbers pointing to label format
variables: e.g. <code class="docutils literal notranslate"><span class="pre">{nr:</span> <span class="pre">[(-1,</span> <span class="pre">1),</span> <span class="pre">'Plusses',</span> <span class="pre">'5</span> <span class="pre">mT/min']}</span></code></p></li>
<li><p><strong>label</strong> (<em>str</em>) ‚Äì Label to show in plots: e.g.
<code class="docutils literal notranslate"><span class="pre">&quot;Show</span> <span class="pre">%s</span> <span class="pre">-&gt;</span> <span class="pre">%s</span> <span class="pre">(%s)</span> <span class="pre">%s</span> <span class="pre">&quot;</span></code> -&gt; will be string formated using
to_show</p></li>
<li><p><strong>(</strong><strong>dict</strong> (<em>options</em>) ‚Äì empty): Additional plotting
parameters</p></li>
<li><p><strong>optional</strong> ‚Äì empty): Additional plotting
parameters</p></li>
<li><p><strong>default</strong> ‚Äì empty): Additional plotting
parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of Measurements with description: <code class="docutils literal notranslate"><span class="pre">{nr:</span> <span class="pre">[labels]}</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.get_lofm_sweeps">
<span class="sig-name descname"><span class="pre">get_lofm_sweeps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_show</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM.get_lofm_sweeps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MultipleM.get_lofm_sweeps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Workaround to get list of measurements for sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>to_show</strong> (<em>dict</em>) ‚Äì Measurement Numbers pointing to label format
variables: e.g. `` {nr: [-1, 1, ‚ÄòPlusses‚Äô, ‚Äò2 mT/min‚Äô]}</p></li>
<li><p><strong>label</strong> (<em>str</em>) ‚Äì Label to show in plots: e.g. ‚ÄúShow %s -&gt; %s (%s) %s ‚Äù
-&gt; will be formated using to_show</p></li>
<li><p><strong>(</strong><strong>dict</strong> (<em>options</em>) ‚Äì empty): Additional plotting options</p></li>
<li><p><strong>default</strong> ‚Äì empty): Additional plotting options</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of Measurements with description</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.i">
<span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.i" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Get  a specific measurement number information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*key</strong> ‚Äì <p>Will be passed to info.get</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>info.get(<a href="#id25"><span class="problematic" id="id26">*</span></a>key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.MultipleM.query" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.MultipleM.read_csv">
<span class="sig-name descname"><span class="pre">read_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/multiple.html#MultipleM.read_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.MultipleM.read_csv" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Updates multi_info DataFrame. Reads csv and adds information to
self.multi_info</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="plottingclass">
<h3><a class="toc-backref" href="#id61" role="doc-backlink">PlottingClass</a><a class="headerlink" href="#plottingclass" title="Permalink to this headline">ÔÉÅ</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PlottingClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">style</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the basic plotting style.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**style</strong> ‚Äì </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.draw_oneoverf">
<span class="sig-name descname"><span class="pre">draw_oneoverf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.draw_oneoverf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass.draw_oneoverf" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> ‚Äì </p></li>
<li><p><strong>**kwargs</strong> ‚Äì </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ana.plotting.PlottingClass.get" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.get_style">
<span class="sig-name descname"><span class="pre">get_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.get_style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass.get_style" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>custom</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.save_plot">
<span class="sig-name descname"><span class="pre">save_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.save_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass.save_plot" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Saves the current plot as file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) ‚Äì Filename</p></li>
<li><p><strong>fext</strong> (<em>str</em>) ‚Äì Extension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.set_plot_settings">
<span class="sig-name descname"><span class="pre">set_plot_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.set_plot_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass.set_plot_settings" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.set_style">
<span class="sig-name descname"><span class="pre">set_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">style</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.set_style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass.set_style" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Sets the Style for plots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>dict</em><em>, </em><em>None</em><em>, or </em><em>one of {paper</em><em>, </em><em>notebook</em><em>, </em><em>talk</em><em>, </em><em>poster}</em>) ‚Äì A dictionary of parameters or the name of a preconfigured set.</p></li>
<li><p><strong>style</strong> (<em>dict</em><em>, </em><em>None</em><em>, or </em><em>one of {darkgrid</em><em>, </em><em>whitegrid</em><em>, </em><em>dark</em><em>, </em><em>white</em><em>, </em><em>ticks}</em>) ‚Äì </p></li>
<li><p><strong>default</strong> (<em>bool</em>) ‚Äì if True it sets default
<code class="code docutils literal notranslate"><span class="pre">size=talk</span></code> and
<code class="code docutils literal notranslate"><span class="pre">style=whitegrid</span></code></p></li>
<li><p><strong>notebook</strong> (<em>bool</em>) ‚Äì if True it sets default
<code class="code docutils literal notranslate"><span class="pre">size=notebook</span></code> and
<code class="code docutils literal notranslate"><span class="pre">style=ticks</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ana.plotting.PlottingClass.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/plotting.html#PlottingClass.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.plotting.PlottingClass.update" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-ana.functions">
<span id="functions"></span><h3><a class="toc-backref" href="#id62" role="doc-backlink">Functions</a><a class="headerlink" href="#module-ana.functions" title="Permalink to this headline">ÔÉÅ</a></h3>
<p>Helps to handle measurements and style plots.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ana.functions.getpath">
<span class="sig-name descname"><span class="pre">getpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/functions.html#getpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.functions.getpath" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">glob</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*arg</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ana.functions.timing">
<span class="sig-name descname"><span class="pre">timing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/ana/functions.html#timing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ana.functions.timing" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Wraps a function to measure the time it takes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> ‚Äì </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="source-code">
<h2><a class="toc-backref" href="#id63" role="doc-backlink">Source Code</a><a class="headerlink" href="#source-code" title="Permalink to this headline">ÔÉÅ</a></h2>
<section id="id27">
<h3><a class="toc-backref" href="#id64" role="doc-backlink">Plot</a><a class="headerlink" href="#id27" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">   1</span><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="linenos">   2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">   3</span>        <span class="sd">&quot;&quot;&quot;A small class used to plot figures for a presentation.&quot;&quot;&quot;</span>
<span class="linenos">   4</span>
<span class="linenos">   5</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos">   6</span>
<span class="linenos">   7</span>        <span class="bp">self</span><span class="o">.</span><span class="n">meas</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">   8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="mi">57</span><span class="p">)</span>
<span class="linenos">   9</span>        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span> <span class="o">=</span> <span class="n">HandleM</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data/SR785&#39;</span><span class="p">)</span>
<span class="linenos">  10</span>
<span class="linenos">  11</span>    <span class="k">def</span> <span class="nf">get_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  12</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="linenos">  13</span>                               <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="linenos">  14</span>                               <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)),</span>
<span class="linenos">  15</span>                               <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span><span class="nb">dict</span><span class="p">())</span>
<span class="linenos">  16</span>                               <span class="p">)</span>
<span class="linenos">  17</span>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
<span class="linenos">  18</span>
<span class="linenos">  19</span>    <span class="k">def</span> <span class="nf">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  20</span>        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">  21</span>            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
<span class="linenos">  22</span>
<span class="linenos">  23</span>        <span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;talk&#39;</span><span class="p">),</span>
<span class="linenos">  24</span>                          <span class="n">style</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;ticks&#39;</span><span class="p">),</span>
<span class="linenos">  25</span>                          <span class="n">palette</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;palette&#39;</span><span class="p">,</span> <span class="s1">&#39;deep&#39;</span><span class="p">),</span>
<span class="linenos">  26</span>                          <span class="n">grid</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
<span class="linenos">  27</span>                          <span class="n">latex</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
<span class="linenos">  28</span>                          <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos">  29</span>                          <span class="p">)</span>
<span class="linenos">  30</span>
<span class="linenos">  31</span>    <span class="k">def</span> <span class="nf">plot_single_hloop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">54</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-single-1&#39;</span><span class="p">,</span>
<span class="linenos">  32</span>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  33</span>        <span class="sd">&quot;&quot;&quot;Plots a single measurement. Default: 0deg</span>
<span class="linenos">  34</span>
<span class="linenos">  35</span><span class="sd">        Args:</span>
<span class="linenos">  36</span><span class="sd">            nr:</span>
<span class="linenos">  37</span><span class="sd">            filename (str, optional): File to write. The default is</span>
<span class="linenos">  38</span><span class="sd">                &#39;hloop-single-1&#39;.</span>
<span class="linenos">  39</span><span class="sd">            xlim / ylim: limit the plots axes.</span>
<span class="linenos">  40</span>
<span class="linenos">  41</span><span class="sd">        Returns:</span>
<span class="linenos">  42</span><span class="sd">            {filename}.pdf</span>
<span class="linenos">  43</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">  44</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">  45</span>
<span class="linenos">  46</span>        <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
<span class="linenos">  47</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos">  48</span>
<span class="linenos">  49</span>        <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
<span class="linenos">  50</span>        <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos">  51</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
<span class="linenos">  52</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">):</span>
<span class="linenos">  53</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">))</span>
<span class="linenos">  54</span>
<span class="linenos">  55</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">  56</span>            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="linenos">  57</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">  58</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.64</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
<span class="linenos">  59</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">  60</span>            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">  61</span>            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos">  62</span>            <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos">  63</span>            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos">  64</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos">  65</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos">  66</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
<span class="linenos">  67</span>
<span class="linenos">  68</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos">  69</span>
<span class="linenos">  70</span>    <span class="k">def</span> <span class="nf">plot_hloops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-1&#39;</span><span class="p">,</span>
<span class="linenos">  71</span>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  72</span>        <span class="sd">&quot;&quot;&quot;Compares Plusses and Crosses between two angles (4 Subplots).</span>
<span class="linenos">  73</span><span class="sd">        Default: 0 and 45 Writes file hloop-compare-1.pdf</span>
<span class="linenos">  74</span>
<span class="linenos">  75</span><span class="sd">        Args:</span>
<span class="linenos">  76</span><span class="sd">            to_show (list, optional): List of 4 measurement numbers, </span>
<span class="linenos">  77</span><span class="sd">                defaults to [54, 55]</span>
<span class="linenos">  78</span><span class="sd">            filename (str, optional): DESCRIPTION, defaults to &#39;hloop-compare-1&#39;</span>
<span class="linenos">  79</span><span class="sd">            **kwargs:</span>
<span class="linenos">  80</span>
<span class="linenos">  81</span><span class="sd">        Returns:</span>
<span class="linenos">  82</span><span class="sd">            None</span>
<span class="linenos">  83</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">  84</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">  85</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos">  86</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">  87</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">  88</span>                                  <span class="n">plot_args</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span><span class="nb">dict</span><span class="p">()))</span>
<span class="linenos">  89</span>
<span class="linenos">  90</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos">  91</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
<span class="linenos">  92</span>            <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
<span class="linenos">  93</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos">  94</span>
<span class="linenos">  95</span>            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
<span class="linenos">  96</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos">  97</span>            <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span>
<span class="linenos">  98</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="linenos">  99</span>            <span class="k">elif</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
<span class="linenos"> 100</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="linenos"> 101</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">4.45</span><span class="p">)</span>
<span class="linenos"> 102</span>            <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]:</span>
<span class="linenos"> 103</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="linenos"> 104</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="linenos"> 105</span>            <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 106</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 107</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 108</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="linenos"> 109</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 110</span>
<span class="linenos"> 111</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos"> 112</span>                <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="linenos"> 113</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos"> 114</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
<span class="linenos"> 115</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 116</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 117</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 118</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos"> 119</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="linenos"> 120</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos"> 121</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 122</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="linenos"> 123</span>                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
<span class="linenos"> 124</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="linenos"> 125</span>                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]:</span>
<span class="linenos"> 126</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="linenos"> 127</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 128</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 129</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff_yticks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="linenos"> 130</span>
<span class="linenos"> 131</span>        <span class="n">title_style</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bfseries </span><span class="se">\\</span><span class="s1">Huge &#39;</span>
<span class="linenos"> 132</span>        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 133</span>                              <span class="p">[</span><span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">]):</span>
<span class="linenos"> 134</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_style</span> <span class="o">+</span> <span class="n">struct</span><span class="p">)</span>
<span class="linenos"> 135</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 136</span>
<span class="linenos"> 137</span>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]:</span>
<span class="linenos"> 138</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 139</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<span class="linenos"> 140</span>
<span class="linenos"> 141</span>        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 142</span>         <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = +45^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">,</span>
<span class="linenos"> 143</span>          <span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = -45^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">]):</span>
<span class="linenos"> 144</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>
<span class="linenos"> 145</span>
<span class="linenos"> 146</span>        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.8</span><span class="p">)</span>
<span class="linenos"> 147</span>        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.8</span><span class="p">)</span>
<span class="linenos"> 148</span>        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="mf">3.45</span><span class="p">)</span>
<span class="linenos"> 149</span>        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="mf">3.45</span><span class="p">)</span>
<span class="linenos"> 150</span>
<span class="linenos"> 151</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 152</span>
<span class="linenos"> 153</span>    <span class="k">def</span> <span class="nf">plot_hloops_95</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="linenos"> 154</span>                       <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
<span class="linenos"> 155</span>                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-95&#39;</span><span class="p">,</span>
<span class="linenos"> 156</span>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 157</span>        <span class="sd">&quot;&quot;&quot;Compares +95/100/105/110deg with -85/80/75/70deg for (180deg</span>
<span class="linenos"> 158</span><span class="sd">        Comparison)</span>
<span class="linenos"> 159</span>
<span class="linenos"> 160</span><span class="sd">        :param filename:Filename to save. The default is &#39;hloop-compare-95&#39;.</span>
<span class="linenos"> 161</span><span class="sd">        :type filename: str, optional</span>
<span class="linenos"> 162</span>
<span class="linenos"> 163</span><span class="sd">        Args:</span>
<span class="linenos"> 164</span><span class="sd">            to_show (list, optional): Measurement numbers to plot. The default</span>
<span class="linenos"> 165</span><span class="sd">                is a[95]+a[-85].</span>
<span class="linenos"> 166</span><span class="sd">            filename:</span>
<span class="linenos"> 167</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 168</span>
<span class="linenos"> 169</span><span class="sd">        Returns:</span>
<span class="linenos"> 170</span><span class="sd">            {filename}.pdf</span>
<span class="linenos"> 171</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 172</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos"> 173</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 174</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
<span class="linenos"> 175</span>            <span class="k">if</span> <span class="n">nr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">:</span>
<span class="linenos"> 176</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos"> 177</span>            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
<span class="linenos"> 178</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos"> 179</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 180</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 181</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 182</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 183</span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Crosses&#39;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 184</span>                    <span class="s1">&#39;crosses_xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 185</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crosses_xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 186</span>
<span class="linenos"> 187</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos"> 188</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 189</span>                                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 190</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos"> 191</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span>
<span class="linenos"> 192</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 193</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 194</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 195</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos"> 196</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 197</span>                <span class="c1"># inset.set_ylabel(&quot;$\Delta B_z\\;[\\mathrm{mT}]$&quot;)</span>
<span class="linenos"> 198</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 199</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 200</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 201</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 202</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 203</span>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Crosses&#39;</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 204</span>                        <span class="s1">&#39;crosses_xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 205</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crosses_xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 206</span>
<span class="linenos"> 207</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 208</span>
<span class="linenos"> 209</span>    <span class="k">def</span> <span class="nf">plot_hloops_90</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="linenos"> 210</span>                       <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">155</span><span class="p">],</span>
<span class="linenos"> 211</span>                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-90&#39;</span><span class="p">,</span>
<span class="linenos"> 212</span>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 213</span>        <span class="sd">&quot;&quot;&quot;Compares +90deg with -90deg for (180deg Comparison)</span>
<span class="linenos"> 214</span>
<span class="linenos"> 215</span><span class="sd">        Args:</span>
<span class="linenos"> 216</span><span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [57,155].</span>
<span class="linenos"> 217</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="linenos"> 218</span><span class="sd">                &#39;hloop-compare-90&#39;.</span>
<span class="linenos"> 219</span><span class="sd">            **kwargs (TYPE): mirror: bool, optional</span>
<span class="linenos"> 220</span><span class="sd">                    should we mirror the hloop? The default is False</span>
<span class="linenos"> 221</span>
<span class="linenos"> 222</span><span class="sd">        Returns:</span>
<span class="linenos"> 223</span><span class="sd">            None.:</span>
<span class="linenos"> 224</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 225</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 226</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 227</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 228</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">))</span>
<span class="linenos"> 229</span>
<span class="linenos"> 230</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
<span class="linenos"> 231</span>                                 <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_args&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
<span class="linenos"> 232</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 233</span>            <span class="n">cur_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 234</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 235</span>                                   <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 236</span>                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 237</span>
<span class="linenos"> 238</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos"> 239</span>            <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_style</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">])</span>
<span class="linenos"> 240</span>
<span class="linenos"> 241</span>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
<span class="linenos"> 242</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 243</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 244</span>
<span class="linenos"> 245</span>            <span class="c1"># Plusses</span>
<span class="linenos"> 246</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 247</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 248</span>                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 249</span>                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 250</span>
<span class="linenos"> 251</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
<span class="linenos"> 252</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos"> 253</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
<span class="linenos"> 254</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos"> 255</span>
<span class="linenos"> 256</span>            <span class="c1"># Set Limits (x and y Axis)</span>
<span class="linenos"> 257</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 258</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 259</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 260</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 261</span>
<span class="linenos"> 262</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos"> 263</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
<span class="linenos"> 264</span>                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos"> 265</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
<span class="linenos"> 266</span>
<span class="linenos"> 267</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 268</span>            <span class="sd">&quot;&quot;&quot;if nr == 57:</span>
<span class="linenos"> 269</span><span class="sd">                ax.set_title(&#39;m57: Plusses ($90^\circ$)&#39;)</span>
<span class="linenos"> 270</span><span class="sd">            else:</span>
<span class="linenos"> 271</span><span class="sd">                ax.set_title(&#39;m155: Plusses ($-90^\circ$)&#39;)&quot;&quot;&quot;</span>
<span class="linenos"> 272</span>
<span class="linenos"> 273</span>            <span class="c1"># Inset with Difference</span>
<span class="linenos"> 274</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 275</span>                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">)):</span>
<span class="linenos"> 276</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 277</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 278</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 279</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 280</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 281</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 282</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 283</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">(</span>
<span class="linenos"> 284</span>                    <span class="n">fitted_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 285</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos"> 286</span>                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 287</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="linenos"> 288</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 289</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference (fitted)&quot;</span><span class="p">)</span>
<span class="linenos"> 290</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff_yticks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
<span class="linenos"> 291</span>
<span class="linenos"> 292</span>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>
<span class="linenos"> 293</span>
<span class="linenos"> 294</span>            <span class="c1"># Crosses</span>
<span class="linenos"> 295</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 296</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 297</span>                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 298</span>                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 299</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 300</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos"> 301</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 302</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos"> 303</span>
<span class="linenos"> 304</span>            <span class="c1"># Set Limits (x and y Axis)</span>
<span class="linenos"> 305</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 306</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 307</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 308</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 309</span>
<span class="linenos"> 310</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos"> 311</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
<span class="linenos"> 312</span>                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos"> 313</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
<span class="linenos"> 314</span>
<span class="linenos"> 315</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 316</span>            <span class="sd">&quot;&quot;&quot;if nr == 57:</span>
<span class="linenos"> 317</span><span class="sd">                ax.set_title(&#39;M57: Crosses ($90^\circ$)&#39;)</span>
<span class="linenos"> 318</span><span class="sd">            else:</span>
<span class="linenos"> 319</span><span class="sd">                ax.set_title(&#39;M155: Crosses ($-90^\circ$)&#39;)&quot;&quot;&quot;</span>
<span class="linenos"> 320</span>
<span class="linenos"> 321</span>            <span class="c1"># Inset with Difference</span>
<span class="linenos"> 322</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 323</span>                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">):</span>
<span class="linenos"> 324</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 325</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 326</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 327</span>                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 328</span>                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 329</span>                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 330</span>                <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 331</span>                                                  <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 332</span>                <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
<span class="linenos"> 333</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 334</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 335</span>                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos"> 336</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="linenos"> 337</span>                <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="linenos"> 338</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
<span class="linenos"> 339</span>                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 340</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="linenos"> 341</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 342</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference (fitted)&quot;</span><span class="p">)</span>
<span class="linenos"> 343</span>                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
<span class="linenos"> 344</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="linenos"> 345</span>                    <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="linenos"> 346</span>
<span class="linenos"> 347</span>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>
<span class="linenos"> 348</span>
<span class="linenos"> 349</span>        <span class="n">title_style</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bfseries </span><span class="se">\\</span><span class="s1">Huge &#39;</span>
<span class="linenos"> 350</span>        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 351</span>                                  <span class="p">[</span><span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
<span class="linenos"> 352</span>                                   <span class="s1">&#39;Crosses&#39;</span><span class="p">]):</span>
<span class="linenos"> 353</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_style</span> <span class="o">+</span> <span class="n">struct</span><span class="p">)</span>
<span class="linenos"> 354</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 355</span>
<span class="linenos"> 356</span>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]:</span>
<span class="linenos"> 357</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 358</span>
<span class="linenos"> 359</span>        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 360</span>                         <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = +90^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">,</span>
<span class="linenos"> 361</span>                          <span class="sa">r</span><span class="s1">&#39;{</span><span class="si">%s</span><span class="s1"> $\mathbf{\theta = -90^{\circ}}$}&#39;</span> <span class="o">%</span> <span class="n">title_style</span><span class="p">]):</span>
<span class="linenos"> 362</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>
<span class="linenos"> 363</span>
<span class="linenos"> 364</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 365</span>
<span class="linenos"> 366</span>    <span class="k">def</span> <span class="nf">plot_hloops_90_nofit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">155</span><span class="p">],</span>
<span class="linenos"> 367</span>                             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-90&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 368</span>        <span class="sd">&quot;&quot;&quot;Compares +90deg with -90deg for (180deg Comparison) Using not fitted</span>
<span class="linenos"> 369</span><span class="sd">        data</span>
<span class="linenos"> 370</span>
<span class="linenos"> 371</span><span class="sd">        Args:</span>
<span class="linenos"> 372</span><span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [57,155].</span>
<span class="linenos"> 373</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="linenos"> 374</span><span class="sd">                &#39;hloop-compare-90&#39;.</span>
<span class="linenos"> 375</span><span class="sd">            **kwargs (TYPE): mirror: bool, optional</span>
<span class="linenos"> 376</span><span class="sd">                    should we mirror the hloop? The default is False</span>
<span class="linenos"> 377</span>
<span class="linenos"> 378</span><span class="sd">        Returns:</span>
<span class="linenos"> 379</span><span class="sd">            None.:</span>
<span class="linenos"> 380</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 381</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 382</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 383</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 384</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">))</span>
<span class="linenos"> 385</span>
<span class="linenos"> 386</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos"> 387</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 388</span>            <span class="n">cur_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 389</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 390</span>                                   <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 391</span>                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 392</span>
<span class="linenos"> 393</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos"> 394</span>
<span class="linenos"> 395</span>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
<span class="linenos"> 396</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 397</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 398</span>
<span class="linenos"> 399</span>            <span class="c1"># Plusses</span>
<span class="linenos"> 400</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 401</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 402</span>                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 403</span>                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 404</span>
<span class="linenos"> 405</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
<span class="linenos"> 406</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
<span class="linenos"> 407</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
<span class="linenos"> 408</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (Empty)&#39;</span><span class="p">)</span>
<span class="linenos"> 409</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
<span class="linenos"> 410</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (Empty)&#39;</span><span class="p">)</span>
<span class="linenos"> 411</span>
<span class="linenos"> 412</span>            <span class="c1"># Set Limits (x and y Axis)</span>
<span class="linenos"> 413</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 414</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 415</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 416</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="linenos"> 417</span>
<span class="linenos"> 418</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos"> 419</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
<span class="linenos"> 420</span>                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos"> 421</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
<span class="linenos"> 422</span>
<span class="linenos"> 423</span>            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
<span class="linenos"> 424</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Plusses ($90^\circ$)&#39;</span><span class="p">)</span>
<span class="linenos"> 425</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 426</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M155: Plusses ($-90^\circ$)&#39;</span><span class="p">)</span>
<span class="linenos"> 427</span>
<span class="linenos"> 428</span>            <span class="c1"># Inset with Difference</span>
<span class="linenos"> 429</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 430</span>                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">)):</span>
<span class="linenos"> 431</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 432</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 433</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.59</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 434</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 435</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 436</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 437</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 438</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos"> 439</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos"> 440</span>                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 441</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 442</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="linenos"> 443</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 444</span>
<span class="linenos"> 445</span>            <span class="c1"># Crosses</span>
<span class="linenos"> 446</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">cur_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 447</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 448</span>                                          <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 449</span>                                          <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 450</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
<span class="linenos"> 451</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
<span class="linenos"> 452</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
<span class="linenos"> 453</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (Empty)&#39;</span><span class="p">)</span>
<span class="linenos"> 454</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx13</span><span class="p">,</span>
<span class="linenos"> 455</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (Empty)&#39;</span><span class="p">)</span>
<span class="linenos"> 456</span>
<span class="linenos"> 457</span>            <span class="c1"># Set Limits (x and y Axis)</span>
<span class="linenos"> 458</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">):</span>
<span class="linenos"> 459</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">))</span>
<span class="linenos"> 460</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 461</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="linenos"> 462</span>
<span class="linenos"> 463</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos"> 464</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span>
<span class="linenos"> 465</span>                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos"> 466</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
<span class="linenos"> 467</span>
<span class="linenos"> 468</span>            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
<span class="linenos"> 469</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Crosses ($90^\circ$)&#39;</span><span class="p">)</span>
<span class="linenos"> 470</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 471</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M155: Crosses ($-90^\circ$)&#39;</span><span class="p">)</span>
<span class="linenos"> 472</span>
<span class="linenos"> 473</span>            <span class="c1"># Inset with Difference</span>
<span class="linenos"> 474</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 475</span>                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mirror&#39;</span><span class="p">):</span>
<span class="linenos"> 476</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.12</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 477</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 478</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.11</span><span class="p">,</span> <span class="mf">.59</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 479</span>                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 480</span>                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 481</span>                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 482</span>                <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 483</span>                                                  <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 484</span>                <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 485</span>                                                    <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 486</span>                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos"> 487</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="linenos"> 488</span>                <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="linenos"> 489</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
<span class="linenos"> 490</span>                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 491</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="linenos"> 492</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="linenos"> 493</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 494</span>                <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
<span class="linenos"> 495</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.5$&#39;</span><span class="p">])</span>
<span class="linenos"> 496</span>                    <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.0$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;$0.5$&#39;</span><span class="p">])</span>
<span class="linenos"> 497</span>
<span class="linenos"> 498</span>            <span class="c1"># if nr == 57 and not kwargs.get(&#39;mirror&#39;):</span>
<span class="linenos"> 499</span>            <span class="c1">#    ax.legend(loc=&#39;upper left&#39;)#, ncol=2)</span>
<span class="linenos"> 500</span>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="o">==</span> <span class="mi">57</span><span class="p">):</span>
<span class="linenos"> 501</span>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># , ncol=2)</span>
<span class="linenos"> 502</span>
<span class="linenos"> 503</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 504</span>
<span class="linenos"> 505</span>    <span class="k">def</span> <span class="nf">plot_hloops2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">],</span>
<span class="linenos"> 506</span>                     <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-compare-3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 507</span>        <span class="sd">&quot;&quot;&quot;Outputs hloop-compare-3.pdf (not used anymore)</span>
<span class="linenos"> 508</span>
<span class="linenos"> 509</span><span class="sd">        Args:</span>
<span class="linenos"> 510</span><span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is a[85]+a[100].</span>
<span class="linenos"> 511</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="linenos"> 512</span><span class="sd">                &#39;hloop-compare-3&#39;.</span>
<span class="linenos"> 513</span><span class="sd">            **kwargs (TYPE): DESCRIPTION.</span>
<span class="linenos"> 514</span>
<span class="linenos"> 515</span><span class="sd">        Returns:</span>
<span class="linenos"> 516</span><span class="sd">            None.:</span>
<span class="linenos"> 517</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 518</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos"> 519</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 520</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
<span class="linenos"> 521</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 522</span>                                   <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 523</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos"> 524</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos"> 525</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 526</span>            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="mi">58</span><span class="p">:</span>
<span class="linenos"> 527</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos"> 528</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="linenos"> 529</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos"> 530</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 531</span>                                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 532</span>                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]:</span>
<span class="linenos"> 533</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 534</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 535</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 536</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos"> 537</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 538</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 539</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 540</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 541</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos"> 542</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 543</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 544</span>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]):</span>
<span class="linenos"> 545</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos"> 546</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 547</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="linenos"> 548</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="linenos"> 549</span>
<span class="linenos"> 550</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 551</span>
<span class="linenos"> 552</span>    <span class="k">def</span> <span class="nf">plot_hloops3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
<span class="linenos"> 553</span>                     <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-repeat&#39;</span><span class="p">,</span>
<span class="linenos"> 554</span>                     <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="mi">350</span><span class="p">),</span>
<span class="linenos"> 555</span>                     <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos"> 556</span>                     <span class="n">inset_xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
<span class="linenos"> 557</span>                     <span class="n">inset_ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)</span>
<span class="linenos"> 558</span>                     <span class="p">):</span>
<span class="linenos"> 559</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 560</span><span class="sd">            Compares two measurements at the same Angle (repeated</span>
<span class="linenos"> 561</span><span class="sd">            measurements).</span>
<span class="linenos"> 562</span>
<span class="linenos"> 563</span><span class="sd">        Args:</span>
<span class="linenos"> 564</span><span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [139,140].</span>
<span class="linenos"> 565</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="linenos"> 566</span><span class="sd">                &#39;hloop-repeat&#39;.</span>
<span class="linenos"> 567</span><span class="sd">            xlim (TYPE, optional): DESCRIPTION. The default is (-350, 350).</span>
<span class="linenos"> 568</span><span class="sd">            ylim:</span>
<span class="linenos"> 569</span><span class="sd">            inset_xlim (TYPE, optional): DESCRIPTION. The default is (-30, 30).</span>
<span class="linenos"> 570</span><span class="sd">            inset_ylim (TYPE, optional): DESCRIPTION. The default is (.15,</span>
<span class="linenos"> 571</span><span class="sd">                1.25).</span>
<span class="linenos"> 572</span>
<span class="linenos"> 573</span><span class="sd">        Returns:</span>
<span class="linenos"> 574</span><span class="sd">            None.:</span>
<span class="linenos"> 575</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 576</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 577</span>                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 578</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos"> 579</span>        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="linenos"> 580</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 581</span>            <span class="c1"># ax = axes[i//2][i%2]</span>
<span class="linenos"> 582</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos"> 583</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 584</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="linenos"> 585</span>            <span class="n">bmin1</span><span class="p">,</span> <span class="n">bmax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
<span class="linenos"> 586</span>            <span class="n">bmin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bmin1</span><span class="p">)</span>
<span class="linenos"> 587</span>            <span class="n">bmax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bmax1</span><span class="p">)</span>
<span class="linenos"> 588</span>
<span class="linenos"> 589</span>        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
<span class="linenos"> 590</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
<span class="linenos"> 591</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 592</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">bmin</span><span class="p">)</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bmax</span><span class="p">)</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
<span class="linenos"> 593</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;M</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> ($</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos"> 594</span>                                                   <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span>
<span class="linenos"> 595</span>                                                       <span class="s1">&#39;Structure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
<span class="linenos"> 596</span>                                                       <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\_&#39;</span><span class="p">),</span>
<span class="linenos"> 597</span>                                                   <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span>
<span class="linenos"> 598</span>                                                       <span class="s1">&#39;Angle&#39;</span><span class="p">]))</span>
<span class="linenos"> 599</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 600</span>                   <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;M</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">to_show</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">])</span>
<span class="linenos"> 601</span>        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 602</span>        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 603</span>        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos"> 604</span>
<span class="linenos"> 605</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 606</span>            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.055</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 607</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 608</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 609</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 610</span>            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 611</span>            <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
<span class="linenos"> 612</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos"> 613</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 614</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 615</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="linenos"> 616</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos"> 617</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 618</span>
<span class="linenos"> 619</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
<span class="linenos"> 620</span>            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">)</span>
<span class="linenos"> 621</span>            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 622</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 623</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 624</span>            <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
<span class="linenos"> 625</span>                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset2</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 626</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
<span class="linenos"> 627</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_ylim</span><span class="p">)</span>
<span class="linenos"> 628</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="linenos"> 629</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 630</span>
<span class="linenos"> 631</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
<span class="linenos"> 632</span>            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.43</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 633</span>            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 634</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 635</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 636</span>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop_gradient3</span><span class="p">(</span><span class="n">inset3</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="n">to_show</span><span class="p">,</span>
<span class="linenos"> 637</span>                                      <span class="n">limit</span><span class="o">=</span><span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
<span class="linenos"> 638</span>            <span class="c1"># inset3.set_xticklabels([&#39;&#39;])</span>
<span class="linenos"> 639</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
<span class="linenos"> 640</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 641</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="linenos"> 642</span>
<span class="linenos"> 643</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 644</span>
<span class="linenos"> 645</span>    <span class="k">def</span> <span class="nf">plot_hloops_compare_90</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">414</span><span class="p">,</span> <span class="mi">415</span><span class="p">],</span>
<span class="linenos"> 646</span>                               <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;plusses&#39;</span><span class="p">,</span>
<span class="linenos"> 647</span>                               <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-repeat-414&#39;</span><span class="p">,</span>
<span class="linenos"> 648</span>                               <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span>
<span class="linenos"> 649</span>                               <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.36</span><span class="p">,</span> <span class="mf">.76</span><span class="p">),</span>
<span class="linenos"> 650</span>                               <span class="n">inset_xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">),</span>
<span class="linenos"> 651</span>                               <span class="n">inset_ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.75</span><span class="p">),</span>
<span class="linenos"> 652</span>                               <span class="n">insets</span><span class="o">=</span><span class="p">[((</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.35</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">225</span><span class="p">,</span> <span class="mi">225</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.75</span><span class="p">),</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">))],</span>
<span class="linenos"> 653</span>                               <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
<span class="linenos"> 654</span>                               <span class="n">nograd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 655</span>                               <span class="n">nodiff</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 656</span>                               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
<span class="linenos"> 657</span>                               <span class="p">):</span>
<span class="linenos"> 658</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 659</span><span class="sd">            Compares multiple measurements at 90 deg (repeated</span>
<span class="linenos"> 660</span><span class="sd">            measurements).</span>
<span class="linenos"> 661</span>
<span class="linenos"> 662</span><span class="sd">        Args:</span>
<span class="linenos"> 663</span><span class="sd">            to_show (TYPE, optional): DESCRIPTION. The default is [414,415].</span>
<span class="linenos"> 664</span><span class="sd">            structure:</span>
<span class="linenos"> 665</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="linenos"> 666</span><span class="sd">                &#39;hloop-repeat-414&#39;.</span>
<span class="linenos"> 667</span><span class="sd">            xlim (TYPE, optional): DESCRIPTION. The default is (-750, 750).</span>
<span class="linenos"> 668</span><span class="sd">            ylim:</span>
<span class="linenos"> 669</span><span class="sd">            inset_xlim (TYPE, optional): DESCRIPTION. The default is (-100,</span>
<span class="linenos"> 670</span><span class="sd">                100).</span>
<span class="linenos"> 671</span><span class="sd">            inset_ylim (TYPE, optional): DESCRIPTION. The default is (-1.25,</span>
<span class="linenos"> 672</span><span class="sd">                .75).</span>
<span class="linenos"> 673</span><span class="sd">            legend_loc:</span>
<span class="linenos"> 674</span><span class="sd">            nograd:</span>
<span class="linenos"> 675</span>
<span class="linenos"> 676</span><span class="sd">        Returns:</span>
<span class="linenos"> 677</span><span class="sd">            None.:</span>
<span class="linenos"> 678</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 679</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 680</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 681</span>                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 682</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="linenos"> 683</span>        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 684</span>        <span class="k">if</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">:</span>
<span class="linenos"> 685</span>            <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Bx8&#39;</span>
<span class="linenos"> 686</span>        <span class="k">elif</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;crosses&#39;</span><span class="p">:</span>
<span class="linenos"> 687</span>            <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Bx9&#39;</span>
<span class="linenos"> 688</span>
<span class="linenos"> 689</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 690</span>            <span class="c1"># ax = axes[i//2][i%2]</span>
<span class="linenos"> 691</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>  <span class="c1"># Load measurement</span>
<span class="linenos"> 692</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">remove_zero</span><span class="p">()</span>  <span class="c1"># Remove measurement Errors</span>
<span class="linenos"> 693</span>
<span class="linenos"> 694</span>            <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 695</span>                                          <span class="n">show_plusses</span><span class="o">=</span><span class="p">(</span>
<span class="linenos"> 696</span>                                                  <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">),</span>
<span class="linenos"> 697</span>                                          <span class="n">show_crosses</span><span class="o">=</span><span class="p">(</span>
<span class="linenos"> 698</span>                                                  <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;crosses&#39;</span><span class="p">))</span>
<span class="linenos"> 699</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="linenos"> 700</span>
<span class="linenos"> 701</span>            <span class="n">legend</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;m</span><span class="si">%d</span><span class="s2">: Up&quot;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">,</span> <span class="s2">&quot;m</span><span class="si">%d</span><span class="s2">: Down&quot;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">]</span>
<span class="linenos"> 702</span>
<span class="linenos"> 703</span>        <span class="n">m_numbers</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">to_show</span><span class="p">))</span>
<span class="linenos"> 704</span>
<span class="linenos"> 705</span>        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
<span class="linenos"> 706</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
<span class="linenos"> 707</span>
<span class="linenos"> 708</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 709</span>                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 710</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">textbf{</span><span class="si">%s</span><span class="s2">} ($</span><span class="si">%s</span><span class="s2">^{</span><span class="se">\\</span><span class="s2">circ}$)&quot;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos"> 711</span>                                                <span class="n">structure</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span>
<span class="linenos"> 712</span>                                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">]))</span>
<span class="linenos"> 713</span>
<span class="linenos"> 714</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 715</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 716</span>                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 717</span>        <span class="n">all_insets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 718</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">nodiff</span><span class="p">:</span>
<span class="linenos"> 719</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 720</span>                <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 721</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 722</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 723</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 724</span>                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset</span><span class="p">)</span>
<span class="linenos"> 725</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 726</span>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 727</span>                    <span class="k">if</span> <span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;plusses&#39;</span><span class="p">:</span>
<span class="linenos"> 728</span>                        <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">(</span>
<span class="linenos"> 729</span>                            <span class="n">fitted_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 730</span>                    <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 731</span>                        <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span>
<span class="linenos"> 732</span>                        <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span>
<span class="linenos"> 733</span>                        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 734</span>                        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 735</span>                        <span class="n">B_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="linenos"> 736</span>                        <span class="n">B_stray</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B_ext</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B_ext</span><span class="p">)</span>
<span class="linenos"> 737</span>                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="linenos"> 738</span>                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="linenos"> 739</span>                    <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 740</span>                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 741</span>                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 742</span>                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 743</span>
<span class="linenos"> 744</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="linenos"> 745</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\Delta B_z</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos"> 746</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference&quot;</span><span class="p">)</span>
<span class="linenos"> 747</span>
<span class="linenos"> 748</span>        <span class="n">subfig</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="linenos"> 749</span>        <span class="k">for</span> <span class="n">bbox</span><span class="p">,</span> <span class="p">(</span><span class="n">inset_xlim</span><span class="p">,</span> <span class="n">inset_ylim</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="ow">in</span> <span class="n">insets</span><span class="p">:</span>
<span class="linenos"> 750</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
<span class="linenos"> 751</span>                <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 752</span>                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 753</span>                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 754</span>                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset2</span><span class="p">)</span>
<span class="linenos"> 755</span>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">to_show</span><span class="p">):</span>
<span class="linenos"> 756</span>                    <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 757</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
<span class="linenos"> 758</span>                    <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos"> 759</span>                                <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
<span class="linenos"> 760</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
<span class="linenos"> 761</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_ylim</span><span class="p">)</span>
<span class="linenos"> 762</span>
<span class="linenos"> 763</span>            <span class="p">(</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">ann_xx</span><span class="p">),</span> <span class="p">(</span><span class="n">ann_yy</span><span class="p">,</span> <span class="n">ann_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">inset2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="n">inset2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="linenos"> 764</span>            <span class="n">ann_x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ann_xx</span> <span class="o">-</span> <span class="n">ann_x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.05</span>
<span class="linenos"> 765</span>            <span class="n">ann_y</span> <span class="o">-=</span> <span class="p">(</span><span class="n">ann_y</span> <span class="o">-</span> <span class="n">ann_yy</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.20</span>
<span class="linenos"> 766</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ann_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">subfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span>
<span class="linenos"> 767</span>                          <span class="n">fontdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
<span class="linenos"> 768</span>                          <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.1&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;#ccf&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="linenos"> 769</span>
<span class="linenos"> 770</span>            <span class="c1"># Draw Area into big plot</span>
<span class="linenos"> 771</span>            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 772</span>            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 773</span>            <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span>
<span class="linenos"> 774</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="linenos"> 775</span>            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="linenos"> 776</span>
<span class="linenos"> 777</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">nograd</span><span class="p">:</span>
<span class="linenos"> 778</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Paired&#39;</span><span class="p">):</span>
<span class="linenos"> 779</span>                <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.08</span><span class="p">,</span> <span class="mf">.67</span><span class="p">,</span> <span class="mf">.27</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 780</span>                <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 781</span>                                    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 782</span>                                    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 783</span>                <span class="n">all_insets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inset3</span><span class="p">)</span>
<span class="linenos"> 784</span>                <span class="n">c</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="linenos"> 785</span>                <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop_gradient3</span><span class="p">(</span><span class="n">inset3</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">inset_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos"> 786</span>                                          <span class="n">column</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
<span class="linenos"> 787</span>                <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">inset_xlim</span><span class="p">)</span>
<span class="linenos"> 788</span>                <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 789</span>                <span class="n">inset3</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="linenos"> 790</span>
<span class="linenos"> 791</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
<span class="linenos"> 792</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_show</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<span class="linenos"> 793</span>
<span class="linenos"> 794</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 795</span>
<span class="linenos"> 796</span>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">all_insets</span><span class="p">)</span>
<span class="linenos"> 797</span>
<span class="linenos"> 798</span>    <span class="k">def</span> <span class="nf">plot_hloops4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-parallel&#39;</span><span class="p">,</span>
<span class="linenos"> 799</span>                     <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;M57: $90^</span><span class="se">\\</span><span class="s2">circ$ Parallel measurement&quot;</span><span class="p">,</span>
<span class="linenos"> 800</span>                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 801</span>        <span class="sd">&quot;&quot;&quot;Plots a single measurement (default: 90deg parallel)</span>
<span class="linenos"> 802</span>
<span class="linenos"> 803</span><span class="sd">        Args:</span>
<span class="linenos"> 804</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is</span>
<span class="linenos"> 805</span><span class="sd">                &#39;hloop-parallel&#39;.</span>
<span class="linenos"> 806</span><span class="sd">            figtitle (TYPE, optional): DESCRIPTION. The default is &quot;M57:</span>
<span class="linenos"> 807</span><span class="sd">                $90^\circ$ Parallel measurement&quot;.</span>
<span class="linenos"> 808</span><span class="sd">            **kwargs (TYPE): DESCRIPTION.</span>
<span class="linenos"> 809</span>
<span class="linenos"> 810</span><span class="sd">        Returns:</span>
<span class="linenos"> 811</span><span class="sd">            None.:</span>
<span class="linenos"> 812</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 813</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos"> 814</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos"> 815</span>                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 816</span>        <span class="c1"># self.mset_factor(-1)</span>
<span class="linenos"> 817</span>        <span class="c1"># self.mfactor = 1</span>
<span class="linenos"> 818</span>
<span class="linenos"> 819</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span>
<span class="linenos"> 820</span>                               <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 821</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span> <span class="o">+=</span> <span class="mf">.25</span>
<span class="linenos"> 822</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span> <span class="o">+=</span> <span class="mf">.25</span>
<span class="linenos"> 823</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
<span class="linenos"> 824</span>                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos"> 825</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
<span class="linenos"> 826</span>                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos"> 827</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 828</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">):</span>
<span class="linenos"> 829</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">))</span>
<span class="linenos"> 830</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 831</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)</span>
<span class="linenos"> 832</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos"> 833</span>
<span class="linenos"> 834</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 835</span>            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">.46</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.23</span><span class="p">)</span>
<span class="linenos"> 836</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 837</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 838</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 839</span>            <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 840</span>            <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">get_downminusup_strayfield</span><span class="p">()</span>
<span class="linenos"> 841</span>            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos"> 842</span>                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 843</span>            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 844</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 845</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference Plusses&quot;</span><span class="p">)</span>
<span class="linenos"> 846</span>
<span class="linenos"> 847</span>            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.35</span><span class="p">,</span> <span class="mf">.22</span><span class="p">)</span>
<span class="linenos"> 848</span>            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 849</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 850</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 851</span>            <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 852</span>            <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx9</span><span class="p">)</span>
<span class="linenos"> 853</span>            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="linenos"> 854</span>            <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="linenos"> 855</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos"> 856</span>                        <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 857</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="linenos"> 858</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="linenos"> 859</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Difference Crosses&quot;</span><span class="p">)</span>
<span class="linenos"> 860</span>
<span class="linenos"> 861</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pdf&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 862</span>
<span class="linenos"> 863</span>    <span class="k">def</span> <span class="nf">plot_cubes_trees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 864</span>        <span class="sd">&quot;&quot;&quot;Plots difference between RAW data from Cubes and Trees (1st</span>
<span class="linenos"> 865</span><span class="sd">        Generation)</span>
<span class="linenos"> 866</span>
<span class="linenos"> 867</span><span class="sd">        Returns:</span>
<span class="linenos"> 868</span><span class="sd">            None.:</span>
<span class="linenos"> 869</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 870</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
<span class="linenos"> 871</span>                               <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 872</span>        <span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;data/Data/</span><span class="si">%s</span><span class="s1">deg_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">struct</span><span class="p">)</span> <span class="k">for</span>
<span class="linenos"> 873</span>                     <span class="n">angle</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">]</span> <span class="k">for</span>
<span class="linenos"> 874</span>                     <span class="n">struct</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cubes&#39;</span><span class="p">,</span> <span class="s1">&#39;Trees&#39;</span><span class="p">]</span>
<span class="linenos"> 875</span>                     <span class="p">]</span>
<span class="linenos"> 876</span>
<span class="linenos"> 877</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos"> 878</span>        <span class="n">comp</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 879</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_list</span><span class="p">):</span>
<span class="linenos"> 880</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
<span class="linenos"> 881</span>            <span class="n">load_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">.dat&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span> <span class="k">for</span>
<span class="linenos"> 882</span>                          <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]]</span>
<span class="linenos"> 883</span>            <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">file_list</span><span class="o">=</span><span class="n">load_files</span><span class="p">)</span>
<span class="linenos"> 884</span>            <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>
<span class="linenos"> 885</span>
<span class="linenos"> 886</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
<span class="linenos"> 887</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
<span class="linenos"> 888</span>
<span class="linenos"> 889</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$V_x [</span><span class="se">\\</span><span class="s2">mathrm{</span><span class="se">\\</span><span class="s2">mu V}]$&quot;</span><span class="p">)</span>
<span class="linenos"> 890</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu_0 H_</span><span class="si">{ext}</span><span class="s2">$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos"> 891</span>            <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
<span class="linenos"> 892</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
<span class="linenos"> 893</span>
<span class="linenos"> 894</span>            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;cubes&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 895</span>                <span class="n">struct</span> <span class="o">=</span> <span class="s1">&#39;Cubes&#39;</span>
<span class="linenos"> 896</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 897</span>                <span class="n">struct</span> <span class="o">=</span> <span class="s2">&quot;Trees&quot;</span>
<span class="linenos"> 898</span>
<span class="linenos"> 899</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> ($</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)))</span>
<span class="linenos"> 900</span>
<span class="linenos"> 901</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">):</span>
<span class="linenos"> 902</span>                <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos"> 903</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.69</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 904</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 905</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.12</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 906</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos"> 907</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos"> 908</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 909</span>                <span class="n">max_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 910</span>                <span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span>
<span class="linenos"> 911</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="n">max_b</span><span class="p">,</span> <span class="n">max_b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos"> 912</span>                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">.75</span><span class="p">)</span>
<span class="linenos"> 913</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ext</span><span class="p">,</span> <span class="n">B_stray</span><span class="p">)</span>
<span class="linenos"> 914</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
<span class="linenos"> 915</span>                <span class="c1"># inset.set_title(&quot;Difference&quot;)</span>
<span class="linenos"> 916</span>
<span class="linenos"> 917</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="linenos"> 918</span>
<span class="linenos"> 919</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;compare-cubes-trees.pdf&quot;</span><span class="p">)</span>
<span class="linenos"> 920</span>
<span class="linenos"> 921</span>    <span class="k">def</span> <span class="nf">plot_hloop_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-gradient&#39;</span><span class="p">):</span>
<span class="linenos"> 922</span>        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>
<span class="linenos"> 923</span>
<span class="linenos"> 924</span><span class="sd">        Args:</span>
<span class="linenos"> 925</span><span class="sd">            limit:</span>
<span class="linenos"> 926</span><span class="sd">            filename:</span>
<span class="linenos"> 927</span>
<span class="linenos"> 928</span><span class="sd">        Returns:</span>
<span class="linenos"> 929</span><span class="sd">            None.:</span>
<span class="linenos"> 930</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 931</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 932</span>                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 933</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
<span class="linenos"> 934</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
<span class="linenos"> 935</span>                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos"> 936</span>
<span class="linenos"> 937</span>        <span class="n">grad1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
<span class="linenos"> 938</span>                 <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
<span class="linenos"> 939</span>        <span class="n">grad12</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 940</span>            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
<span class="linenos"> 941</span>            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
<span class="linenos"> 942</span>
<span class="linenos"> 943</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 944</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="linenos"> 945</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 946</span>            <span class="n">g</span> <span class="o">=</span> <span class="n">grad1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 947</span>            <span class="n">g2</span> <span class="o">=</span> <span class="n">grad12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 948</span>
<span class="linenos"> 949</span>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 950</span>                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Plusses&#39;</span>
<span class="linenos"> 951</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 952</span>                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Crosses&#39;</span>
<span class="linenos"> 953</span>
<span class="linenos"> 954</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M57: Gradient (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
<span class="linenos"> 955</span>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 956</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
<span class="linenos"> 957</span>                    <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
<span class="linenos"> 958</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
<span class="linenos"> 959</span>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 960</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
<span class="linenos"> 961</span>                    <span class="n">g2</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
<span class="linenos"> 962</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
<span class="linenos"> 963</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
<span class="linenos"> 964</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="linenos"> 965</span>
<span class="linenos"> 966</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos"> 967</span>
<span class="linenos"> 968</span>    <span class="k">def</span> <span class="nf">plot_hloop_gradient2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hloop-gradient&#39;</span><span class="p">):</span>
<span class="linenos"> 969</span>        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>
<span class="linenos"> 970</span>
<span class="linenos"> 971</span><span class="sd">        Args:</span>
<span class="linenos"> 972</span><span class="sd">            limit:</span>
<span class="linenos"> 973</span><span class="sd">            filename:</span>
<span class="linenos"> 974</span>
<span class="linenos"> 975</span><span class="sd">        Returns:</span>
<span class="linenos"> 976</span><span class="sd">            None.:</span>
<span class="linenos"> 977</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 978</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 979</span>                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos"> 980</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
<span class="linenos"> 981</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
<span class="linenos"> 982</span>                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos"> 983</span>
<span class="linenos"> 984</span>        <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
<span class="linenos"> 985</span>                <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())]</span>
<span class="linenos"> 986</span>
<span class="linenos"> 987</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="linenos"> 988</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: Gradient (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
<span class="linenos"> 989</span>                                             <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]))</span>
<span class="linenos"> 990</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="linenos"> 991</span>            <span class="n">g</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 992</span>
<span class="linenos"> 993</span>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 994</span>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span>
<span class="linenos"> 995</span>                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Up&#39;</span>
<span class="linenos"> 996</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 997</span>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span>
<span class="linenos"> 998</span>                <span class="n">add</span> <span class="o">=</span> <span class="s1">&#39;Down&#39;</span>
<span class="linenos"> 999</span>
<span class="linenos">1000</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
<span class="linenos">1001</span>                    <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
<span class="linenos">1002</span>                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">add</span><span class="p">)</span>
<span class="linenos">1003</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
<span class="linenos">1004</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos">1005</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="linenos">1006</span>
<span class="linenos">1007</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos">1008</span>
<span class="linenos">1009</span>    <span class="k">def</span> <span class="nf">plot_hloop_gradient3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">to_show</span><span class="o">=</span><span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="linenos">1010</span>                             <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Vx8&#39;</span><span class="p">):</span>
<span class="linenos">1011</span>        <span class="sd">&quot;&quot;&quot;Plotting the gradient along the</span>
<span class="linenos">1012</span>
<span class="linenos">1013</span><span class="sd">        Args:</span>
<span class="linenos">1014</span><span class="sd">            ax:</span>
<span class="linenos">1015</span><span class="sd">            to_show:</span>
<span class="linenos">1016</span><span class="sd">            limit:</span>
<span class="linenos">1017</span><span class="sd">            column:</span>
<span class="linenos">1018</span>
<span class="linenos">1019</span><span class="sd">        Returns:</span>
<span class="linenos">1020</span><span class="sd">            None.:</span>
<span class="linenos">1021</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1022</span>        <span class="c1"># self.m.style.set_style(default=True, grid=True,</span>
<span class="linenos">1023</span>        <span class="c1">#        style=&#39;ticks&#39;,</span>
<span class="linenos">1024</span>        <span class="c1">#        size=&#39;talk&#39;,</span>
<span class="linenos">1025</span>        <span class="c1">#        palette=&#39;Paired&#39;,</span>
<span class="linenos">1026</span>        <span class="c1">#        latex=True,)</span>
<span class="linenos">1027</span>
<span class="linenos">1028</span>        <span class="n">limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
<span class="linenos">1029</span>
<span class="linenos">1030</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gradient&#39;</span><span class="p">)</span>
<span class="linenos">1031</span>        <span class="k">for</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">to_show</span><span class="p">:</span>
<span class="linenos">1032</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
<span class="linenos">1033</span>            <span class="n">c</span> <span class="o">=</span> <span class="n">column</span>
<span class="linenos">1034</span>            <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Time</span><span class="p">)),</span>
<span class="linenos">1035</span>                    <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span>
<span class="linenos">1036</span>                              <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Time</span><span class="p">))]</span>
<span class="linenos">1037</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="linenos">1038</span>                <span class="n">g</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos">1039</span>
<span class="linenos">1040</span>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">1041</span>                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">1042</span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;Up&#39;</span>
<span class="linenos">1043</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos">1044</span>                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">1045</span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;Down&#39;</span>
<span class="linenos">1046</span>
<span class="linenos">1047</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">],</span>
<span class="linenos">1048</span>                        <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
<span class="linenos">1049</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">direction</span><span class="p">))</span>
<span class="linenos">1050</span>
<span class="linenos">1051</span>        <span class="c1"># ax.set_xlim(-limit, limit)</span>
<span class="linenos">1052</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$dV_H/dt\; [</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm{V/s}]$&#39;</span><span class="p">)</span>
<span class="linenos">1053</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos">1054</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="linenos">1055</span>
<span class="linenos">1056</span>    <span class="k">def</span> <span class="nf">plot_hloop_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">1057</span>        <span class="sd">&quot;&quot;&quot;Plots the Temperature of a Hloop measurement.</span>
<span class="linenos">1058</span>
<span class="linenos">1059</span><span class="sd">        Returns:</span>
<span class="linenos">1060</span><span class="sd">            None.:</span>
<span class="linenos">1061</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1062</span>
<span class="linenos">1063</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1064</span>                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos">1065</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
<span class="linenos">1066</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
<span class="linenos">1067</span>                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">1068</span>
<span class="linenos">1069</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="linenos">1070</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<span class="linenos">1071</span>            <span class="s1">&#39;M</span><span class="si">%s</span><span class="s1">: Sample Temperature&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">])</span>
<span class="linenos">1072</span>
<span class="linenos">1073</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Sample Temp&#39;</span><span class="p">]),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
<span class="linenos">1074</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Sample Temp&#39;</span><span class="p">]),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
<span class="linenos">1075</span>
<span class="linenos">1076</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> [</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="linenos">1077</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature $[</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mK}</span><span class="s1">]$&#39;</span><span class="p">)</span>
<span class="linenos">1078</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos">1079</span>
<span class="linenos">1080</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hloop-90-temp.pdf&#39;</span><span class="p">)</span>
<span class="linenos">1081</span>
<span class="linenos">1082</span>    <span class="c1">#### Plot Static Fields</span>
<span class="linenos">1083</span>    <span class="k">def</span> <span class="nf">plot_static_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;static-field&#39;</span><span class="p">,</span>
<span class="linenos">1084</span>                           <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">1085</span>        <span class="sd">&quot;&quot;&quot;Plot the Signal Analyzer (SA) Data for static fields (not sweeping)</span>
<span class="linenos">1086</span>
<span class="linenos">1087</span><span class="sd">        Returns:</span>
<span class="linenos">1088</span><span class="sd">            None.:</span>
<span class="linenos">1089</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1090</span>        <span class="n">tmp</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1091</span>            <span class="s1">&#39;Plusses (25 mT)&#39;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
<span class="linenos">1092</span>            <span class="s1">&#39;Plusses (-25 mT)&#39;</span><span class="p">:</span> <span class="mi">361</span><span class="p">,</span>
<span class="linenos">1093</span>            <span class="s1">&#39;Plusses (-9.4 mT)&#39;</span><span class="p">:</span> <span class="mi">282</span><span class="p">,</span>
<span class="linenos">1094</span>            <span class="s1">&#39;Crosses (-9.4 mT)&#39;</span><span class="p">:</span> <span class="mi">283</span><span class="p">,</span>
<span class="linenos">1095</span>            <span class="s1">&#39;Plusses (0 T)&#39;</span><span class="p">:</span> <span class="mi">281</span><span class="p">,</span>
<span class="linenos">1096</span>            <span class="s1">&#39;Crosses (0 T)&#39;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span>
<span class="linenos">1097</span>            <span class="s1">&#39;Empty (0 T)&#39;</span><span class="p">:</span> <span class="mi">310</span><span class="p">,</span>
<span class="linenos">1098</span>            <span class="c1"># &#39;Crosses (250 mT)&#39;: 315,</span>
<span class="linenos">1099</span>        <span class="p">}</span>
<span class="linenos">1100</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1101</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1102</span>            <span class="n">lofm</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">j</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="p">{}]})</span>
<span class="linenos">1103</span>
<span class="linenos">1104</span>        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1105</span>                                 <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos">1106</span>                                 <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
<span class="linenos">1107</span>                                 <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos">1108</span>                                 <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">1109</span>
<span class="linenos">1110</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1111</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1112</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Static Field&#39;</span><span class="p">,</span>
<span class="linenos">1113</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">5e0</span><span class="p">),</span>
<span class="linenos">1114</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span>
<span class="linenos">1115</span>                                <span class="p">),</span>
<span class="linenos">1116</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1117</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">),</span>
<span class="linenos">1118</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="linenos">1119</span>                                <span class="p">)</span>
<span class="linenos">1120</span>
<span class="linenos">1121</span>        <span class="c1"># ax = plt.gca()</span>
<span class="linenos">1122</span>        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
<span class="linenos">1123</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">1124</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1125</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.58</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.4</span><span class="p">),</span>
<span class="linenos">1126</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1127</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1128</span>                                       <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos">1129</span>                                       <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
<span class="linenos">1130</span>                                       <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span>
<span class="linenos">1131</span>                                       <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1132</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1133</span>                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># &#39; ($-M_S \\rightarrow +M_S$)&#39;,</span>
<span class="linenos">1134</span>                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># &#39; ($+M_S \\rightarrow -M_S$)&#39;])</span>
<span class="linenos">1135</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1136</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1137</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1138</span>
<span class="linenos">1139</span>                <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos">1140</span>                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
<span class="linenos">1141</span>                        <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()][</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span>
<span class="linenos">1142</span>
<span class="linenos">1143</span>                <span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos">1144</span>                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">iloc</span><span class="p">[((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()][</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span>
<span class="linenos">1145</span>
<span class="linenos">1146</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#000099&#39;</span><span class="p">,</span>
<span class="linenos">1147</span>                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
<span class="linenos">1148</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9999FF&#39;</span><span class="p">,</span>
<span class="linenos">1149</span>                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
<span class="linenos">1150</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">9.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.4</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mf">9.4</span><span class="p">),</span> <span class="n">a</span><span class="p">(</span><span class="o">-</span><span class="mf">9.4</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="linenos">1151</span>                           <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
<span class="linenos">1152</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FF3333&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="linenos">1153</span>
<span class="linenos">1154</span>                <span class="c1"># ana.set_relative_yticks(inset)</span>
<span class="linenos">1155</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="linenos">1156</span>
<span class="linenos">1157</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="linenos">1158</span>
<span class="linenos">1159</span>    <span class="c1">#### Sweeping Field</span>
<span class="linenos">1160</span>    <span class="k">def</span> <span class="nf">first_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;vacant-sweeps&#39;</span><span class="p">,</span>
<span class="linenos">1161</span>                     <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">1162</span>        <span class="sd">&quot;&quot;&quot;First field sweeps (plus minus 50/75/100/etc.)</span>
<span class="linenos">1163</span>
<span class="linenos">1164</span><span class="sd">        Args:</span>
<span class="linenos">1165</span><span class="sd">            add: adding more data</span>
<span class="linenos">1166</span><span class="sd">            filename: saving as pdf (default: vacant-sweeps)</span>
<span class="linenos">1167</span>
<span class="linenos">1168</span><span class="sd">        Returns:</span>
<span class="linenos">1169</span><span class="sd">            vacant-sweeps.pdf:</span>
<span class="linenos">1170</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1171</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1172</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1173</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="linenos">1174</span>
<span class="linenos">1175</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1176</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1177</span>            <span class="c1"># 382: [(-25,25), &#39;Plusses&#39;, 5, {}],</span>
<span class="linenos">1178</span>            <span class="mi">362</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1179</span>            <span class="mi">363</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1180</span>            <span class="mi">364</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1181</span>            <span class="mi">366</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1182</span>            <span class="mi">365</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1183</span>            <span class="c1"># 352: [(&quot;-M_s \\rightarrow -25&quot;,25), &#39;Plusses&#39;, .1],</span>
<span class="linenos">1184</span>        <span class="p">}</span>
<span class="linenos">1185</span>        <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
<span class="linenos">1186</span>            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos">1187</span>                <span class="mi">336</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1188</span>                <span class="mi">331</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
<span class="linenos">1189</span>                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
<span class="linenos">1190</span>                <span class="mi">332</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
<span class="linenos">1191</span>                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
<span class="linenos">1192</span>                <span class="mi">333</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{C}</span><span class="se">\\</span><span class="s1">,{</span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span>
<span class="linenos">1193</span>                      <span class="p">{</span><span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
<span class="linenos">1194</span>            <span class="p">})</span>
<span class="linenos">1195</span>
<span class="linenos">1196</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1197</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="s2"> </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1198</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">1199</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1200</span>            <span class="p">),</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="linenos">1201</span>
<span class="linenos">1202</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1203</span>                                <span class="c1"># fit_range=(2e-2, 9e-1),</span>
<span class="linenos">1204</span>                                <span class="c1"># show_fit=True,</span>
<span class="linenos">1205</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1206</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Huge </span><span class="se">\\</span><span class="s1">textbf{b) Sweeping Inside the Hysteresis (Plusses)}&#39;</span><span class="p">,</span>
<span class="linenos">1207</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
<span class="linenos">1208</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">7e-2</span><span class="p">)),</span>
<span class="linenos">1209</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1210</span>                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1211</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
<span class="linenos">1212</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
<span class="linenos">1213</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1214</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
<span class="linenos">1215</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
<span class="linenos">1216</span>                                <span class="p">),</span>
<span class="linenos">1217</span>                                <span class="p">)</span>
<span class="linenos">1218</span>
<span class="linenos">1219</span>        <span class="k">if</span> <span class="n">show_inset</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span> <span class="c1"># Inset with Strayfield</span>
<span class="linenos">1220</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">1221</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1222</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.74</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1223</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1224</span>                <span class="c1"># Plotting Lines for each measurement</span>
<span class="linenos">1225</span>                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="linenos">1226</span>                <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1227</span>                    <span class="n">x1</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">1228</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>
<span class="linenos">1229</span>
<span class="linenos">1230</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1231</span>                                       <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">1232</span>                                       <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">1233</span>                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1234</span>
<span class="linenos">1235</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
<span class="linenos">1236</span>                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">76</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">114</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">176</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
<span class="linenos">1237</span>                           <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
<span class="linenos">1238</span>                <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
<span class="linenos">1239</span>                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">221</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">132</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">82</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
<span class="linenos">1240</span>                           <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
<span class="linenos">1241</span>
<span class="linenos">1242</span>                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
<span class="linenos">1243</span>                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
<span class="linenos">1244</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1245</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="linenos">1246</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1247</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span>
<span class="linenos">1248</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">175</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1249</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
<span class="linenos">1250</span>                                 <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1251</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
<span class="linenos">1252</span>                           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
<span class="linenos">1253</span>
<span class="linenos">1254</span>                <span class="c1"># X-Ticks (labels)</span>
<span class="linenos">1255</span>                <span class="n">xt_labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">1256</span>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]:</span>
<span class="linenos">1257</span>                    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">1258</span>                        <span class="n">xt_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span>
<span class="linenos">1259</span>                    <span class="k">else</span><span class="p">:</span>
<span class="linenos">1260</span>                        <span class="n">xt_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="linenos">1261</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xt_labels</span><span class="p">)</span>
<span class="linenos">1262</span>
<span class="linenos">1263</span>        <span class="c1"># Inset showing fitted data</span>
<span class="linenos">1264</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
<span class="linenos">1265</span>            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1266</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.44</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1267</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1268</span>            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1269</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.09</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1270</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1271</span>
<span class="linenos">1272</span>            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1273</span>            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1274</span>                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">2e-1</span><span class="p">))</span>
<span class="linenos">1275</span>                <span class="n">voltage</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">1276</span>                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;end field&#39;</span><span class="p">:</span> <span class="n">voltage</span><span class="p">,</span>
<span class="linenos">1277</span>                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
<span class="linenos">1278</span>                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">}</span>
<span class="linenos">1279</span>
<span class="linenos">1280</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1281</span>                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1282</span>
<span class="linenos">1283</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;End field [$\mu_0 \mathrm{H_</span><span class="si">{ext}</span><span class="s1">}$]&#39;</span><span class="p">)</span>
<span class="linenos">1284</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
<span class="linenos">1285</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos">1286</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mf">8e-7</span><span class="p">,</span> <span class="mf">9e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">])</span>
<span class="linenos">1287</span>
<span class="linenos">1288</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;End field [$\mu_0 \mathrm{H_</span><span class="si">{ext}</span><span class="s1">}$]&#39;</span><span class="p">)</span>
<span class="linenos">1289</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
<span class="linenos">1290</span>
<span class="linenos">1291</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos">1292</span>        <span class="k">return</span> <span class="n">i2data</span>
<span class="linenos">1293</span>
<span class="linenos">1294</span>    <span class="k">def</span> <span class="nf">compare_voltages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;compare-voltages&#39;</span><span class="p">,</span>
<span class="linenos">1295</span>                         <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">1296</span>        <span class="sd">&quot;&quot;&quot;Compare different applied Voltages.</span>
<span class="linenos">1297</span>
<span class="linenos">1298</span><span class="sd">        Returns:</span>
<span class="linenos">1299</span><span class="sd">            compare-voltages.pdf:</span>
<span class="linenos">1300</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1301</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1302</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1303</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="linenos">1304</span>
<span class="linenos">1305</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1306</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1307</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<span class="linenos">1308</span>            <span class="n">to_show</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">377</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="linenos">1309</span>
<span class="linenos">1310</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1311</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">mu</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{A}</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1312</span>                <span class="n">content</span>
<span class="linenos">1313</span>            <span class="p">),</span> <span class="p">{}]</span>
<span class="linenos">1314</span>
<span class="linenos">1315</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1316</span>                                <span class="c1"># fit_range=(2e-2, 7e-1),</span>
<span class="linenos">1317</span>                                <span class="c1"># show_fit=True,</span>
<span class="linenos">1318</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1319</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Current Amplitudes (SR785)&#39;</span><span class="p">,</span>
<span class="linenos">1320</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
<span class="linenos">1321</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">7e-2</span><span class="p">)),</span>
<span class="linenos">1322</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1323</span>                                                <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
<span class="linenos">1324</span>                                                <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
<span class="linenos">1325</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1326</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1.5e-1</span><span class="p">,</span>
<span class="linenos">1327</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span>
<span class="linenos">1328</span>                                <span class="p">),</span>
<span class="linenos">1329</span>                                <span class="p">)</span>
<span class="linenos">1330</span>
<span class="linenos">1331</span>        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
<span class="linenos">1332</span>            <span class="c1"># Inset with Strayfield</span>
<span class="linenos">1333</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">1334</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1335</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.38</span><span class="p">,</span> <span class="mf">.26</span><span class="p">,</span> <span class="mf">.26</span><span class="p">),</span>
<span class="linenos">1336</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1337</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1338</span>                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">1339</span>                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
<span class="linenos">1340</span>                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
<span class="linenos">1341</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1342</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1343</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1344</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="linenos">1345</span>                <span class="c1"># inset.set_xticks([-45+10*_ for _ in range(10)], minor=True)</span>
<span class="linenos">1346</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
<span class="linenos">1347</span>                           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
<span class="linenos">1348</span>                <span class="c1"># inset.set_xlabel(&#39;&#39;)</span>
<span class="linenos">1349</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos">1350</span>
<span class="linenos">1351</span>                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1352</span>                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1353</span>                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
<span class="linenos">1354</span>                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>
<span class="linenos">1355</span>
<span class="linenos">1356</span>        <span class="c1"># Inset showing fitted data</span>
<span class="linenos">1357</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
<span class="linenos">1358</span>            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1359</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.54</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1360</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1361</span>            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1362</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.3</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1363</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1364</span>
<span class="linenos">1365</span>            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1366</span>            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1367</span>                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
<span class="linenos">1368</span>                <span class="n">voltage</span> <span class="o">=</span> <span class="n">content</span>
<span class="linenos">1369</span>                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;voltage&#39;</span><span class="p">:</span> <span class="n">voltage</span><span class="p">,</span>
<span class="linenos">1370</span>                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
<span class="linenos">1371</span>                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">intercept</span><span class="p">}</span>
<span class="linenos">1372</span>
<span class="linenos">1373</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1374</span>                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1375</span>
<span class="linenos">1376</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current [$</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{A}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos">1377</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
<span class="linenos">1378</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos">1379</span>
<span class="linenos">1380</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current [$</span><span class="se">\\</span><span class="s1">mu</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{A}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos">1381</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
<span class="linenos">1382</span>
<span class="linenos">1383</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="linenos">1384</span>        <span class="k">return</span> <span class="n">i2data</span>
<span class="linenos">1385</span>
<span class="linenos">1386</span>    <span class="k">def</span> <span class="nf">compare_sweeprates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;compare-sweeprates&#39;</span><span class="p">,</span>
<span class="linenos">1387</span>                           <span class="n">show_inset</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos">1388</span>        <span class="sd">&quot;&quot;&quot;Compare different Sweeprates, fits the data and</span>
<span class="linenos">1389</span>
<span class="linenos">1390</span><span class="sd">        Returns:</span>
<span class="linenos">1391</span><span class="sd">            None.:</span>
<span class="linenos">1392</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1393</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1394</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1395</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="linenos">1396</span>
<span class="linenos">1397</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1398</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1399</span>            <span class="mi">382</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="linenos">1400</span>            <span class="mi">354</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="linenos">1401</span>            <span class="mi">351</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="linenos">1402</span>            <span class="mi">355</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span>
<span class="linenos">1403</span>            <span class="mi">353</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.25</span><span class="p">],</span>
<span class="linenos">1404</span>            <span class="mi">352</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">],</span>
<span class="linenos">1405</span>        <span class="p">}</span>
<span class="linenos">1406</span>
<span class="linenos">1407</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1408</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">%s</span><span class="se">\\</span><span class="s2">;</span><span class="se">\\</span><span class="s2">frac{</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">}{</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{min}</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1409</span>                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">1410</span>            <span class="p">),</span> <span class="p">{}]</span>
<span class="linenos">1411</span>
<span class="linenos">1412</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1413</span>                                <span class="c1"># fit_range=(2e-2, 5e-1),</span>
<span class="linenos">1414</span>                                <span class="c1"># show_fit=True,</span>
<span class="linenos">1415</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1416</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sweeprates (SR785)&#39;</span><span class="p">,</span>
<span class="linenos">1417</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1418</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">4e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)),</span>
<span class="linenos">1419</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1420</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
<span class="linenos">1421</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
<span class="linenos">1422</span>                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="linenos">1423</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1424</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1.5e-1</span><span class="p">,),</span>
<span class="linenos">1425</span>                                <span class="p">)</span>
<span class="linenos">1426</span>
<span class="linenos">1427</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="linenos">1428</span>        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
<span class="linenos">1429</span>            <span class="c1"># Inset with Strayfield</span>
<span class="linenos">1430</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">1431</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">1432</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.33</span><span class="p">),</span>
<span class="linenos">1433</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1434</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1435</span>                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">1436</span>                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span>  <span class="c1"># ($-M_S \\rightarrow +M_S$)&#39;,</span>
<span class="linenos">1437</span>                              <span class="s1">&#39;Down&#39;</span><span class="p">])</span>  <span class="c1"># ($+M_S \\rightarrow -M_S$)&#39;])</span>
<span class="linenos">1438</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1439</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1440</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1441</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="linenos">1442</span>
<span class="linenos">1443</span>                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1444</span>                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1445</span>                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
<span class="linenos">1446</span>                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>
<span class="linenos">1447</span>
<span class="linenos">1448</span>        <span class="c1"># Inset showing fitted data</span>
<span class="linenos">1449</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
<span class="linenos">1450</span>            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1451</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1452</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1453</span>
<span class="linenos">1454</span>            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1455</span>            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1456</span>                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
<span class="linenos">1457</span>                <span class="n">sweep_rate</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="linenos">1458</span>                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sweeprate&#39;</span><span class="p">:</span> <span class="n">sweep_rate</span><span class="p">,</span>
<span class="linenos">1459</span>                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
<span class="linenos">1460</span>                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">intercept</span><span class="p">}</span>
<span class="linenos">1461</span>
<span class="linenos">1462</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sweep_rate</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1463</span>
<span class="linenos">1464</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
<span class="linenos">1465</span>                <span class="s1">&#39;Sweeprate $</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{d}{dt}</span><span class="s1"> \mu_0 H_</span><span class="si">{ext}</span><span class="s1"> </span><span class="se">\\</span><span class="s1">left[</span><span class="se">\\</span><span class="s1">frac{</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">}{</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{min}</span><span class="s1">}</span><span class="se">\\</span><span class="s1">right]$&#39;</span><span class="p">)</span>
<span class="linenos">1466</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
<span class="linenos">1467</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos">1468</span>
<span class="linenos">1469</span>        <span class="c1"># Only save if necessary</span>
<span class="linenos">1470</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="linenos">1471</span>        <span class="k">return</span> <span class="n">i2data</span>
<span class="linenos">1472</span>
<span class="linenos">1473</span>    <span class="k">def</span> <span class="nf">fast_sweeprate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">320</span><span class="p">,</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">323</span><span class="p">,</span> <span class="mi">329</span><span class="p">,</span> <span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">1474</span>                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;FastSR-1&#39;</span><span class="p">,</span> <span class="n">pos2</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">1475</span>                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Huge </span><span class="se">\\</span><span class="s1">textbf{a) Large Field Sweeps}&#39;</span><span class="p">,</span>
<span class="linenos">1476</span>                       <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">1477</span>        <span class="sd">&quot;&quot;&quot;anas Fast Sweeps over large sweep ranges (1T)</span>
<span class="linenos">1478</span>
<span class="linenos">1479</span><span class="sd">        Args:</span>
<span class="linenos">1480</span><span class="sd">            show_numbers:</span>
<span class="linenos">1481</span><span class="sd">            xlim:</span>
<span class="linenos">1482</span><span class="sd">            filename (TYPE, optional): DESCRIPTION. The default is &#39;FastSR-1&#39;.</span>
<span class="linenos">1483</span><span class="sd">            pos2:</span>
<span class="linenos">1484</span><span class="sd">            title:</span>
<span class="linenos">1485</span>
<span class="linenos">1486</span><span class="sd">        Returns:</span>
<span class="linenos">1487</span><span class="sd">            None.:</span>
<span class="linenos">1488</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1489</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1490</span>            <span class="mi">320</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1491</span>            <span class="mi">321</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
<span class="linenos">1492</span>            <span class="mi">325</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1493</span>            <span class="mi">326</span><span class="p">:</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
<span class="linenos">1494</span>            <span class="mi">323</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1495</span>            <span class="mi">324</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
<span class="linenos">1496</span>            <span class="mi">329</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1497</span>            <span class="mi">322</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1498</span>            <span class="mi">327</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1499</span>            <span class="mi">328</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">],</span>
<span class="linenos">1500</span>            <span class="mi">336</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1501</span>            <span class="mi">333</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">.75</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1502</span>            <span class="mi">332</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">.3</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1503</span>            <span class="mi">331</span><span class="p">:</span> <span class="p">[(</span><span class="mf">.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.1</span><span class="p">),</span> <span class="s1">&#39;Crosses&#39;</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span>
<span class="linenos">1504</span>        <span class="p">}</span>
<span class="linenos">1505</span>
<span class="linenos">1506</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1507</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1508</span>            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">4.7</span><span class="p">:</span>
<span class="linenos">1509</span>                <span class="k">continue</span>
<span class="linenos">1510</span>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nr</span> <span class="ow">in</span> <span class="n">show_numbers</span><span class="p">):</span>
<span class="linenos">1511</span>                <span class="k">continue</span>
<span class="linenos">1512</span>            <span class="n">leg_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{</span><span class="si">%s</span><span class="s1">} $</span><span class="se">\\</span><span class="s1">;</span><span class="se">\\</span><span class="s1">mathbf{</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{T}</span><span class="s1">}$&#39;</span>
<span class="linenos">1513</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">leg_str</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1514</span>                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>   <span class="c1"># Structure</span>
<span class="linenos">1515</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="c1"># Field from</span>
<span class="linenos">1516</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="c1"># Field to</span>
<span class="linenos">1517</span>                <span class="c1"># content[2], # Sweeprate</span>
<span class="linenos">1518</span>            <span class="p">)</span>
<span class="linenos">1519</span>
<span class="linenos">1520</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span>
<span class="linenos">1521</span>                               <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
<span class="linenos">1522</span>                               <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
<span class="linenos">1523</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="linenos">1524</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lofm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1525</span>            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<span class="linenos">1526</span>            <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
<span class="linenos">1527</span>                <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos">1528</span>                                 <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1529</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">1530</span>                <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="linenos">1531</span>                                 <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1532</span>
<span class="linenos">1533</span>        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">),</span>
<span class="linenos">1534</span>                                       <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<span class="linenos">1535</span>                                       <span class="n">grid</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
<span class="linenos">1536</span>                                                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ffff99&#39;</span><span class="p">,</span>
<span class="linenos">1537</span>                                                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">))</span>
<span class="linenos">1538</span>        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">3e-2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">1539</span>                                   <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="linenos">1540</span>        <span class="c1"># self.eva[i]._draw_oneoverf(ax, xmin=1e-2, ymin=1e-6)</span>
<span class="linenos">1541</span>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
<span class="linenos">1542</span>                 <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
<span class="linenos">1543</span>
<span class="linenos">1544</span>        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
<span class="linenos">1545</span>            <span class="c1"># Inset with Strayfield</span>
<span class="linenos">1546</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">1547</span>                <span class="k">if</span> <span class="n">pos2</span><span class="p">:</span>
<span class="linenos">1548</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)</span>
<span class="linenos">1549</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos">1550</span>                    <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.32</span><span class="p">,</span> <span class="mf">.72</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)</span>
<span class="linenos">1551</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1552</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<span class="linenos">1553</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1554</span>
<span class="linenos">1555</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Crosses&#39;</span><span class="p">,</span>
<span class="linenos">1556</span>                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1557</span>                                       <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">1558</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1559</span>                <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span>
<span class="linenos">1560</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="linenos">1561</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos">1562</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="linenos">1563</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.45</span><span class="p">)</span>
<span class="linenos">1564</span>
<span class="linenos">1565</span>                <span class="k">if</span> <span class="n">pos2</span><span class="p">:</span>
<span class="linenos">1566</span>                    <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">300</span> <span class="o">+</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span>
<span class="linenos">1567</span>                                     <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1568</span>                    <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">[((</span><span class="mi">202</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">178</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">214</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">300</span><span class="p">),</span>
<span class="linenos">1569</span>                                      <span class="p">((</span><span class="mi">106</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">61</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">154</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">100</span><span class="p">)]:</span>
<span class="linenos">1570</span>                        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1571</span>                        <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span>
<span class="linenos">1572</span>                                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="linenos">1573</span>                <span class="c1"># inset.fill([-500, -500, 500, 500], [y1, y2, y2, y1], &#39;blue&#39;, alpha=.1)</span>
<span class="linenos">1574</span>                <span class="c1"># inset.annotate(&quot;&quot;, xy=(25, .35), xytext=(-25, .2),</span>
<span class="linenos">1575</span>                <span class="c1">#             arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&#39;blue&#39;))</span>
<span class="linenos">1576</span>
<span class="linenos">1577</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos">1578</span>
<span class="linenos">1579</span>    <span class="k">def</span> <span class="nf">sv_temp_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;sv-temp-effect&#39;</span><span class="p">,</span>
<span class="linenos">1580</span>                       <span class="n">show_inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">1581</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1582</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1583</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="linenos">1584</span>
<span class="linenos">1585</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1586</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1587</span>            <span class="mi">351</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="linenos">1588</span>            <span class="mi">355</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
<span class="linenos">1589</span>            <span class="mi">356</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="linenos">1590</span>            <span class="mi">357</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="linenos">1591</span>            <span class="mi">358</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="linenos">1592</span>            <span class="mi">359</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="linenos">1593</span>        <span class="p">}</span>
<span class="linenos">1594</span>
<span class="linenos">1595</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1596</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">;\mathrm</span><span class="si">{K}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1597</span>                <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span class="linenos">1598</span>            <span class="p">),</span> <span class="p">{}]</span>
<span class="linenos">1599</span>            <span class="c1"># self.eva[nr].Vx *= grad</span>
<span class="linenos">1600</span>
<span class="linenos">1601</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1602</span>                                <span class="c1"># fit_range=(2e-2, 7e-1),</span>
<span class="linenos">1603</span>                                <span class="c1"># show_fit=True,</span>
<span class="linenos">1604</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1605</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="c1">#Temperature Effect&#39;,</span>
<span class="linenos">1606</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1607</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)</span>
<span class="linenos">1608</span>                                <span class="p">),</span>
<span class="linenos">1609</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="linenos">1610</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1611</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">7e-2</span>
<span class="linenos">1612</span>                                <span class="p">)</span>
<span class="linenos">1613</span>                                <span class="p">)</span>
<span class="linenos">1614</span>
<span class="linenos">1615</span>        <span class="k">if</span> <span class="n">show_inset</span><span class="p">:</span>
<span class="linenos">1616</span>            <span class="c1"># Inset with Strayfield</span>
<span class="linenos">1617</span>            <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;deep&#39;</span><span class="p">):</span>
<span class="linenos">1618</span>                <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">1619</span>                                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.75</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1620</span>                                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1621</span>                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1622</span>                                       <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">1623</span>                <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span> <span class="s1">&#39;Down&#39;</span><span class="p">],</span>
<span class="linenos">1624</span>                             <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="linenos">1625</span>                <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1626</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1627</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1628</span>                <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos">1629</span>
<span class="linenos">1630</span>                <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1631</span>                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1632</span>                <span class="n">inset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.35</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">.2</span><span class="p">),</span>
<span class="linenos">1633</span>                               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>
<span class="linenos">1634</span>
<span class="linenos">1635</span>        <span class="c1"># Inset showing fitted data</span>
<span class="linenos">1636</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">):</span>
<span class="linenos">1637</span>            <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1638</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1639</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1640</span>            <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1641</span>                                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.09</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span>
<span class="linenos">1642</span>                                <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1643</span>
<span class="linenos">1644</span>            <span class="n">i2data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1645</span>            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1646</span>                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
<span class="linenos">1647</span>                <span class="n">temp</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos">1648</span>                <span class="n">i2data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">temp</span><span class="p">,</span>
<span class="linenos">1649</span>                              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span>
<span class="linenos">1650</span>                              <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">}</span>
<span class="linenos">1651</span>
<span class="linenos">1652</span>                <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1653</span>                <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="o">-</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1654</span>
<span class="linenos">1655</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$\mathrm</span><span class="si">{K}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos">1656</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
<span class="linenos">1657</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos">1658</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1659</span>
<span class="linenos">1660</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [$\mathrm</span><span class="si">{K}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos">1661</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
<span class="linenos">1662</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1663</span>
<span class="linenos">1664</span>        <span class="c1"># Only save if necessary</span>
<span class="linenos">1665</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="linenos">1666</span>        <span class="k">return</span> <span class="n">i2data</span>
<span class="linenos">1667</span>
<span class="linenos">1668</span>    <span class="k">def</span> <span class="nf">multiple_fspans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;multiple-fspans&#39;</span><span class="p">):</span>
<span class="linenos">1669</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1670</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1671</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
<span class="linenos">1672</span>
<span class="linenos">1673</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1674</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1675</span>            <span class="mi">340</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1676</span>            <span class="mi">349</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1677</span>            <span class="mi">338</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1678</span>            <span class="mi">342</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25 </span><span class="se">\\</span><span class="s2">rightarrow 8.3&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1679</span>                  <span class="o">+</span><span class="mf">0.11</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1680</span>            <span class="mi">343</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow -25 </span><span class="se">\\</span><span class="s2">rightarrow -8.3&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1681</span>                  <span class="mf">0.11</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}],</span>
<span class="linenos">1682</span>        <span class="p">}</span>
<span class="linenos">1683</span>
<span class="linenos">1684</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1685</span>            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
<span class="linenos">1686</span>                <span class="k">continue</span>
<span class="linenos">1687</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">$ mT </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{mT}{min}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1688</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">1689</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1690</span>                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1691</span>                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">1692</span>            <span class="p">),</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="linenos">1693</span>
<span class="linenos">1694</span>        <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1695</span>                      <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1696</span>                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps ($B = </span><span class="se">\\</span><span class="s1">pm 25 mT$)&#39;</span><span class="p">,</span>
<span class="linenos">1697</span>                          <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-3</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1698</span>                          <span class="c1"># ylim=()</span>
<span class="linenos">1699</span>                      <span class="p">),</span>
<span class="linenos">1700</span>                      <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1701</span>                                      <span class="n">xmin</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span>
<span class="linenos">1702</span>                                      <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
<span class="linenos">1703</span>                      <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1704</span>                          <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="p">)</span>
<span class="linenos">1705</span>                      <span class="p">)</span>
<span class="linenos">1706</span>
<span class="linenos">1707</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="linenos">1708</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Dark2&#39;</span><span class="p">):</span>
<span class="linenos">1709</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">1710</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.44</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span>
<span class="linenos">1711</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1712</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1713</span>                                   <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">1714</span>                                   <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1715</span>            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up&#39;</span><span class="p">,</span> <span class="s1">&#39;Down&#39;</span><span class="p">])</span>
<span class="linenos">1716</span>            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1717</span>            <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span>
<span class="linenos">1718</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos">1719</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1720</span>            <span class="n">s</span> <span class="o">=</span> <span class="mi">20</span>
<span class="linenos">1721</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="linenos">1722</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="n">s</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1723</span>
<span class="linenos">1724</span>            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1725</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="linenos">1726</span>                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
<span class="linenos">1727</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
<span class="linenos">1728</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.3</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
<span class="linenos">1729</span>                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">)</span>
<span class="linenos">1730</span>            <span class="c1"># inset.plot([8.3, 8.3], [y1, y2], &#39;b-.&#39;, alpha=.8)</span>
<span class="linenos">1731</span>
<span class="linenos">1732</span>        <span class="c1"># Only save if necessary</span>
<span class="linenos">1733</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="linenos">1734</span>
<span class="linenos">1735</span>    <span class="k">def</span> <span class="nf">negative_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">1736</span>        <span class="sd">&quot;&quot;&quot;Testing without file output.</span>
<span class="linenos">1737</span>
<span class="linenos">1738</span><span class="sd">        Returns:</span>
<span class="linenos">1739</span><span class="sd">            None.:</span>
<span class="linenos">1740</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1741</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1742</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1743</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
<span class="linenos">1744</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1745</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1746</span>            <span class="mi">340</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1747</span>            <span class="mi">338</span><span class="p">:</span> <span class="p">[(</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1748</span>            <span class="mi">348</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow 36.56&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">),</span> <span class="s1">&#39;Empty&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1749</span>            <span class="mi">347</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow 36.56&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1750</span>        <span class="p">}</span>
<span class="linenos">1751</span>
<span class="linenos">1752</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1753</span>            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
<span class="linenos">1754</span>                <span class="k">continue</span>
<span class="linenos">1755</span>            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos">1756</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">$ mT </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{mT}{min}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1757</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">1758</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1759</span>                <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1760</span>                <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">1761</span>            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>
<span class="linenos">1762</span>
<span class="linenos">1763</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1764</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1765</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (measurement Plan \#2)&#39;</span><span class="p">,</span>
<span class="linenos">1766</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">6e-3</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1767</span>                                    <span class="c1"># ylim=()</span>
<span class="linenos">1768</span>                                <span class="p">),</span>
<span class="linenos">1769</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1770</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">6e-3</span><span class="p">,</span>
<span class="linenos">1771</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>
<span class="linenos">1772</span>
<span class="linenos">1773</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;muted&#39;</span><span class="p">):</span>
<span class="linenos">1774</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">1775</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.28</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
<span class="linenos">1776</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1777</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1778</span>            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
<span class="linenos">1779</span>                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
<span class="linenos">1780</span>            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1781</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1782</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1783</span>
<span class="linenos">1784</span>            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1785</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1786</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mf">291.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">291.13</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">,</span> <span class="mf">36.56</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span>
<span class="linenos">1787</span>                       <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1788</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">611</span><span class="p">,</span> <span class="o">-</span><span class="mi">611</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos">1789</span>                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1790</span>            <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="o">-</span><span class="mi">291</span><span class="p">,</span> <span class="o">-</span><span class="mi">291</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">,</span> <span class="o">-</span><span class="mi">443</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
<span class="linenos">1791</span>                       <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="linenos">1792</span>
<span class="linenos">1793</span>    <span class="k">def</span> <span class="nf">measplan12</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">1794</span>        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="linenos">1795</span>        <span class="c1"># sns.color_palette(&quot;Reds_r&quot;, 14)</span>
<span class="linenos">1796</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1797</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1798</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="linenos">1799</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="linenos">1800</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1801</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1802</span>            <span class="mi">383</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1803</span>            <span class="mi">384</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">1804</span>                  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
<span class="linenos">1805</span>        <span class="p">}</span>
<span class="linenos">1806</span>
<span class="linenos">1807</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
<span class="linenos">1808</span>            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<span class="linenos">1809</span>                <span class="p">{</span>
<span class="linenos">1810</span>                    <span class="p">(</span><span class="mi">385</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)),</span>
<span class="linenos">1811</span>                                 <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1812</span>                <span class="p">}</span>
<span class="linenos">1813</span>            <span class="p">)</span>
<span class="linenos">1814</span>
<span class="linenos">1815</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1816</span>            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
<span class="linenos">1817</span>                <span class="k">continue</span>
<span class="linenos">1818</span>            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos">1819</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1820</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">1821</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1822</span>            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>
<span class="linenos">1823</span>
<span class="linenos">1824</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1825</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1826</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses $0.5\;\mathrm</span><span class="si">{mT}</span><span class="s1">/\mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
<span class="linenos">1827</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1828</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">3e-3</span><span class="p">,</span> <span class="mf">6e-7</span><span class="p">)</span>
<span class="linenos">1829</span>                                <span class="p">),</span>
<span class="linenos">1830</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1831</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
<span class="linenos">1832</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">),</span>
<span class="linenos">1833</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
<span class="linenos">1834</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
<span class="linenos">1835</span>                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
<span class="linenos">1836</span>                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
<span class="linenos">1837</span>                                <span class="p">),</span>
<span class="linenos">1838</span>                                <span class="p">)</span>
<span class="linenos">1839</span>
<span class="linenos">1840</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="linenos">1841</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
<span class="linenos">1842</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">1843</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
<span class="linenos">1844</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1845</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1846</span>            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
<span class="linenos">1847</span>                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
<span class="linenos">1848</span>            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1849</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1850</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1851</span>
<span class="linenos">1852</span>            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1853</span>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
<span class="linenos">1854</span>                    <span class="mi">5</span><span class="p">)]:</span>  <span class="c1"># + [-300-50*i for i in range(5)] + [-575]:</span>
<span class="linenos">1855</span>                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1856</span>            <span class="c1"># for j in [-300-50*i for i in range(5)] + [-575]:</span>
<span class="linenos">1857</span>            <span class="c1">#    inset.fill([j, j, j-50, j-50], [y1, y2, y2, y1], alpha=.4)</span>
<span class="linenos">1858</span>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Without Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2e-2</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos">1859</span>                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">)</span>
<span class="linenos">1860</span>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;With Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.01e-2</span><span class="p">,</span> <span class="mf">.8e-3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
<span class="linenos">1861</span>                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">37</span><span class="p">)</span>
<span class="linenos">1862</span>
<span class="linenos">1863</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;self.measplan12-1.pdf&#39;</span><span class="p">)</span>
<span class="linenos">1864</span>
<span class="linenos">1865</span>    <span class="k">def</span> <span class="nf">measplan12_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">1866</span>        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="linenos">1867</span>        <span class="c1"># sns.color_palette(&quot;Reds_r&quot;, 14)</span>
<span class="linenos">1868</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1869</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1870</span>                               <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="linenos">1871</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="linenos">1872</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1873</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1874</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">_</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]):</span>
<span class="linenos">1875</span>            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<span class="linenos">1876</span>                <span class="p">{</span>
<span class="linenos">1877</span>                    <span class="p">(</span><span class="mi">391</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span>
<span class="linenos">1878</span>                                <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1879</span>                <span class="p">}</span>
<span class="linenos">1880</span>            <span class="p">)</span>
<span class="linenos">1881</span>
<span class="linenos">1882</span>        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">625</span>
<span class="linenos">1883</span>        <span class="n">to_show</span><span class="p">[</span><span class="mi">397</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1884</span>                        <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}]</span>
<span class="linenos">1885</span>
<span class="linenos">1886</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1887</span>            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
<span class="linenos">1888</span>                <span class="k">continue</span>
<span class="linenos">1889</span>            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos">1890</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1891</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">1892</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1893</span>            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>
<span class="linenos">1894</span>
<span class="linenos">1895</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1896</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1897</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses $0.5\;\mathrm</span><span class="si">{mT}</span><span class="s1">/\mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
<span class="linenos">1898</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1899</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-4</span><span class="p">,</span> <span class="mf">2e-7</span><span class="p">)</span>
<span class="linenos">1900</span>                                <span class="p">),</span>
<span class="linenos">1901</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1902</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
<span class="linenos">1903</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">),</span>
<span class="linenos">1904</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
<span class="linenos">1905</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
<span class="linenos">1906</span>                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
<span class="linenos">1907</span>                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
<span class="linenos">1908</span>                                    <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1909</span>                                <span class="p">),</span>
<span class="linenos">1910</span>                                <span class="p">)</span>
<span class="linenos">1911</span>
<span class="linenos">1912</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
<span class="linenos">1913</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
<span class="linenos">1914</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="mf">.29</span><span class="p">,</span> <span class="mf">.24</span><span class="p">),</span>
<span class="linenos">1915</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1916</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span> <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span> <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1917</span>            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Up ($-M_S </span><span class="se">\\</span><span class="s1">rightarrow +M_S$)&#39;</span><span class="p">,</span>
<span class="linenos">1918</span>                          <span class="s1">&#39;Down ($+M_S </span><span class="se">\\</span><span class="s1">rightarrow -M_S$)&#39;</span><span class="p">])</span>
<span class="linenos">1919</span>            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1920</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">1921</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">1922</span>
<span class="linenos">1923</span>            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">1924</span>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">300</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]:</span>
<span class="linenos">1925</span>                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">1926</span>
<span class="linenos">1927</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;self.measplan12-2.pdf&#39;</span><span class="p">)</span>
<span class="linenos">1928</span>
<span class="linenos">1929</span>    <span class="k">def</span> <span class="nf">measplan12_full</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;measplan12-full&#39;</span><span class="p">):</span>
<span class="linenos">1930</span>        <span class="sd">&quot;&quot;&quot;measurement Plan #12 All 14 measurements in one Graph.</span>
<span class="linenos">1931</span>
<span class="linenos">1932</span><span class="sd">        Args:</span>
<span class="linenos">1933</span><span class="sd">            name:</span>
<span class="linenos">1934</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">1935</span>        <span class="c1"># c1 = sns.color_palette(&quot;twilight&quot;, 14)</span>
<span class="linenos">1936</span>        <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="linenos">1937</span>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">1938</span>                               <span class="n">size</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">1939</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="linenos">1940</span>
<span class="linenos">1941</span>        <span class="c1"># Choosing measurement Numbers to plot</span>
<span class="linenos">1942</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">1943</span>        <span class="n">to_show</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">1944</span>            <span class="mi">383</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow 25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1945</span>            <span class="mi">384</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">1946</span>                  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">}],</span>
<span class="linenos">1947</span>        <span class="p">}</span>
<span class="linenos">1948</span>
<span class="linenos">1949</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
<span class="linenos">1950</span>            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<span class="linenos">1951</span>                <span class="p">{</span>
<span class="linenos">1952</span>                    <span class="p">(</span><span class="mi">385</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)),</span>
<span class="linenos">1953</span>                                 <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1954</span>                <span class="p">}</span>
<span class="linenos">1955</span>            <span class="p">)</span>
<span class="linenos">1956</span>
<span class="linenos">1957</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">_</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]):</span>
<span class="linenos">1958</span>            <span class="n">to_show</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<span class="linenos">1959</span>                <span class="p">{</span>
<span class="linenos">1960</span>                    <span class="p">(</span><span class="mi">391</span> <span class="o">+</span> <span class="n">i</span><span class="p">):</span> <span class="p">[(</span><span class="s2">&quot;+M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)),</span>
<span class="linenos">1961</span>                                <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}],</span>
<span class="linenos">1962</span>                <span class="p">}</span>
<span class="linenos">1963</span>            <span class="p">)</span>
<span class="linenos">1964</span>
<span class="linenos">1965</span>        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">625</span>
<span class="linenos">1966</span>        <span class="n">to_show</span><span class="p">[</span><span class="mi">397</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;-M_s </span><span class="se">\\</span><span class="s2">rightarrow </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)),</span> <span class="s1">&#39;Plusses&#39;</span><span class="p">,</span>
<span class="linenos">1967</span>                        <span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">{}]</span>
<span class="linenos">1968</span>
<span class="linenos">1969</span>        <span class="c1"># Converting them to a list of measurements (lofm)</span>
<span class="linenos">1970</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">1971</span>            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">9.4</span><span class="p">:</span>
<span class="linenos">1972</span>                <span class="k">continue</span>
<span class="linenos">1973</span>            <span class="n">options</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos">1974</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1"> </span><span class="se">\\</span><span class="s1">rightarrow </span><span class="si">%s</span><span class="s1">\;\mathrm</span><span class="si">{mT}</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">1975</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">1976</span>                <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">1977</span>            <span class="p">),</span> <span class="n">options</span><span class="p">]</span>
<span class="linenos">1978</span>
<span class="linenos">1979</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eva</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lofm</span><span class="p">,</span>
<span class="linenos">1980</span>                                <span class="n">plot_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1981</span>                                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^</span><span class="se">\\</span><span class="s1">circ$) Field Sweeps (Plusses;&#39;</span> <span class="o">+</span> \
<span class="linenos">1982</span>                                          <span class="s1">&#39; $</span><span class="se">\\</span><span class="s1">Delta B = 50</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$;&#39;</span> <span class="o">+</span> \
<span class="linenos">1983</span>                                          <span class="s1">&#39; $0.5</span><span class="se">\\</span><span class="s1">;</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{min}</span><span class="s1">$)&#39;</span><span class="p">,</span>
<span class="linenos">1984</span>                                    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1.6e0</span><span class="p">),</span>
<span class="linenos">1985</span>                                    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">5e-2</span><span class="p">,</span> <span class="mf">5e-8</span><span class="p">),</span>
<span class="linenos">1986</span>                                    <span class="n">legend_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">1987</span>                                <span class="p">),</span>
<span class="linenos">1988</span>                                <span class="n">f_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">1989</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
<span class="linenos">1990</span>                                    <span class="n">ymin</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">),</span>
<span class="linenos">1991</span>                                <span class="n">f2_settings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>  <span class="c1"># disable=True</span>
<span class="linenos">1992</span>                                    <span class="n">xmin</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
<span class="linenos">1993</span>                                    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span>
<span class="linenos">1994</span>                                    <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
<span class="linenos">1995</span>                                <span class="p">),</span>
<span class="linenos">1996</span>                                <span class="p">)</span>
<span class="linenos">1997</span>
<span class="linenos">1998</span>        <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">):</span>
<span class="linenos">1999</span>            <span class="n">inset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">2000</span>                               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.07</span><span class="p">,</span> <span class="mf">.06</span><span class="p">,</span> <span class="mf">.34</span><span class="p">,</span> <span class="mf">.26</span><span class="p">),</span>
<span class="linenos">2001</span>                               <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">2002</span>            <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">inset</span><span class="p">,</span>
<span class="linenos">2003</span>                                   <span class="s1">&#39;Strayfield Plusses&#39;</span><span class="p">,</span>
<span class="linenos">2004</span>                                   <span class="n">show_plusses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">2005</span>                                   <span class="n">show_crosses</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">2006</span>                                   <span class="n">nolegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">2007</span>
<span class="linenos">2008</span>            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="linenos">2009</span>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span> <span class="o">+</span> \
<span class="linenos">2010</span>                     <span class="p">[</span><span class="o">-</span><span class="mi">300</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">575</span><span class="p">]:</span>
<span class="linenos">2011</span>                <span class="n">inset</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="linenos">2012</span>
<span class="linenos">2013</span>            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span>
<span class="linenos">2014</span>                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up&#39;</span><span class="p">)</span>
<span class="linenos">2015</span>            <span class="n">inset</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
<span class="linenos">2016</span>                       <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down&#39;</span><span class="p">)</span>
<span class="linenos">2017</span>
<span class="linenos">2018</span>            <span class="n">inset</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos">2019</span>
<span class="linenos">2020</span>            <span class="n">inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>
<span class="linenos">2021</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">650</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="linenos">2022</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">.65</span><span class="p">,</span> <span class="mf">.45</span><span class="p">)</span>
<span class="linenos">2023</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos">2024</span>            <span class="n">inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos">2025</span>
<span class="linenos">2026</span>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Without Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.2e-2</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos">2027</span>                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">)</span>
<span class="linenos">2028</span>        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;With Saturation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.01e-2</span><span class="p">,</span> <span class="mf">4e-4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos">2029</span>                    <span class="n">rotation</span><span class="o">=-</span><span class="mi">35</span><span class="p">)</span>
<span class="linenos">2030</span>
<span class="linenos">2031</span>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.pdf&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
<span class="linenos">2032</span>
<span class="linenos">2033</span>    <span class="k">def</span> <span class="nf">set_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width_pt</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
<span class="linenos">2034</span>        <span class="sd">&quot;&quot;&quot;Set figure dimensions to sit nicely in our document.</span>
<span class="linenos">2035</span><span class="sd">        </span>
<span class="linenos">2036</span><span class="sd">        Source: https://jwalton.info/Matplotlib-latex-PGF/</span>
<span class="linenos">2037</span>
<span class="linenos">2038</span><span class="sd">        Parameters</span>
<span class="linenos">2039</span><span class="sd">        ----------</span>
<span class="linenos">2040</span><span class="sd">        width_pt: float</span>
<span class="linenos">2041</span><span class="sd">                Document width in points</span>
<span class="linenos">2042</span><span class="sd">        fraction: float, optional</span>
<span class="linenos">2043</span><span class="sd">                Fraction of the width which you wish the figure to occupy</span>
<span class="linenos">2044</span><span class="sd">        subplots: array-like, optional</span>
<span class="linenos">2045</span><span class="sd">                The number of rows and columns of subplots.</span>
<span class="linenos">2046</span><span class="sd">        Returns</span>
<span class="linenos">2047</span><span class="sd">        -------</span>
<span class="linenos">2048</span><span class="sd">        fig_dim: tuple</span>
<span class="linenos">2049</span><span class="sd">                Dimensions of figure in inches</span>
<span class="linenos">2050</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">2051</span>        <span class="c1"># Width of figure (in pts)</span>
<span class="linenos">2052</span>        <span class="n">fig_width_pt</span> <span class="o">=</span> <span class="n">width_pt</span> <span class="o">*</span> <span class="n">fraction</span>
<span class="linenos">2053</span>        <span class="c1"># Convert from pt to inches</span>
<span class="linenos">2054</span>        <span class="n">inches_per_pt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">72.27</span>
<span class="linenos">2055</span>
<span class="linenos">2056</span>        <span class="c1"># Golden ratio to set aesthetic figure height</span>
<span class="linenos">2057</span>        <span class="n">golden_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">**</span> <span class="mf">.5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="linenos">2058</span>
<span class="linenos">2059</span>        <span class="c1"># Figure width in inches</span>
<span class="linenos">2060</span>        <span class="n">fig_width_in</span> <span class="o">=</span> <span class="n">fig_width_pt</span> <span class="o">*</span> <span class="n">inches_per_pt</span>
<span class="linenos">2061</span>        <span class="c1"># Figure height in inches</span>
<span class="linenos">2062</span>        <span class="n">fig_height_in</span> <span class="o">=</span> <span class="n">fig_width_in</span> <span class="o">*</span> <span class="n">golden_ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">subplots</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos">2063</span>
<span class="linenos">2064</span>        <span class="k">return</span> <span class="p">(</span><span class="n">fig_width_in</span><span class="p">,</span> <span class="n">fig_height_in</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id28">
<h3><a class="toc-backref" href="#id65" role="doc-backlink">HandleM</a><a class="headerlink" href="#id28" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">class</span> <span class="nc">HandleM</span><span class="p">(</span><span class="n">MultipleM</span><span class="p">):</span>
<span class="linenos">  2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  3</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  4</span><span class="sd">        Args:</span>
<span class="linenos">  5</span><span class="sd">            args:</span>
<span class="linenos">  6</span><span class="sd">            kwargs:</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="sd">        Note:</span>
<span class="linenos">  9</span><span class="sd">            **Measurement Handler:** This class represents all other</span>
<span class="linenos"> 10</span><span class="sd">            measurements and is the interface to other measurement objets.</span>
<span class="linenos"> 11</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 12</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 13</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Handle&#39;</span><span class="p">)</span>
<span class="linenos"> 14</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 15</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 16</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 17</span>        <span class="bp">self</span><span class="o">.</span><span class="n">sa_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 18</span>        <span class="bp">self</span><span class="o">.</span><span class="n">hloop_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 19</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">):</span>
<span class="linenos"> 20</span>            <span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="linenos"> 21</span>            <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<span class="linenos"> 22</span>                <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<span class="linenos"> 23</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">_process_data</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]))</span>
<span class="linenos"> 24</span>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 25</span>        <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;directory&#39;</span><span class="p">):</span>
<span class="linenos"> 26</span>            <span class="bp">self</span><span class="o">.</span><span class="n">load_files</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;directory&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="linenos"> 29</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 30</span><span class="sd">        Args:</span>
<span class="linenos"> 31</span><span class="sd">            key:</span>
<span class="linenos"> 32</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 33</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="linenos"> 34</span>            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
<span class="linenos"> 35</span>                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<span class="linenos"> 36</span>                <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
<span class="linenos"> 37</span>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Measurement Nr. </span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
<span class="linenos"> 38</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 39</span>                    <span class="k">return</span> <span class="n">d</span>
<span class="linenos"> 40</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 41</span>            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="linenos"> 42</span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
<span class="linenos"> 43</span>                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Measurement Nr. </span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
<span class="linenos"> 44</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 45</span>                <span class="k">return</span> <span class="n">d</span>
<span class="linenos"> 46</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Nr == </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="linenos"> 49</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 50</span><span class="sd">        Args:</span>
<span class="linenos"> 51</span><span class="sd">            key:</span>
<span class="linenos"> 52</span><span class="sd">            val:</span>
<span class="linenos"> 53</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 54</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Setting Items is not allowed.&quot;</span><span class="p">)</span>
<span class="linenos"> 55</span>        <span class="k">return</span>
<span class="linenos"> 56</span>
<span class="linenos"> 57</span>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="linenos"> 58</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 59</span><span class="sd">        Args:</span>
<span class="linenos"> 60</span><span class="sd">            key:</span>
<span class="linenos"> 61</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 62</span>        <span class="k">return</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span>    <span class="k">def</span> <span class="nf">load_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 65</span>        <span class="sd">&quot;&quot;&quot;Loads all files from a specific directory and creates objects for</span>
<span class="linenos"> 66</span><span class="sd">        found measurements.</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span><span class="sd">        Args:</span>
<span class="linenos"> 69</span><span class="sd">            directory (str): directory to search in</span>
<span class="linenos"> 70</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 71</span>
<span class="linenos"> 72</span><span class="sd">        Returns:</span>
<span class="linenos"> 73</span><span class="sd">            None</span>
<span class="linenos"> 74</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 75</span>        <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;**/*.dat&#39;</span><span class="p">]),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 76</span>        <span class="k">if</span> <span class="n">file_list</span><span class="p">:</span>
<span class="linenos"> 77</span>            <span class="bp">self</span><span class="o">.</span><span class="n">load_folder</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 78</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 79</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No Files found: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">file_list</span><span class="p">)</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span>    <span class="k">def</span> <span class="nf">get_custom_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;RAW&#39;</span><span class="p">,</span>
<span class="linenos"> 82</span>                          <span class="n">instruments</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos"> 83</span>        <span class="sd">&quot;&quot;&quot;Help Function to get column names for EVE Measurements.</span>
<span class="linenos"> 84</span>
<span class="linenos"> 85</span><span class="sd">        Args:</span>
<span class="linenos"> 86</span><span class="sd">            kind (str, optional): Kind of measurement, default: &#39;RAW&#39;</span>
<span class="linenos"> 87</span><span class="sd">            instruments (list, optional): Used instruments in order of</span>
<span class="linenos"> 88</span><span class="sd">                appearance, default: [&#39;t&#39;, &#39;LS&#39;, &#39;IPS&#39;, &#39;SR830&#39;]</span>
<span class="linenos"> 89</span>
<span class="linenos"> 90</span><span class="sd">        Returns:</span>
<span class="linenos"> 91</span><span class="sd">            tuple: (list header, int skiprows)</span>
<span class="linenos"> 92</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 93</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">instruments</span><span class="p">:</span>
<span class="linenos"> 94</span>            <span class="n">instruments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;IPS&#39;</span><span class="p">,</span> <span class="s1">&#39;SR830&#39;</span><span class="p">]</span>
<span class="linenos"> 95</span>
<span class="linenos"> 96</span>        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;RAW&#39;</span><span class="p">:</span>
<span class="linenos"> 97</span>            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s2">&quot;Vx&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy&quot;</span><span class="p">],</span> <span class="mi">0</span>
<span class="linenos"> 98</span>        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;SA&#39;</span><span class="p">:</span>
<span class="linenos"> 99</span>            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vy&#39;</span><span class="p">],</span> <span class="mi">6</span>
<span class="linenos">100</span>
<span class="linenos">101</span>        <span class="n">def_skiprows</span> <span class="o">=</span> <span class="mi">3</span>
<span class="linenos">102</span>        <span class="n">def_header</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">103</span>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">instruments</span><span class="p">:</span>
<span class="linenos">104</span>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
<span class="linenos">105</span>                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="linenos">106</span>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;LS&#39;</span><span class="p">:</span>
<span class="linenos">107</span>                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Temp</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="linenos">108</span>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;IPS&#39;</span><span class="p">:</span>
<span class="linenos">109</span>                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="linenos">110</span>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;SR830&#39;</span><span class="p">:</span>
<span class="linenos">111</span>                <span class="n">def_header</span> <span class="o">+=</span> <span class="p">[</span>
<span class="linenos">112</span>                    <span class="s2">&quot;Vx&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth&quot;</span><span class="p">,</span>
<span class="linenos">113</span>                    <span class="c1">#                   [&quot;V%s%d&quot; % (var, gpib) for gpib in [8, 9, 13]</span>
<span class="linenos">114</span>                    <span class="c1">#                   for var in [&#39;x&#39;, &#39;y&#39;, &#39;r&#39;, &#39;th&#39;,]]</span>
<span class="linenos">115</span>                <span class="p">]</span>
<span class="linenos">116</span>        <span class="k">return</span> <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span>
<span class="linenos">117</span>
<span class="linenos">118</span>    <span class="k">def</span> <span class="nf">load_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">119</span>
<span class="linenos">120</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">121</span><span class="sd">        Args:</span>
<span class="linenos">122</span><span class="sd">            file_list:</span>
<span class="linenos">123</span><span class="sd">            **kwargs:</span>
<span class="linenos">124</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">125</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Start loading folder: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">file_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos">126</span>        <span class="n">d_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="linenos">127</span>
<span class="linenos">128</span>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
<span class="linenos">129</span>            <span class="n">directory</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="linenos">130</span>            <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
<span class="linenos">131</span>                <span class="s1">&#39;(.*)[mM]([0-9.]+)(.*)([Pp]lusses|[Cc]rosses|[Ee]mpty)(.*).dat&#39;</span><span class="p">,</span>
<span class="linenos">132</span>                <span class="n">filename</span><span class="p">)</span>
<span class="linenos">133</span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">regex</span><span class="p">:</span>
<span class="linenos">134</span>                <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(.*)[mM]([0-9.]+)(.*).dat&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="linenos">135</span>                <span class="k">if</span> <span class="ow">not</span> <span class="n">regex</span><span class="p">:</span>
<span class="linenos">136</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Regex doesn&#39;t match: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
<span class="linenos">137</span>                    <span class="k">continue</span>
<span class="linenos">138</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos">139</span>                    <span class="n">folder</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">add_info</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="linenos">140</span>                    <span class="n">struct</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos">141</span>                    <span class="n">m_type</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
<span class="linenos">142</span>                    <span class="n">struct</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
<span class="linenos">143</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">144</span>                <span class="n">folder</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">m_type</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">add_info</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="linenos">145</span>
<span class="linenos">146</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos">147</span>                <span class="n">nr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos">148</span>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="linenos">149</span>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Not a valid Measurement Nr. (</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nr</span> <span class="o">+</span> \
<span class="linenos">150</span>                                  <span class="s1">&#39;Debug kind/struct/f (</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">151</span>                                      <span class="n">m_type</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
<span class="linenos">152</span>                <span class="k">continue</span>
<span class="linenos">153</span>
<span class="linenos">154</span>            <span class="k">if</span> <span class="n">nr</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
<span class="linenos">155</span>                <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos">156</span>                <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_custom_header</span><span class="p">(</span><span class="s1">&#39;SA&#39;</span><span class="p">)</span>
<span class="linenos">157</span>            <span class="k">elif</span> <span class="s1">&#39;SR830&#39;</span> <span class="ow">in</span> <span class="n">add_info</span><span class="p">:</span>
<span class="linenos">158</span>                <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_custom_header</span><span class="p">(</span><span class="s1">&#39;RAW&#39;</span><span class="p">)</span>
<span class="linenos">159</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">160</span>                <span class="n">def_header</span><span class="p">,</span> <span class="n">def_skiprows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_custom_header</span><span class="p">(</span>
<span class="linenos">161</span>                    <span class="n">instruments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;IPS&#39;</span><span class="p">,</span> <span class="s1">&#39;SR830&#39;</span><span class="p">])</span>
<span class="linenos">162</span>
<span class="linenos">163</span>            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sep&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="linenos">164</span>                               <span class="c1"># header=kwargs.get(&#39;header&#39;, def_header_index),</span>
<span class="linenos">165</span>                               <span class="n">names</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="n">def_header</span><span class="p">),</span>
<span class="linenos">166</span>                               <span class="n">skiprows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skiprows&#39;</span><span class="p">,</span> <span class="n">def_skiprows</span><span class="p">))</span>
<span class="linenos">167</span>
<span class="linenos">168</span>            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span> <span class="o">==</span> <span class="n">nr</span><span class="p">:</span>
<span class="linenos">169</span>                <span class="n">nr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos">170</span>                <span class="n">subnr</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos">171</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">172</span>                <span class="n">i</span><span class="p">,</span> <span class="n">subnr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="linenos">173</span>
<span class="linenos">174</span>            <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span>
<span class="linenos">175</span>                    <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">nr</span><span class="p">,</span>
<span class="linenos">176</span>                    <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">177</span>                    <span class="s1">&#39;folder&#39;</span><span class="p">:</span> <span class="n">folder</span><span class="p">,</span>
<span class="linenos">178</span>                    <span class="s1">&#39;technique&#39;</span><span class="p">:</span> <span class="n">m_type</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">),</span>
<span class="linenos">179</span>                    <span class="s1">&#39;Structure&#39;</span><span class="p">:</span> <span class="n">struct</span><span class="p">,</span>
<span class="linenos">180</span>                    <span class="s1">&#39;Additional&#39;</span><span class="p">:</span> <span class="n">add_info</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)}</span>
<span class="linenos">181</span>            <span class="k">if</span> <span class="n">subnr</span><span class="p">:</span>
<span class="linenos">182</span>                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;RAW&#39;</span>
<span class="linenos">183</span>                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;subnr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subnr</span>
<span class="linenos">184</span>
<span class="linenos">185</span>            <span class="n">d_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_data</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">))</span>
<span class="linenos">186</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;drop_unused_columns&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
<span class="linenos">187</span>                <span class="k">if</span> <span class="s1">&#39;Temp0&#39;</span> <span class="ow">in</span> <span class="n">def_header</span><span class="p">:</span>
<span class="linenos">188</span>                    <span class="n">d_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
<span class="linenos">189</span>                        <span class="p">[</span><span class="s2">&quot;Temp</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span> <span class="o">+</span> \
<span class="linenos">190</span>                        <span class="p">[</span><span class="s2">&quot;Vr&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth&quot;</span><span class="p">],</span>
<span class="linenos">191</span>                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos">192</span>                    <span class="p">)</span>
<span class="linenos">193</span>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="n">d_dict</span><span class="p">)</span>
<span class="linenos">194</span>
<span class="linenos">195</span>    <span class="k">def</span> <span class="nf">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">196</span>        <span class="sd">&quot;&quot;&quot;imports data and sets info variable.</span>
<span class="linenos">197</span>
<span class="linenos">198</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">199</span>
<span class="linenos">200</span><span class="sd">           h.parse_data({&#39;data&#39;: pd.DataFrame,</span>
<span class="linenos">201</span><span class="sd">               &#39;info&#39;: dict(Nr=0, ** kw) })</span>
<span class="linenos">202</span>
<span class="linenos">203</span><span class="sd">        Args:</span>
<span class="linenos">204</span><span class="sd">            data (dict): Data to parse</span>
<span class="linenos">205</span><span class="sd">            **kwargs:</span>
<span class="linenos">206</span>
<span class="linenos">207</span><span class="sd">        Returns:</span>
<span class="linenos">208</span><span class="sd">            None</span>
<span class="linenos">209</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">210</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Start parsing data: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="linenos">211</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">212</span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">):</span>
<span class="linenos">213</span>                <span class="k">continue</span>
<span class="linenos">214</span>            <span class="n">m_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
<span class="linenos">215</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">nr</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]})</span>
<span class="linenos">216</span>            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Structure&#39;</span><span class="p">):</span>
<span class="linenos">217</span>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span>
<span class="linenos">218</span>            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Angle&#39;</span><span class="p">):</span>
<span class="linenos">219</span>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;Angle&#39;</span><span class="p">]</span>
<span class="linenos">220</span>            <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Additional&#39;</span><span class="p">):</span>
<span class="linenos">221</span>                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Additional&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;Additional&#39;</span><span class="p">]</span>
<span class="linenos">222</span>
<span class="linenos">223</span>            <span class="k">if</span> <span class="n">m_type</span> <span class="o">==</span> <span class="s1">&#39;SA&#39;</span><span class="p">:</span>
<span class="linenos">224</span>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">SA</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="linenos">225</span>                <span class="bp">self</span><span class="o">.</span><span class="n">sa_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
<span class="linenos">226</span>            <span class="k">elif</span> <span class="n">m_type</span> <span class="o">==</span> <span class="s1">&#39;Hloop&#39;</span><span class="p">:</span>
<span class="linenos">227</span>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hloop</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">down_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">228</span>                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">229</span>                <span class="bp">self</span><span class="o">.</span><span class="n">hloop_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
<span class="linenos">230</span>            <span class="k">elif</span> <span class="n">m_type</span> <span class="o">==</span> <span class="s1">&#39;RAW&#39;</span><span class="p">:</span>
<span class="linenos">231</span>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">RAW</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">232</span>                <span class="bp">self</span><span class="o">.</span><span class="n">hloop_dict</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span>
<span class="linenos">233</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">234</span>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<span class="linenos">235</span>                    <span class="s1">&#39;Measurement </span><span class="si">%s</span><span class="s1"> (type: </span><span class="si">%s</span><span class="s1">) not processed (unknown type).&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">236</span>                        <span class="n">nr</span><span class="p">,</span> <span class="n">m_type</span><span class="p">))</span>
<span class="linenos">237</span>
<span class="linenos">238</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="linenos">239</span>        <span class="c1"># self.info.set_index(&#39;Nr&#39;, inplace=True)</span>
<span class="linenos">240</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Parsing Measurement Finished</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
<span class="linenos">241</span>                          <span class="s1">&#39;Debug size data/info (</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
<span class="linenos">242</span>                                                             <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="linenos">243</span>
<span class="linenos">244</span>    <span class="k">def</span> <span class="nf">_process_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="linenos">245</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">246</span><span class="sd">        Args:</span>
<span class="linenos">247</span><span class="sd">            nr:</span>
<span class="linenos">248</span><span class="sd">            data:</span>
<span class="linenos">249</span><span class="sd">            info:</span>
<span class="linenos">250</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">251</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">))</span>
<span class="linenos">252</span>
<span class="linenos">253</span>        <span class="c1"># Logging statistical values for info</span>
<span class="linenos">254</span>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos">255</span>            <span class="c1"># Converting Data to numeric</span>
<span class="linenos">256</span>            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">object</span><span class="p">:</span>
<span class="linenos">257</span>                <span class="k">try</span><span class="p">:</span>
<span class="linenos">258</span>                    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="linenos">259</span>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="linenos">260</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Not Numeric column: </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
<span class="linenos">261</span>
<span class="linenos">262</span>            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_count&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="linenos">263</span>            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_mean&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="linenos">264</span>            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_var&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="linenos">265</span>            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_min&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="linenos">266</span>            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_max&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">267</span>
<span class="linenos">268</span>        <span class="n">d_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">nr</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos">269</span>            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
<span class="linenos">270</span>            <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="n">info</span>
<span class="linenos">271</span>        <span class="p">}}</span>
<span class="linenos">272</span>        <span class="k">return</span> <span class="n">d_dict</span>
<span class="linenos">273</span>
<span class="linenos">274</span>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">275</span>        <span class="sd">&quot;&quot;&quot;Plotting a Measurement</span>
<span class="linenos">276</span>
<span class="linenos">277</span><span class="sd">        Args:</span>
<span class="linenos">278</span><span class="sd">            lofm: list of measurements</span>
<span class="linenos">279</span><span class="sd">            figsize: tuple size of figure</span>
<span class="linenos">280</span><span class="sd">            show_fit: bool</span>
<span class="linenos">281</span><span class="sd">            fit_range: tuple/list</span>
<span class="linenos">282</span><span class="sd">            plot_settings: list</span>
<span class="linenos">283</span><span class="sd">            grid_options: list</span>
<span class="linenos">284</span><span class="sd">            f_settings: 1/f line</span>
<span class="linenos">285</span><span class="sd">            f2_settings: 1/f^2 line</span>
<span class="linenos">286</span><span class="sd">            </span>
<span class="linenos">287</span>
<span class="linenos">288</span><span class="sd">        Returns:</span>
<span class="linenos">289</span><span class="sd">            tuple: Figure, Axis</span>
<span class="linenos">290</span>
<span class="linenos">291</span><span class="sd">        Raises:</span>
<span class="linenos">292</span><span class="sd">            warning: lofm not available.</span>
<span class="linenos">293</span><span class="sd">            KeyError: Measurement does not exist.</span>
<span class="linenos">294</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">295</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lofm&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos">296</span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lofm</span><span class="p">):</span>
<span class="linenos">297</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No list of measurements (lofm) available.&quot;</span><span class="p">)</span>
<span class="linenos">298</span>            <span class="k">return</span>
<span class="linenos">299</span>
<span class="linenos">300</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)))</span>
<span class="linenos">301</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lofm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">302</span>            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
<span class="linenos">303</span>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="linenos">304</span>
<span class="linenos">305</span>            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos">306</span>            <span class="n">plot_options</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">307</span>
<span class="linenos">308</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">):</span>
<span class="linenos">309</span>                <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">))</span>
<span class="linenos">310</span>                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">))</span>
<span class="linenos">311</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_fit&#39;</span><span class="p">):</span>
<span class="linenos">312</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">)),</span>
<span class="linenos">313</span>                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit m</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
<span class="linenos">314</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_fit_label&#39;</span><span class="p">):</span>
<span class="linenos">315</span>                    <span class="n">label</span> <span class="o">+=</span> <span class="s1">&#39; $</span><span class="se">\\</span><span class="s1">alpha = </span><span class="si">%.3f</span><span class="s1">, S_R(f=0) = 10^{</span><span class="si">%.3f</span><span class="s1">}$&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">316</span>                        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">)</span>
<span class="linenos">317</span>
<span class="linenos">318</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm_S&#39;</span><span class="p">):</span>
<span class="linenos">319</span>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span> <span class="o">*</span> \
<span class="linenos">320</span>                                          <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>
<span class="linenos">321</span>                <span class="n">plot_options</span><span class="p">[</span><span class="s1">&#39;plot_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;norm&#39;</span>
<span class="linenos">322</span>
<span class="linenos">323</span>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="linenos">324</span>                              <span class="n">dont_set_plot_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">325</span>                              <span class="o">**</span><span class="n">plot_options</span><span class="p">)</span>
<span class="linenos">326</span>
<span class="linenos">327</span>        <span class="n">tmp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_settings&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
<span class="linenos">328</span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">tmp</span><span class="p">):</span>
<span class="linenos">329</span>            <span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">330</span>        <span class="n">plot_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="linenos">331</span>            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e0</span><span class="p">),</span>
<span class="linenos">332</span>            <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">),</span>
<span class="linenos">333</span>            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;($90^\circ$) Field sweeps&#39;</span><span class="p">,</span>
<span class="linenos">334</span>            <span class="n">grid</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<span class="linenos">335</span>                <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
<span class="linenos">336</span>                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ffff99&#39;</span><span class="p">,</span>
<span class="linenos">337</span>                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
<span class="linenos">338</span>                <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">))</span>
<span class="linenos">339</span>        <span class="n">plot_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="linenos">340</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="o">**</span><span class="n">plot_settings</span><span class="p">)</span>
<span class="linenos">341</span>
<span class="linenos">342</span>        <span class="n">grid_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="linenos">343</span>            <span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">344</span>            <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
<span class="linenos">345</span>            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
<span class="linenos">346</span>            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
<span class="linenos">347</span>            <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
<span class="linenos">348</span>        <span class="n">grid_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid_options&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
<span class="linenos">349</span>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="o">**</span><span class="n">grid_options</span><span class="p">)</span>
<span class="linenos">350</span>
<span class="linenos">351</span>        <span class="c1"># Draw 1 over f lines</span>
<span class="linenos">352</span>        <span class="n">f_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="linenos">353</span>        <span class="n">f_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f_settings&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos">354</span>        <span class="n">f2_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">355</span>                           <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">an_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="linenos">356</span>        <span class="n">f2_settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f2_settings&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos">357</span>
<span class="linenos">358</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">f_settings</span><span class="p">)</span>
<span class="linenos">359</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_draw_oneoverf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">f2_settings</span><span class="p">)</span>
<span class="linenos">360</span>
<span class="linenos">361</span>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
<span class="linenos">362</span>
<span class="linenos">363</span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">364</span>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;HandleM</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="linenos">365</span>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
<span class="linenos">366</span>            <span class="k">return</span> <span class="n">ret</span> <span class="o">+</span> <span class="s1">&#39;Empty&#39;</span>
<span class="linenos">367</span>
<span class="linenos">368</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">369</span>            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;Nr. </span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="s1"> Type: </span><span class="si">%s</span><span class="se">\t</span><span class="s1"> Structure: </span><span class="si">%s</span><span class="se">\t</span><span class="s1">Technique: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">370</span>                <span class="n">nr</span><span class="p">,</span>
<span class="linenos">371</span>                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
<span class="linenos">372</span>                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">],</span>
<span class="linenos">373</span>                <span class="n">info</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">])</span>
<span class="linenos">374</span>        <span class="k">return</span> <span class="n">ret</span>
<span class="linenos">375</span>
<span class="linenos">376</span>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">377</span>        <span class="sd">&quot;&quot;&quot;Returns information about all measurements </span>
<span class="linenos">378</span><span class="sd">        and splits it into groups (SA/RAV/MFN/VH).&quot;&quot;&quot;</span>
<span class="linenos">379</span>        
<span class="linenos">380</span>        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
<span class="linenos">381</span>        <span class="n">sa</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SA&#39;</span><span class="p">]</span>
<span class="linenos">382</span>        <span class="n">raw</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RAW&#39;</span><span class="p">]</span>
<span class="linenos">383</span>        <span class="n">mfn</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MFN&#39;</span><span class="p">]</span>
<span class="linenos">384</span>        <span class="n">vh</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;technique&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;VH&#39;</span><span class="p">]</span>
<span class="linenos">385</span>
<span class="linenos">386</span>        <span class="n">groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vh</span><span class="o">=</span><span class="n">vh</span><span class="p">,</span> <span class="n">mfn</span><span class="o">=</span><span class="n">mfn</span><span class="p">,</span> <span class="n">sa</span><span class="o">=</span><span class="n">sa</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
<span class="linenos">387</span>
<span class="linenos">388</span>        <span class="k">return</span> <span class="n">info</span><span class="p">,</span> <span class="n">groups</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3><a class="toc-backref" href="#id66" role="doc-backlink">MFN</a><a class="headerlink" href="#id29" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">   1</span><span class="k">class</span> <span class="nc">MFN</span><span class="p">(</span><span class="n">MultipleM</span><span class="p">):</span>
<span class="linenos">   2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">   3</span>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Magnetic Flux Noise Measurements.</span>
<span class="linenos">   4</span><span class="sd">        Class to handle and plot MFN Measurements</span>
<span class="linenos">   5</span><span class="sd">        taken with the SR830 DAQ.</span>
<span class="linenos">   6</span>
<span class="linenos">   7</span><span class="sd">        if a measurement number is given the files are </span>
<span class="linenos">   8</span><span class="sd">        loaded from folder:</span>
<span class="linenos">   9</span><span class="sd">                ``data/MFN/m%s/*.dat``</span>
<span class="linenos">  10</span><span class="sd">        </span>
<span class="linenos">  11</span><span class="sd">        else: files must be a list of filenames:</span>
<span class="linenos">  12</span>
<span class="linenos">  13</span><span class="sd">            .. code:: python</span>
<span class="linenos">  14</span><span class="sd">               :linenos:</span>
<span class="linenos">  15</span><span class="sd">               :caption: Example</span>
<span class="linenos">  16</span>
<span class="linenos">  17</span><span class="sd">               arg = glob(&#39;data/MFN/mXXX/m[0-9.]*.dat&#39;)</span>
<span class="linenos">  18</span><span class="sd">               mfn = MFN(arg)</span>
<span class="linenos">  19</span>
<span class="linenos">  20</span><span class="sd">        :param files: list of files or measurement number.</span>
<span class="linenos">  21</span><span class="sd">        :param kwargs: Different additional parameters.</span>
<span class="linenos">  22</span><span class="sd">        :param int nr: Measurement number</span>
<span class="linenos">  23</span><span class="sd">           (default: None).</span>
<span class="linenos">  24</span><span class="sd">        :param bool calc_first: Calculating first spectrum</span>
<span class="linenos">  25</span><span class="sd">           (default: True).</span>
<span class="linenos">  26</span><span class="sd">        :param bool calc_second: Calculating second spectrum</span>
<span class="linenos">  27</span><span class="sd">           (default: False).</span>
<span class="linenos">  28</span><span class="sd">        :param bool downsample: downsample timesignal for first spectrum</span>
<span class="linenos">  29</span><span class="sd">           (default: False).</span>
<span class="linenos">  30</span><span class="sd">        :param int num_first_spectra: Number of spectra to average</span>
<span class="linenos">  31</span><span class="sd">           (default: 64).</span>
<span class="linenos">  32</span><span class="sd">        :param float timeconstant: Lock-In timeconstant to cut first spectrum</span>
<span class="linenos">  33</span><span class="sd">            at corresponding frequency (see ``cut_fmax``).</span>
<span class="linenos">  34</span><span class="sd">        :param float cut_fmax: Cut first spectrum at this frequency</span>
<span class="linenos">  35</span><span class="sd">           (default: :math:`f_{max} = \frac{\tau}{2\pi}`).</span>
<span class="linenos">  36</span><span class="sd">        :param default_cm: matplotlib color map for contour plots</span>
<span class="linenos">  37</span><span class="sd">           (default: style[&#39;default_cm&#39;]).</span>
<span class="linenos">  38</span><span class="sd">        :type default_cm: matplotlib.cm</span>
<span class="linenos">  39</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">  40</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos">  41</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Magnetic Flux Noise&#39;</span>
<span class="linenos">  42</span>        <span class="bp">self</span><span class="o">.</span><span class="n">default_cm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">))</span>
<span class="linenos">  43</span>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s1">&#39;default_cm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_cm</span>
<span class="linenos">  44</span>
<span class="linenos">  45</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">  46</span>            <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nr&#39;</span><span class="p">),</span>
<span class="linenos">  47</span>            <span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_first&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
<span class="linenos">  48</span>            <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_second&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="linenos">  49</span>            <span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num_first_spectra&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
<span class="linenos">  50</span>            <span class="s1">&#39;downsample&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;downsample&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="linenos">  51</span>            <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">),</span>
<span class="linenos">  52</span>        <span class="p">}</span>
<span class="linenos">  53</span>
<span class="linenos">  54</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span class="linenos">  55</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">files</span>
<span class="linenos">  56</span>            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/MFN/m</span><span class="si">%s</span><span class="s1">/*&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">])</span>
<span class="linenos">  57</span>
<span class="linenos">  58</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;MFNMeasurement (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>
<span class="linenos">  59</span>                                        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">])</span>
<span class="linenos">  60</span>
<span class="linenos">  61</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_meas</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">  62</span>
<span class="linenos">  63</span>        <span class="c1"># Stop here if we have no data</span>
<span class="linenos">  64</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">  65</span>            <span class="k">return</span>
<span class="linenos">  66</span>
<span class="linenos">  67</span>        <span class="c1"># Cut too long measurements</span>
<span class="linenos">  68</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;equalize_length&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
<span class="linenos">  69</span>            <span class="bp">self</span><span class="o">.</span><span class="n">__equalize_length</span><span class="p">()</span>
<span class="linenos">  70</span>
<span class="linenos">  71</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">)</span>
<span class="linenos">  72</span>
<span class="linenos">  73</span>        <span class="c1"># Cut higher frequencies if timeconstant is known</span>
<span class="linenos">  74</span>        <span class="n">fmax_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">1e6</span>
<span class="linenos">  75</span>        <span class="n">fmax_tc</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;timeconstant&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="mf">1e6</span>
<span class="linenos">  76</span>        <span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">fmax_rate</span><span class="p">,</span> <span class="n">fmax_tc</span><span class="p">])</span>
<span class="linenos">  77</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;fmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmax</span>
<span class="linenos">  78</span>        <span class="k">if</span> <span class="n">fmax</span> <span class="o">&lt;</span> <span class="mf">1e6</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cut_fmax&#39;</span><span class="p">):</span>
<span class="linenos">  79</span>            <span class="bp">self</span><span class="o">.</span><span class="n">cut_fmax</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cut_fmax&#39;</span><span class="p">,</span> <span class="n">fmax</span><span class="p">))</span>
<span class="linenos">  80</span>
<span class="linenos">  81</span>    <span class="k">def</span> <span class="nf">load_meas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  82</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  83</span><span class="sd">        Loading a single magnetic flux noise DAQ measurement.</span>
<span class="linenos">  84</span><span class="sd">        </span>
<span class="linenos">  85</span><span class="sd">        Files in measrument folder contain multiple measurements</span>
<span class="linenos">  86</span><span class="sd">        with one measurement per field.</span>
<span class="linenos">  87</span>
<span class="linenos">  88</span><span class="sd">        :param files: files to load</span>
<span class="linenos">  89</span><span class="sd">        </span>
<span class="linenos">  90</span><span class="sd">        :return: DataFrame Data, dict Measurement Objects</span>
<span class="linenos">  91</span><span class="sd">        :rtype: tuple</span>
<span class="linenos">  92</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">  93</span>
<span class="linenos">  94</span>        <span class="n">max_len</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">  95</span>        <span class="n">meas</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">  96</span>        <span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Field&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Vx&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Vy&#39;</span><span class="p">:</span> <span class="p">[]})</span>
<span class="linenos">  97</span>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<span class="linenos">  98</span>            <span class="n">info_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_info_from_name</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="linenos">  99</span>
<span class="linenos"> 100</span>            <span class="n">field</span> <span class="o">=</span> <span class="n">info_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>
<span class="linenos"> 101</span>            <span class="n">nr</span> <span class="o">=</span> <span class="n">info_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nr&#39;</span><span class="p">)</span>
<span class="linenos"> 102</span>
<span class="linenos"> 103</span>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">):</span>
<span class="linenos"> 104</span>                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nr</span>
<span class="linenos"> 105</span>
<span class="linenos"> 106</span>            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos"> 107</span>            <span class="k">if</span> <span class="n">data_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<span class="linenos"> 108</span>                <span class="k">continue</span>
<span class="linenos"> 109</span>
<span class="linenos"> 110</span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">:</span>
<span class="linenos"> 111</span>                <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">)]</span>
<span class="linenos"> 112</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 113</span>                <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vx</span>
<span class="linenos"> 114</span>
<span class="linenos"> 115</span>            <span class="n">max_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="linenos"> 116</span>
<span class="linenos"> 117</span>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 118</span>                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span>
<span class="linenos"> 119</span>                <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 120</span>                    <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">nr</span><span class="p">,</span>
<span class="linenos"> 121</span>                    <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
<span class="linenos"> 122</span>                    <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="linenos"> 123</span>                    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="n">max_len</span> <span class="o">*</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="linenos"> 124</span>                <span class="p">}</span>
<span class="linenos"> 125</span>            <span class="p">}</span>
<span class="linenos"> 126</span>
<span class="linenos"> 127</span>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]:</span>
<span class="linenos"> 128</span>                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_len</span> <span class="o">*</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="linenos"> 129</span>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">):</span>
<span class="linenos"> 130</span>                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="linenos"> 131</span>
<span class="linenos"> 132</span>            <span class="c1"># Calculate the first and second spectrum</span>
<span class="linenos"> 133</span>            <span class="n">meas</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_meas</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 134</span>
<span class="linenos"> 135</span>            <span class="k">if</span> <span class="n">meas</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 136</span>                <span class="n">meas</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="linenos"> 137</span>
<span class="linenos"> 138</span>            <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="linenos"> 139</span>                <span class="p">{</span><span class="s1">&#39;Field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
<span class="linenos"> 140</span>                 <span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">max_len</span><span class="p">],</span>
<span class="linenos"> 141</span>                 <span class="s1">&#39;Vx&#39;</span><span class="p">:</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">max_len</span><span class="p">]</span> <span class="o">*</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
<span class="linenos"> 142</span>                 <span class="s1">&#39;Vy&#39;</span><span class="p">:</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">max_len</span><span class="p">]</span> <span class="o">*</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
<span class="linenos"> 143</span>                 <span class="p">})</span>
<span class="linenos"> 144</span>            <span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_data</span><span class="p">,</span> <span class="n">tmp_df</span><span class="p">])</span>  <span class="c1"># , how=&#39;outer&#39;)</span>
<span class="linenos"> 145</span>
<span class="linenos"> 146</span>        <span class="k">return</span> <span class="n">all_data</span><span class="p">,</span> <span class="n">meas</span>
<span class="linenos"> 147</span>
<span class="linenos"> 148</span>    <span class="k">def</span> <span class="nf">_get_raw_meas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 149</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 150</span><span class="sd">        Returns the RAW Measurement.</span>
<span class="linenos"> 151</span><span class="sd">        :param dict data: time signal and info</span>
<span class="linenos"> 152</span><span class="sd">        :param bool calculate_second_by_hand: if we calc</span>
<span class="linenos"> 153</span><span class="sd">        :return: RAWMeasurement</span>
<span class="linenos"> 154</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 155</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 156</span>            <span class="k">return</span> <span class="kc">None</span>
<span class="linenos"> 157</span>
<span class="linenos"> 158</span>        <span class="n">ret</span> <span class="o">=</span> <span class="n">RAW</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="linenos"> 159</span>                  <span class="n">rate</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">],</span>
<span class="linenos"> 160</span>                  <span class="n">nof_first_spectra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
<span class="linenos"> 161</span>                  <span class="n">calc_first</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">],</span>
<span class="linenos"> 162</span>                  <span class="n">calc_second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">],</span>
<span class="linenos"> 163</span>                  <span class="n">downsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;downsample&#39;</span><span class="p">],</span>
<span class="linenos"> 164</span>                  <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;raw_kwargs&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
<span class="linenos"> 165</span>                  <span class="p">)</span>
<span class="linenos"> 166</span>
<span class="linenos"> 167</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calculate_second_by_hand&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos"> 168</span>            <span class="n">ret</span><span class="o">.</span><span class="n">calc_second_spectrum</span><span class="p">(</span>
<span class="linenos"> 169</span>                <span class="n">highest_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 170</span>                    <span class="s1">&#39;highest_octave&#39;</span><span class="p">,</span> <span class="n">ret</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
<span class="linenos"> 171</span>                <span class="n">minimum_points_in_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 172</span>                    <span class="s1">&#39;minimum_points_in_octave&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="linenos"> 173</span>                <span class="n">peak_filter</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 174</span>                    <span class="s1">&#39;peak_filter&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="linenos"> 175</span>            <span class="p">)</span>
<span class="linenos"> 176</span>
<span class="linenos"> 177</span>        <span class="k">return</span> <span class="n">ret</span>
<span class="linenos"> 178</span>
<span class="linenos"> 179</span>    <span class="k">def</span> <span class="nf">cut_fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmax</span><span class="p">):</span>
<span class="linenos"> 180</span>        <span class="sd">&quot;&quot;&quot;Cut frequencies higher than maximum allowed frequencies.</span>
<span class="linenos"> 181</span>
<span class="linenos"> 182</span><span class="sd">        Args:</span>
<span class="linenos"> 183</span><span class="sd">            fmax:</span>
<span class="linenos"> 184</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 185</span>        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos"> 186</span>            <span class="c1"># Drop all frequencies larger than fmax</span>
<span class="linenos"> 187</span>            <span class="n">s</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span>
<span class="linenos"> 188</span>            <span class="n">s</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Frequency &gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fmax</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span class="linenos"> 189</span>                   <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
<span class="linenos"> 190</span>                   <span class="p">)</span>
<span class="linenos"> 191</span>            <span class="n">freq</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span>
<span class="linenos"> 192</span>            <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">fmax</span><span class="p">]</span>
<span class="linenos"> 193</span>            <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span> <span class="o">=</span> <span class="n">freq</span>
<span class="linenos"> 194</span>
<span class="linenos"> 195</span>            <span class="c1"># Reset First Spectrum Variables</span>
<span class="linenos"> 196</span>            <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">finalize_first_spectrum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="linenos"> 197</span>            <span class="n">spec</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos"> 198</span>                <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">freq</span><span class="p">,</span>
<span class="linenos"> 199</span>                <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectrum_avg</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span>  <span class="c1"># copy</span>
<span class="linenos"> 200</span>            <span class="p">})</span>
<span class="linenos"> 201</span>
<span class="linenos"> 202</span>    <span class="k">def</span> <span class="nf">__equalize_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 203</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 204</span><span class="sd">        Check that data for all fields have same amount of data.</span>
<span class="linenos"> 205</span><span class="sd">        :return:</span>
<span class="linenos"> 206</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 207</span>        <span class="c1"># Check if all fields have same amount of data</span>
<span class="linenos"> 208</span>        <span class="n">nofvalues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="linenos"> 209</span>        <span class="k">if</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 210</span>            <span class="n">fields_with_more_data</span> <span class="o">=</span> <span class="n">nofvalues</span><span class="p">[</span>
<span class="linenos"> 211</span>                <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span> <span class="o">&gt;</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos"> 212</span>            <span class="n">fields_with_less_data</span> <span class="o">=</span> <span class="n">nofvalues</span><span class="p">[</span>
<span class="linenos"> 213</span>                <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span> <span class="o">&lt;</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="linenos"> 214</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<span class="linenos"> 215</span>                <span class="s1">&#39;Not all fields have same amount of data (median = </span><span class="si">%s</span><span class="s1">):</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos"> 216</span>                    <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.5</span><span class="p">))</span>
<span class="linenos"> 217</span>                <span class="o">+</span> <span class="s1">&#39;Fields with more data: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fields_with_more_data</span>
<span class="linenos"> 218</span>                <span class="o">+</span> <span class="s1">&#39;Fields with less data: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fields_with_less_data</span>
<span class="linenos"> 219</span>                <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="linenos"> 220</span>                <span class="o">+</span> <span class="s1">&#39;To avoid data loss use the option &quot;equalize_length=False&quot;!&#39;</span><span class="p">)</span>
<span class="linenos"> 221</span>
<span class="linenos"> 222</span>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<span class="linenos"> 223</span>                <span class="n">condition</span> <span class="o">=</span> <span class="s1">&#39;Field == </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span>
<span class="linenos"> 224</span>                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_with_more_data</span><span class="p">:</span>
<span class="linenos"> 225</span>                    <span class="c1"># Cut data</span>
<span class="linenos"> 226</span>                    <span class="n">cut_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
<span class="linenos"> 227</span>                               <span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">())]</span>
<span class="linenos"> 228</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
<span class="linenos"> 229</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span class="linenos"> 230</span>                        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 231</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cut_data</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="linenos"> 232</span>
<span class="linenos"> 233</span>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 234</span>                        <span class="c1"># recalculate Spectrum</span>
<span class="linenos"> 235</span>                        <span class="n">rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="linenos"> 236</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_meas</span><span class="p">(</span>
<span class="linenos"> 237</span>                            <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<span class="linenos"> 238</span>                             <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 239</span>                                 <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Nr&#39;</span><span class="p">],</span>
<span class="linenos"> 240</span>                                 <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
<span class="linenos"> 241</span>                                 <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="n">rate</span><span class="p">,</span>
<span class="linenos"> 242</span>                             <span class="p">}</span>
<span class="linenos"> 243</span>                             <span class="p">},</span>
<span class="linenos"> 244</span>                        <span class="p">)</span>
<span class="linenos"> 245</span>                    <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 246</span>                        <span class="c1"># Remove field from measurements</span>
<span class="linenos"> 247</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="linenos"> 248</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
<span class="linenos"> 249</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span class="linenos"> 250</span>                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 251</span>
<span class="linenos"> 252</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<span class="linenos"> 253</span>                        <span class="s1">&#39;This field (</span><span class="si">%s</span><span class="s1">) has more data &#39;</span>
<span class="linenos"> 254</span>                        <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">) than median (</span><span class="si">%s</span><span class="s1">): Cutting data!&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos"> 255</span>                            <span class="n">field</span><span class="p">,</span>
<span class="linenos"> 256</span>                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">field</span><span class="p">],</span>
<span class="linenos"> 257</span>                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="linenos"> 258</span>                        <span class="p">)</span>
<span class="linenos"> 259</span>                    <span class="p">)</span>
<span class="linenos"> 260</span>
<span class="linenos"> 261</span>                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_with_less_data</span><span class="p">:</span>
<span class="linenos"> 262</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<span class="linenos"> 263</span>                        <span class="s1">&#39;This field (</span><span class="si">%s</span><span class="s1">) has less data &#39;</span>
<span class="linenos"> 264</span>                        <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">) than median (</span><span class="si">%s</span><span class="s1">): Deleting field from data!&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos"> 265</span>                            <span class="n">field</span><span class="p">,</span>
<span class="linenos"> 266</span>                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">field</span><span class="p">],</span>
<span class="linenos"> 267</span>                            <span class="n">nofvalues</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="linenos"> 268</span>                        <span class="p">)</span>
<span class="linenos"> 269</span>                    <span class="p">)</span>
<span class="linenos"> 270</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
<span class="linenos"> 271</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<span class="linenos"> 272</span>                        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 273</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="linenos"> 274</span>
<span class="linenos"> 275</span>    <span class="k">def</span> <span class="nf">plot_first_and_second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 276</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 277</span><span class="sd">        Args:</span>
<span class="linenos"> 278</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 279</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 280</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
<span class="linenos"> 281</span>        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 282</span>                                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">),</span> <span class="p">)</span>
<span class="linenos"> 283</span>
<span class="linenos"> 284</span>        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
<span class="linenos"> 285</span>            <span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="linenos"> 286</span>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
<span class="linenos"> 287</span>            <span class="c1"># Setting shortcuts</span>
<span class="linenos"> 288</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 289</span>                <span class="n">meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
<span class="linenos"> 290</span>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="linenos"> 291</span>                <span class="k">continue</span>
<span class="linenos"> 292</span>
<span class="linenos"> 293</span>            <span class="n">s</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 294</span>
<span class="linenos"> 295</span>            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos"> 296</span>
<span class="linenos"> 297</span>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;second_spectra&#39;</span><span class="p">):</span>
<span class="linenos"> 298</span>                <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;+x*ds&quot;</span>
<span class="linenos"> 299</span>                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;rbgyk&quot;</span>
<span class="linenos"> 300</span>                <span class="k">for</span> <span class="n">octave</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
<span class="linenos"> 301</span>                        <span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
<span class="linenos"> 302</span>                    <span class="n">second</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">[</span><span class="n">octave</span><span class="p">]</span>
<span class="linenos"> 303</span>                    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
<span class="linenos"> 304</span>                             <span class="n">second</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="linenos"> 305</span>                             <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">octave</span><span class="p">],</span> <span class="n">marker</span><span class="p">[</span><span class="n">octave</span><span class="p">])</span>
<span class="linenos"> 306</span>                             <span class="p">)</span>
<span class="linenos"> 307</span>
<span class="linenos"> 308</span>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sum$ Second Spectrum&#39;</span><span class="p">)</span>
<span class="linenos"> 309</span>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S$ [a.u.]&#39;</span><span class="p">)</span>
<span class="linenos"> 310</span>
<span class="linenos"> 311</span>        <span class="c1"># Legend for second spectrum</span>
<span class="linenos"> 312</span>        <span class="n">field</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 313</span>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 314</span>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;second_spectra&#39;</span><span class="p">):</span>
<span class="linenos"> 315</span>            <span class="k">for</span> <span class="n">octave</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
<span class="linenos"> 316</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
<span class="linenos"> 317</span>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> Octave&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">octave</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="linenos"> 318</span>        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="linenos"> 319</span>
<span class="linenos"> 320</span>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<span class="linenos"> 321</span>            <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: $</span><span class="se">\\</span><span class="s1">sum$ First Spectrum Noise&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;nr&#39;</span><span class="p">])</span>
<span class="linenos"> 322</span>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
<span class="linenos"> 323</span>            <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle S_V </span><span class="se">\\</span><span class="s1">rangle$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">^2/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos"> 324</span>
<span class="linenos"> 325</span>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ax1</span><span class="p">]:</span>
<span class="linenos"> 326</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos"> 327</span>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos"> 328</span>
<span class="linenos"> 329</span>    <span class="k">def</span> <span class="nf">plot_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 330</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 331</span><span class="sd">        Fits a spectrum and plots the slope alpha.</span>
<span class="linenos"> 332</span><span class="sd">        :param s: pandas.DataFrame of the spectrum</span>
<span class="linenos"> 333</span><span class="sd">        :param ax: axis where to plot the data.</span>
<span class="linenos"> 334</span><span class="sd">        :return: linear regression fit</span>
<span class="linenos"> 335</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 336</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
<span class="linenos"> 337</span>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="linenos"> 338</span>
<span class="linenos"> 339</span>        <span class="c1"># Fitting alpha</span>
<span class="linenos"> 340</span>        <span class="n">s</span><span class="p">[</span><span class="s1">&#39;lnf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
<span class="linenos"> 341</span>        <span class="n">s</span><span class="p">[</span><span class="s1">&#39;lnS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
<span class="linenos"> 342</span>
<span class="linenos"> 343</span>        <span class="n">fit_indices</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_range&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="linenos"> 344</span>
<span class="linenos"> 345</span>        <span class="n">f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
<span class="linenos"> 346</span>            <span class="n">s</span><span class="o">.</span><span class="n">lnf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fit_indices</span><span class="p">],</span>
<span class="linenos"> 347</span>            <span class="n">s</span><span class="o">.</span><span class="n">lnS</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fit_indices</span><span class="p">])</span>
<span class="linenos"> 348</span>
<span class="linenos"> 349</span>        <span class="n">plt_obj</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha_symbol&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
<span class="linenos"> 350</span>
<span class="linenos"> 351</span>        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">plt_obj</span>
<span class="linenos"> 352</span>
<span class="linenos"> 353</span>    <span class="k">def</span> <span class="nf">plot_info2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 354</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 355</span><span class="sd">        Args:</span>
<span class="linenos"> 356</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 357</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 358</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">):</span>
<span class="linenos"> 359</span>            <span class="n">fig</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">)</span>
<span class="linenos"> 360</span>            <span class="p">(</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">)</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
<span class="linenos"> 361</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 362</span>            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 363</span>                                             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">)</span>
<span class="linenos"> 364</span>        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
<span class="linenos"> 365</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="linenos"> 366</span>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_noise_chararcteristics</span><span class="p">(</span><span class="n">ax11</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="linenos"> 367</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour</span><span class="p">(</span><span class="n">ax12</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
<span class="linenos"> 368</span>
<span class="linenos"> 369</span>    <span class="k">def</span> <span class="nf">plot_noise_chararcteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 370</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 371</span><span class="sd">        Args:</span>
<span class="linenos"> 372</span><span class="sd">            ax:</span>
<span class="linenos"> 373</span><span class="sd">            fields:</span>
<span class="linenos"> 374</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 375</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 376</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
<span class="linenos"> 377</span>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="linenos"> 378</span>        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="linenos"> 379</span>
<span class="linenos"> 380</span>        <span class="n">par2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="linenos"> 381</span>
<span class="linenos"> 382</span>        <span class="n">spectra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 383</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
<span class="linenos"> 384</span>            <span class="c1"># Setting shortcut for Average Spectrum s</span>
<span class="linenos"> 385</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 386</span>                <span class="n">meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
<span class="linenos"> 387</span>                <span class="k">if</span> <span class="n">meas</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos"> 388</span>                    <span class="k">continue</span>
<span class="linenos"> 389</span>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="linenos"> 390</span>                <span class="k">continue</span>
<span class="linenos"> 391</span>
<span class="linenos"> 392</span>            <span class="n">s</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 393</span>
<span class="linenos"> 394</span>            <span class="n">spectra_df</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span>
<span class="linenos"> 395</span>
<span class="linenos"> 396</span>            <span class="n">f</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_alpha</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">par2</span><span class="p">,</span> <span class="n">alpha_symbol</span><span class="o">=</span><span class="s2">&quot;bo&quot;</span><span class="p">,</span>
<span class="linenos"> 397</span>                                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 398</span>            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span>
<span class="linenos"> 399</span>            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span>
<span class="linenos"> 400</span>
<span class="linenos"> 401</span>            <span class="n">integral</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos"> 402</span>                                <span class="s1">&#39;gd&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Integral&#39;</span><span class="p">)</span>
<span class="linenos"> 403</span>            <span class="n">intercept</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;r*&#39;</span><span class="p">,</span>
<span class="linenos"> 404</span>                                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$S(f=1~</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="linenos"> 405</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos"> 406</span>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">integral</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 407</span>                   <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="linenos"> 408</span>        <span class="c1"># (&#39;Integral&#39;, &#39;$S(f=1~\\mathrm{Hz})$&#39;, &#39;$\\alpha$&#39;))</span>
<span class="linenos"> 409</span>
<span class="linenos"> 410</span>    <span class="k">def</span> <span class="nf">plot_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_field</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 411</span>        <span class="sd">&quot;&quot;&quot;Plots basic mfn infos</span>
<span class="linenos"> 412</span>
<span class="linenos"> 413</span><span class="sd">        Args:</span>
<span class="linenos"> 414</span><span class="sd">            show_field:</span>
<span class="linenos"> 415</span><span class="sd">            kwargs:</span>
<span class="linenos"> 416</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 417</span>
<span class="linenos"> 418</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
<span class="linenos"> 419</span>        <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">),</span>
<span class="linenos"> 420</span>              <span class="p">(</span><span class="n">ax21</span><span class="p">,</span> <span class="n">ax22</span><span class="p">),</span>
<span class="linenos"> 421</span>              <span class="p">(</span><span class="n">ax31</span><span class="p">,</span> <span class="n">ax32</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 422</span>                                           <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">),</span>
<span class="linenos"> 423</span>                                           <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gridspec_kw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()),</span>
<span class="linenos"> 424</span>                                           <span class="c1">#  wspace=.3,</span>
<span class="linenos"> 425</span>                                           <span class="c1">#  hspace=.45)</span>
<span class="linenos"> 426</span>                                           <span class="p">)</span>
<span class="linenos"> 427</span>        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
<span class="linenos"> 428</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="linenos"> 429</span>        <span class="n">spectra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 430</span>        <span class="n">second</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 431</span>        <span class="n">spectra_fit</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="linenos"> 432</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
<span class="linenos"> 433</span>            <span class="c1"># Setting shortcut for Average Spectrum s</span>
<span class="linenos"> 434</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 435</span>                <span class="n">meas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
<span class="linenos"> 436</span>                <span class="k">if</span> <span class="n">meas</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos"> 437</span>                    <span class="k">continue</span>
<span class="linenos"> 438</span>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="linenos"> 439</span>                <span class="k">continue</span>
<span class="linenos"> 440</span>
<span class="linenos"> 441</span>            <span class="n">s</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 442</span>
<span class="linenos"> 443</span>            <span class="n">spectra_df</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span>
<span class="linenos"> 444</span>
<span class="linenos"> 445</span>            <span class="n">ax11</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> T&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>
<span class="linenos"> 446</span>
<span class="linenos"> 447</span>            <span class="n">f</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_alpha</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">ax21</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 448</span>            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span>
<span class="linenos"> 449</span>            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span>
<span class="linenos"> 450</span>            <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 451</span>
<span class="linenos"> 452</span>            <span class="n">ax22</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos"> 453</span>            <span class="n">spectra_fit</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 454</span>                <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos"> 455</span>                <span class="s1">&#39;amplitude&#39;</span><span class="p">:</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">],</span>
<span class="linenos"> 456</span>                <span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="n">meas</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]}</span>
<span class="linenos"> 457</span>
<span class="linenos"> 458</span>            <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
<span class="linenos"> 459</span>                <span class="k">raise</span> <span class="ne">ValueError</span>
<span class="linenos"> 460</span>
<span class="linenos"> 461</span>            <span class="n">time_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>
<span class="linenos"> 462</span>            <span class="n">m</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="linenos"> 463</span>            <span class="n">std</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="linenos"> 464</span>            <span class="n">ax32</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="linenos"> 465</span>
<span class="linenos"> 466</span>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;second_spectra&#39;</span><span class="p">):</span>
<span class="linenos"> 467</span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 468</span>                    <span class="n">second</span><span class="p">[</span><span class="s1">&#39;S</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 469</span>
<span class="linenos"> 470</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_fit_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">spectra_fit</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="linenos"> 471</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_fit_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Field&#39;</span>
<span class="linenos"> 472</span>
<span class="linenos"> 473</span>        <span class="c1"># Plot Contour Plot of Averaged Spectra per Field</span>
<span class="linenos"> 474</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_field_contour&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
<span class="linenos"> 475</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour</span><span class="p">(</span><span class="n">ax12</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 476</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 477</span>            <span class="n">field</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 478</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_second_sum&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos"> 479</span>                <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;+x*ds&quot;</span>
<span class="linenos"> 480</span>                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;rbgyk&quot;</span>
<span class="linenos"> 481</span>                <span class="k">for</span> <span class="n">octave</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
<span class="linenos"> 482</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span>
<span class="linenos"> 483</span>                            <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
<span class="linenos"> 484</span>                    <span class="n">ax12</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
<span class="linenos"> 485</span>                              <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span>
<span class="linenos"> 486</span>                                  <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">[</span>
<span class="linenos"> 487</span>                                  <span class="n">octave</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="linenos"> 488</span>                              <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">octave</span><span class="p">],</span> <span class="n">marker</span><span class="p">[</span><span class="n">octave</span><span class="p">])</span>
<span class="linenos"> 489</span>                              <span class="p">)</span>
<span class="linenos"> 490</span>                <span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_2 (f)$&#39;</span><span class="p">)</span>
<span class="linenos"> 491</span>            <span class="k">elif</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_second_freq&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos"> 492</span>                <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span>
<span class="linenos"> 493</span>                    <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array_second_spectra</span>
<span class="linenos"> 494</span>                <span class="n">smin</span><span class="p">,</span> <span class="n">smax</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">second</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos"> 495</span>                <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smin</span><span class="p">),</span>
<span class="linenos"> 496</span>                                     <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smax</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>
<span class="linenos"> 497</span>                <span class="n">cs</span> <span class="o">=</span> <span class="n">ax12</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span>
<span class="linenos"> 498</span>                                   <span class="n">frequencies</span><span class="p">,</span>
<span class="linenos"> 499</span>                                   <span class="n">second</span><span class="p">,</span>
<span class="linenos"> 500</span>                                   <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">smin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">smax</span><span class="p">),</span>
<span class="linenos"> 501</span>                                   <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
<span class="linenos"> 502</span>                                   <span class="n">cmap</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contour_cm&#39;</span><span class="p">,</span>
<span class="linenos"> 503</span>                                                   <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">)),</span>
<span class="linenos"> 504</span>                                   <span class="p">)</span>
<span class="linenos"> 505</span>                <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">)</span>
<span class="linenos"> 506</span>                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>
<span class="linenos"> 507</span>                <span class="n">ax12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos"> 508</span>                <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Second Spectrum over Field&#39;</span><span class="p">)</span>
<span class="linenos"> 509</span>                <span class="n">ax12</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">$ [$T$]&#39;</span><span class="p">)</span>
<span class="linenos"> 510</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 511</span>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Field == @show_field&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="linenos"> 512</span>                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">)</span>
<span class="linenos"> 513</span>
<span class="linenos"> 514</span>        <span class="c1"># # Plot 1/f line in Spectrum</span>
<span class="linenos"> 515</span>        <span class="c1"># xmin, ymin = kwargs.get(&#39;xymin&#39;, (2e-1, 5e-14))</span>
<span class="linenos"> 516</span>        <span class="c1"># factor, alpha = (1.5, 2)</span>
<span class="linenos"> 517</span>        <span class="c1"># ax11.plot([xmin, xmin * factor],</span>
<span class="linenos"> 518</span>        <span class="c1">#           [ymin, ymin / (factor ** alpha)],</span>
<span class="linenos"> 519</span>        <span class="c1">#           &#39;k--&#39;)</span>
<span class="linenos"> 520</span>        <span class="c1"># ax11.annotate(&#39;$1/f^{}$&#39;.format(alpha),</span>
<span class="linenos"> 521</span>        <span class="c1">#               (</span>
<span class="linenos"> 522</span>        <span class="c1">#                   xmin * np.sqrt(factor),</span>
<span class="linenos"> 523</span>        <span class="c1">#                   ymin / (factor ** (alpha / 2))</span>
<span class="linenos"> 524</span>        <span class="c1">#                )</span>
<span class="linenos"> 525</span>        <span class="c1">#               )</span>
<span class="linenos"> 526</span>
<span class="linenos"> 527</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disable_PSD_grid&#39;</span><span class="p">):</span>
<span class="linenos"> 528</span>            <span class="c1">#ax11.set_xticks([.2+_/10 for _ in range(9)], minor=True)</span>
<span class="linenos"> 529</span>            <span class="n">ax11</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
<span class="linenos"> 530</span>                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cccccc&#39;</span><span class="p">,</span>
<span class="linenos"> 531</span>                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
<span class="linenos"> 532</span>                      <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
<span class="linenos"> 533</span>
<span class="linenos"> 534</span>        <span class="c1"># Set nice title and axis labels</span>
<span class="linenos"> 535</span>        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{I. PSD}&#39;</span><span class="p">)</span>
<span class="linenos"> 536</span>        <span class="n">ax11</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$f$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos"> 537</span>        <span class="n">ax11</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_V (f) \cdot f$&#39;</span><span class="p">)</span>
<span class="linenos"> 538</span>
<span class="linenos"> 539</span>        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{III. Slope} $</span><span class="se">\\</span><span class="s1">mathbf{S_V \sim 1/f^{</span><span class="se">\\</span><span class="s1">alpha}}$&#39;</span><span class="p">)</span>
<span class="linenos"> 540</span>        <span class="n">ax21</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
<span class="linenos"> 541</span>
<span class="linenos"> 542</span>        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{IV. PSD Integral}&#39;</span><span class="p">)</span>
<span class="linenos"> 543</span>
<span class="linenos"> 544</span>        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax22</span><span class="p">,</span> <span class="n">ax12</span><span class="p">]:</span>
<span class="linenos"> 545</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos"> 546</span>
<span class="linenos"> 547</span>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_field_contour</span><span class="p">(</span><span class="n">ax31</span><span class="p">,</span> <span class="n">show_field</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 548</span>
<span class="linenos"> 549</span>        <span class="n">ax32</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{VI. Hysteresis Loop}&#39;</span><span class="p">)</span>
<span class="linenos"> 550</span>        <span class="n">ax32</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$V_H$ [$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)))</span>
<span class="linenos"> 551</span>        <span class="n">ax32</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">$ [$T$]&#39;</span><span class="p">)</span>
<span class="linenos"> 552</span>
<span class="linenos"> 553</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notitle&#39;</span><span class="p">):</span>
<span class="linenos"> 554</span>            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;m</span><span class="si">%d</span><span class="s1">: &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">431</span><span class="p">)</span>
<span class="linenos"> 555</span>                     <span class="o">+</span> <span class="s1">&#39;Rate=$</span><span class="si">%d</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$, &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span>
<span class="linenos"> 556</span>                     <span class="o">+</span> <span class="s1">&#39;Length=$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{s}</span><span class="s1">$ </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">],</span>
<span class="linenos"> 557</span>                                                         <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 558</span>                                                             <span class="s1">&#39;add_info&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
<span class="linenos"> 559</span>
<span class="linenos"> 560</span>    <span class="k">def</span> <span class="nf">plot_field_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax31</span><span class="p">,</span> <span class="n">show_field</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 561</span>        <span class="c1"># Show specific field</span>
<span class="linenos"> 562</span>        <span class="n">field_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">show_field</span><span class="p">)</span>
<span class="linenos"> 563</span>        <span class="k">if</span> <span class="n">field_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<span class="linenos"> 564</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not find timesignal for field (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span>
<span class="linenos"> 565</span>                              <span class="n">show_field</span><span class="p">)</span>
<span class="linenos"> 566</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 567</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 568</span>                <span class="n">field_spectra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">show_field</span><span class="p">]</span>
<span class="linenos"> 569</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_timesignal&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos"> 570</span>                    <span class="n">field_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax31</span><span class="p">)</span>
<span class="linenos"> 571</span>                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<span class="linenos"> 572</span>                        <span class="s1">&#39;Timesignal ($</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> = </span><span class="si">%.2f</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos"> 573</span>                                <span class="n">show_field</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">))</span>
<span class="linenos"> 574</span>                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
<span class="linenos"> 575</span>                        <span class="s1">&#39;$V_H$ [$</span><span class="si">%s</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)))</span>
<span class="linenos"> 576</span>
<span class="linenos"> 577</span>                    <span class="c1"># show chunksize of first spectra generated</span>
<span class="linenos"> 578</span>                    <span class="n">num</span> <span class="o">=</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_first_spectra</span>
<span class="linenos"> 579</span>                    <span class="n">len_first_spectra</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">field_data</span><span class="p">)</span> <span class="o">/</span> <span class="n">num</span>
<span class="linenos"> 580</span>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
<span class="linenos"> 581</span>                        <span class="n">x</span> <span class="o">=</span> <span class="n">field_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">len_first_spectra</span> <span class="o">*</span> <span class="n">i</span><span class="p">)][</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="linenos"> 582</span>                        <span class="n">ax31</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="linenos"> 583</span>                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">field_spectra</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos"> 584</span>                    <span class="n">s</span> <span class="o">=</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span>
<span class="linenos"> 585</span>                    <span class="n">freq</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">Frequency</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="linenos"> 586</span>                    <span class="n">first_spectra</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 587</span>                    <span class="n">freq_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="linenos"> 588</span>                    <span class="n">first_spectra</span> <span class="o">=</span> <span class="n">first_spectra</span> <span class="o">*</span> <span class="n">freq_table</span>
<span class="linenos"> 589</span>                    <span class="n">freq</span> <span class="o">=</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">freq</span>
<span class="linenos"> 590</span>                    <span class="n">smin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smin&#39;</span><span class="p">,</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="linenos"> 591</span>                    <span class="n">smax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smax&#39;</span><span class="p">,</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="linenos"> 592</span>                    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smin</span><span class="p">),</span>
<span class="linenos"> 593</span>                                         <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smax</span><span class="p">),</span>
<span class="linenos"> 594</span>                                         <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;numlevels&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="linenos"> 595</span>                    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">field_spectra</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span>
<span class="linenos"> 596</span>                                    <span class="n">field_spectra</span><span class="o">.</span><span class="n">num</span><span class="p">)</span>
<span class="linenos"> 597</span>                    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax31</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
<span class="linenos"> 598</span>                        <span class="n">times</span><span class="p">,</span>  <span class="c1"># x = Time</span>
<span class="linenos"> 599</span>                        <span class="n">freq</span><span class="p">,</span>  <span class="c1"># y = Frequency</span>
<span class="linenos"> 600</span>                        <span class="n">first_spectra</span><span class="p">,</span>  <span class="c1"># z = all spectra</span>
<span class="linenos"> 601</span>                        <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">smin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">smax</span><span class="p">),</span>
<span class="linenos"> 602</span>                        <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
<span class="linenos"> 603</span>                        <span class="n">cmap</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contour_cm&#39;</span><span class="p">,</span>
<span class="linenos"> 604</span>                                        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">)),</span>
<span class="linenos"> 605</span>                        <span class="c1"># levels=kwargs.get(&#39;contour_levels&#39;),</span>
<span class="linenos"> 606</span>                    <span class="p">)</span>
<span class="linenos"> 607</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 608</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq</span>
<span class="linenos"> 609</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 610</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">time_spectra_field_contour_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
<span class="linenos"> 611</span>                        <span class="p">{</span><span class="s1">&#39;S</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_</span><span class="p">):</span> <span class="n">times</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">field_spectra</span><span class="o">.</span><span class="n">num</span><span class="p">)},</span>
<span class="linenos"> 612</span>                        <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 613</span>
<span class="linenos"> 614</span>                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax31</span><span class="p">)</span>
<span class="linenos"> 615</span>                    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$S_V^{(n)} (f) \cdot f$&#39;</span><span class="p">)</span>
<span class="linenos"> 616</span>                    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>
<span class="linenos"> 617</span>                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos"> 618</span>                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<span class="linenos"> 619</span>                        <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{V. Time-resolved PSD} ($</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1"> = &#39;</span>
<span class="linenos"> 620</span>                        <span class="s1">&#39;</span><span class="si">%.0f</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">show_field</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="linenos"> 621</span>                    <span class="p">)</span>
<span class="linenos"> 622</span>                    <span class="n">ax31</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f$ [Hz]&#39;</span><span class="p">)</span>
<span class="linenos"> 623</span>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos"> 624</span>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not plot field (H = </span><span class="si">%s</span><span class="s2">) data: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="linenos"> 625</span>                                  <span class="p">(</span><span class="n">show_field</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
<span class="linenos"> 626</span>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can not plot field (H = </span><span class="si">%s</span><span class="s2">) data: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="linenos"> 627</span>                                 <span class="p">(</span><span class="n">show_field</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
<span class="linenos"> 628</span>        <span class="n">ax31</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="linenos"> 629</span>
<span class="linenos"> 630</span>    <span class="k">def</span> <span class="nf">plot_various_noise_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 631</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
<span class="linenos"> 632</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 633</span>                                 <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">.45</span><span class="p">))</span>
<span class="linenos"> 634</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
<span class="linenos"> 635</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">4</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]</span>
<span class="linenos"> 636</span>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
<span class="linenos"> 637</span>                    <span class="s1">&#39;Field&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<span class="linenos"> 638</span>                <span class="c1"># Setting shortcut for Average Spectrum s</span>
<span class="linenos"> 639</span>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 640</span>
<span class="linenos"> 641</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos"> 642</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$S_V (f=</span><span class="si">%.3f</span><span class="s1">)$&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
<span class="linenos"> 643</span>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos"> 644</span>
<span class="linenos"> 645</span>    <span class="k">def</span> <span class="nf">plot_various_noise_fits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 646</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 647</span><span class="sd">        Args:</span>
<span class="linenos"> 648</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 649</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 650</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">)))</span>
<span class="linenos"> 651</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="linenos"> 652</span>                                 <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="linenos"> 653</span>                                 <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">.45</span><span class="p">),</span>
<span class="linenos"> 654</span>                                 <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>
<span class="linenos"> 655</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fit_range</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_ranges&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">))):</span>
<span class="linenos"> 656</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)][</span><span class="n">i</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="linenos"> 657</span>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<span class="linenos"> 658</span>                <span class="c1"># Setting shortcut for Average Spectrum s</span>
<span class="linenos"> 659</span>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 660</span>                <span class="n">fit</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lnf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">fit_range</span><span class="p">],</span>
<span class="linenos"> 661</span>                                             <span class="n">s</span><span class="o">.</span><span class="n">lnS</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">fit_range</span><span class="p">])</span>
<span class="linenos"> 662</span>
<span class="linenos"> 663</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;intercept&#39;</span><span class="p">:</span>
<span class="linenos"> 664</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos"> 665</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos"> 666</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 667</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos"> 668</span>
<span class="linenos"> 669</span>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Fit Range = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fit_range</span><span class="p">)</span>
<span class="linenos"> 670</span>        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Noise Fit at 1 Hz&#39;</span><span class="p">))</span>
<span class="linenos"> 671</span>
<span class="linenos"> 672</span>    <span class="k">def</span> <span class="nf">plot_compare_timesignals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 673</span>        <span class="sd">&quot;&quot;&quot; Plots a grid of 2x2 subplots to compare timesignals and histogram.</span>
<span class="linenos"> 674</span><span class="sd">        Args:</span>
<span class="linenos"> 675</span><span class="sd">            fields: list</span>
<span class="linenos"> 676</span><span class="sd">            factor: float Default: 1e3 (mV)</span>
<span class="linenos"> 677</span><span class="sd">            nrows: int Default: len(fields)</span>
<span class="linenos"> 678</span><span class="sd">            ncols: int Default: 2</span>
<span class="linenos"> 679</span><span class="sd">            sharey: bool Default: True</span>
<span class="linenos"> 680</span><span class="sd">            figsize: tuple Default: (11.69, 8.27) in</span>
<span class="linenos"> 681</span><span class="sd">            plot_range: int Default: -1</span>
<span class="linenos"> 682</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 683</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="linenos"> 684</span>                                 <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)),</span>
<span class="linenos"> 685</span>                                 <span class="n">sharey</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharey&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="linenos"> 686</span>                                 <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">)),</span>
<span class="linenos"> 687</span>                                 <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subplot_kw&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
<span class="linenos"> 688</span>        <span class="n">twinax</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 689</span>        <span class="n">factor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="linenos"> 690</span>        <span class="n">colors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colors&#39;</span><span class="p">,[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="linenos"> 691</span>                                     <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
<span class="linenos"> 692</span>                                     <span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="linenos"> 693</span>                                     <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="linenos"> 694</span>                                     <span class="s1">&#39;purple&#39;</span><span class="p">])</span>
<span class="linenos"> 695</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
<span class="linenos"> 696</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos"> 697</span>            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span> <span class="o">==</span>
<span class="linenos"> 698</span>                          <span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_range&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="linenos"> 699</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_kw&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 700</span>            <span class="n">twinax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">())</span>
<span class="linenos"> 701</span>            <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">twinax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dist_kw&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 702</span>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$V_H (</span><span class="se">\\</span><span class="s1">mathbf{</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">=</span><span class="si">%s</span><span class="se">\\</span><span class="s1">,mT})$&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">))])</span>
<span class="linenos"> 703</span>
<span class="linenos"> 704</span>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">twinax</span>
<span class="linenos"> 705</span>
<span class="linenos"> 706</span>    <span class="k">def</span> <span class="nf">plot_various_timesignals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 707</span>        <span class="sd">&quot;&quot;&quot; Plots a grid of 9 subplots with different timesignals</span>
<span class="linenos"> 708</span><span class="sd">        Args:</span>
<span class="linenos"> 709</span><span class="sd">            fields: list</span>
<span class="linenos"> 710</span><span class="sd">            nrows: int Default: len(fields)</span>
<span class="linenos"> 711</span><span class="sd">            ncols: int Default: 2</span>
<span class="linenos"> 712</span><span class="sd">            sharey: bool Default: True</span>
<span class="linenos"> 713</span><span class="sd">            figsize: tuple Default: (11.69, 8.27) in</span>
<span class="linenos"> 714</span><span class="sd">            plot_range: int Default: -1</span>
<span class="linenos"> 715</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 716</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)),</span>
<span class="linenos"> 717</span>                                 <span class="n">ncols</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="linenos"> 718</span>                                 <span class="n">sharey</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharey&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
<span class="linenos"> 719</span>                                 <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>
<span class="linenos"> 720</span>                                 <span class="p">)</span>
<span class="linenos"> 721</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
<span class="linenos"> 722</span>            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)][</span><span class="n">i</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="linenos"> 723</span>            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span> <span class="o">==</span>
<span class="linenos"> 724</span>                          <span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_range&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="linenos"> 725</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span>
<span class="linenos"> 726</span>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$V_H (</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">=</span><span class="si">%.1f</span><span class="se">\\</span><span class="s1">,</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">)$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)])</span>
<span class="linenos"> 727</span>
<span class="linenos"> 728</span>    <span class="k">def</span> <span class="nf">spectra_field_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 729</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 730</span><span class="sd">        Args:</span>
<span class="linenos"> 731</span><span class="sd">            ax:</span>
<span class="linenos"> 732</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 733</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 734</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
<span class="linenos"> 735</span>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="linenos"> 736</span>        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
<span class="linenos"> 737</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="linenos"> 738</span>
<span class="linenos"> 739</span>        <span class="c1"># Create variable for third dimension</span>
<span class="linenos"> 740</span>        <span class="n">spectra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 741</span>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
<span class="linenos"> 742</span>            <span class="n">average_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 743</span>            <span class="n">spectra_df</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">average_spectrum</span><span class="o">.</span><span class="n">S</span> <span class="o">*</span> \
<span class="linenos"> 744</span>                <span class="n">average_spectrum</span><span class="o">.</span><span class="n">freq</span>
<span class="linenos"> 745</span>        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span>
<span class="linenos"> 746</span>        <span class="n">smin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smin&#39;</span><span class="p">,</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="linenos"> 747</span>        <span class="n">smax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;smax&#39;</span><span class="p">,</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="linenos"> 748</span>        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smin</span><span class="p">),</span>
<span class="linenos"> 749</span>                             <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">smax</span><span class="p">),</span>
<span class="linenos"> 750</span>                             <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;numlevels&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="linenos"> 751</span>
<span class="linenos"> 752</span>        <span class="n">size_fields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
<span class="linenos"> 753</span>        <span class="n">size_freq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="linenos"> 754</span>        <span class="k">if</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">size_freq</span><span class="p">,</span> <span class="n">size_fields</span><span class="p">):</span>
<span class="linenos"> 755</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot plot contour:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
<span class="linenos"> 756</span>                              <span class="s1">&#39;spectra_df.shape (</span><span class="si">%s</span><span class="s1">) != &#39;</span> <span class="o">+</span> \
<span class="linenos"> 757</span>                              <span class="s1">&#39;size_freq (</span><span class="si">%s</span><span class="s1">), size_fields (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="p">(</span>
<span class="linenos"> 758</span>                                  <span class="n">spectra_df</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">size_freq</span><span class="p">,</span> <span class="n">size_fields</span><span class="p">))</span>
<span class="linenos"> 759</span>            <span class="k">return</span>
<span class="linenos"> 760</span>
<span class="linenos"> 761</span>        <span class="k">if</span> <span class="n">size_fields</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">size_freq</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos"> 762</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot plot contour: &#39;</span> <span class="o">+</span> \
<span class="linenos"> 763</span>                              <span class="s1">&#39;size_freq (</span><span class="si">%s</span><span class="s1">), size_fields (</span><span class="si">%s</span><span class="s1">) incorrect&#39;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos"> 764</span>                                  <span class="n">size_freq</span><span class="p">,</span> <span class="n">size_fields</span><span class="p">))</span>
<span class="linenos"> 765</span>            <span class="k">return</span>
<span class="linenos"> 766</span>
<span class="linenos"> 767</span>        <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">fields</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">spectra_df</span><span class="p">,</span>
<span class="linenos"> 768</span>                         <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">smin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">smax</span><span class="p">),</span>
<span class="linenos"> 769</span>                         <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
<span class="linenos"> 770</span>                         <span class="n">cmap</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contour_cm&#39;</span><span class="p">,</span>
<span class="linenos"> 771</span>                                         <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_cm&#39;</span><span class="p">)),</span>
<span class="linenos"> 772</span>                         <span class="p">)</span>
<span class="linenos"> 773</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour_df</span> <span class="o">=</span> <span class="n">spectra_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 774</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour_df</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frequencies</span>
<span class="linenos"> 775</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectra_field_contour_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 776</span>
<span class="linenos"> 777</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
<span class="linenos"> 778</span>            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos"> 779</span>            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">])</span>
<span class="linenos"> 780</span>            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V}</span><span class="s1"> (f) \cdot f$&#39;</span><span class="p">)</span>
<span class="linenos"> 781</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos"> 782</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos"> 783</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu_0 H_</span><span class="si">{ext}</span><span class="s1">$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mT}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos"> 784</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{II. PSD Contour Plot}&#39;</span><span class="p">))</span>
<span class="linenos"> 785</span>
<span class="linenos"> 786</span>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="linenos"> 787</span>        <span class="sd">&quot;&quot;&quot;Write data to a file.</span>
<span class="linenos"> 788</span>
<span class="linenos"> 789</span><span class="sd">        Args:</span>
<span class="linenos"> 790</span><span class="sd">            file (str):</span>
<span class="linenos"> 791</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 792</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
<span class="linenos"> 793</span>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="linenos"> 794</span>
<span class="linenos"> 795</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_fields.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 796</span>        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos"> 797</span>            <span class="n">m</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_spectrum_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">field</span><span class="p">))</span>
<span class="linenos"> 798</span>
<span class="linenos"> 799</span>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="linenos"> 800</span>        <span class="sd">&quot;&quot;&quot;Write data to a file.</span>
<span class="linenos"> 801</span>
<span class="linenos"> 802</span><span class="sd">        Args:</span>
<span class="linenos"> 803</span><span class="sd">            file (str):</span>
<span class="linenos"> 804</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 805</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_fields.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
<span class="linenos"> 806</span>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<span class="linenos"> 807</span>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>
<span class="linenos"> 808</span>            <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> \
<span class="linenos"> 809</span>                <span class="n">RAW</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]},</span>
<span class="linenos"> 810</span>                    <span class="n">rate</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span>
<span class="linenos"> 811</span>                    <span class="p">)</span>
<span class="linenos"> 812</span>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_spectrum_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span>
<span class="linenos"> 813</span>                                                                     <span class="n">field</span><span class="p">)):</span>
<span class="linenos"> 814</span>                <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="linenos"> 815</span>
<span class="linenos"> 816</span>    <span class="k">def</span> <span class="nf">subtract_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 817</span>        <span class="sd">&quot;&quot;&quot;Subtracts mean value from timesignal.</span>
<span class="linenos"> 818</span>
<span class="linenos"> 819</span><span class="sd">        :param inplace: Change variable inside this object?</span>
<span class="linenos"> 820</span><span class="sd">        :type inplace: bool</span>
<span class="linenos"> 821</span>
<span class="linenos"> 822</span><span class="sd">        :param fields: list of fields to fit</span>
<span class="linenos"> 823</span>
<span class="linenos"> 824</span><span class="sd">        :return: normalized timesignal</span>
<span class="linenos"> 825</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 826</span>
<span class="linenos"> 827</span>        <span class="n">df_fit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 828</span>        <span class="n">fields</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fields&#39;</span><span class="p">,</span>
<span class="linenos"> 829</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Field&#39;</span><span class="p">)[</span><span class="s1">&#39;Field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="linenos"> 830</span>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
<span class="linenos"> 831</span>            <span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field == @field&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos"> 832</span>            <span class="n">mean</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="linenos"> 833</span>            <span class="n">signal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">Vx</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span>
<span class="linenos"> 834</span>
<span class="linenos"> 835</span>            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<span class="linenos"> 836</span>                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Field</span> <span class="o">==</span> <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span> <span class="o">=</span> \
<span class="linenos"> 837</span>                    <span class="n">signal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span>
<span class="linenos"> 838</span>
<span class="linenos"> 839</span>            <span class="n">df_fit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_fit</span><span class="p">,</span> <span class="n">signal</span><span class="p">])</span>
<span class="linenos"> 840</span>        <span class="k">return</span> <span class="n">df_fit</span>
<span class="linenos"> 841</span>
<span class="linenos"> 842</span>    <span class="k">def</span> <span class="nf">plot_multiple_histograms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 843</span>                                 <span class="n">fields</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
<span class="linenos"> 844</span>                                 <span class="n">factor</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span>
<span class="linenos"> 845</span>                                 <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span>
<span class="linenos"> 846</span>                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 847</span>        <span class="sd">&quot;&quot;&quot;Plots multiple histograms using seaborn ``sns.FacetGrid``</span>
<span class="linenos"> 848</span><span class="sd">           with kdeplot.</span>
<span class="linenos"> 849</span><span class="sd">           </span>
<span class="linenos"> 850</span><span class="sd">           default kwargs for subplots:</span>
<span class="linenos"> 851</span><span class="sd">            kde1_kwargs = dict(clip_on=True, shade=True, alpha=1, lw=1.5, bw=.2)</span>
<span class="linenos"> 852</span><span class="sd">            kde2_kwargs = kde1_kwargs.update(dict(lw=2, color=&#39;w&#39;)</span>
<span class="linenos"> 853</span><span class="sd">            dist_kwargs = dict(hist=True, norm_hist=True, hist_kws={&#39;alpha&#39;: .5})</span>
<span class="linenos"> 854</span><span class="sd">            ax_kwargs = dict(y=0, lw=2, clip_on=True).set(xlim=(-1.3,1.3))</span>
<span class="linenos"> 855</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 856</span>        <span class="k">if</span> <span class="n">fields</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<span class="linenos"> 857</span>            <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="linenos"> 858</span>
<span class="linenos"> 859</span>        <span class="n">field_range</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">fields</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="linenos"> 860</span>        <span class="n">stepsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">field_range</span> <span class="o">/</span> <span class="n">steps</span><span class="p">)</span>
<span class="linenos"> 861</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<span class="linenos"> 862</span>            <span class="n">start</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">stepsize</span>
<span class="linenos"> 863</span>            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">stepsize</span>
<span class="linenos"> 864</span>            <span class="n">df_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtract_mean</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Field &gt;= @start and Field &lt; @end&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos"> 865</span>            <span class="n">df_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;normedVx&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">factor</span>
<span class="linenos"> 866</span>
<span class="linenos"> 867</span>            <span class="c1"># Initialize the FacetGrid object</span>
<span class="linenos"> 868</span>            <span class="n">pal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">dark_palette</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="s1">&#39;huls&#39;</span><span class="p">)</span>
<span class="linenos"> 869</span>            <span class="n">face_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">pal</span><span class="p">)</span>
<span class="linenos"> 870</span>            <span class="n">face_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;face_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 871</span>            <span class="n">kde1_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
<span class="linenos"> 872</span>            <span class="n">kde1_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kde1_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 873</span>            <span class="n">kde2_kwargs</span> <span class="o">=</span> <span class="n">kde1_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos"> 874</span>            <span class="n">kde2_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
<span class="linenos"> 875</span>            <span class="n">kde2_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kde2_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 876</span>            <span class="n">dist_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">})</span>
<span class="linenos"> 877</span>            <span class="n">dist_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dist_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 878</span>            <span class="n">ax_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 879</span>            <span class="n">ax_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax_kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>
<span class="linenos"> 880</span>
<span class="linenos"> 881</span>            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;Field&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Field&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">face_kwargs</span><span class="p">)</span>
<span class="linenos"> 882</span>            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="s2">&quot;normedVx&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kde1_kwargs</span><span class="p">)</span>
<span class="linenos"> 883</span>            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="s2">&quot;normedVx&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kde2_kwargs</span><span class="p">)</span>
<span class="linenos"> 884</span>            <span class="c1"># g.map(sns.distplot, &quot;normedVx&quot;, **dist_kwargs)</span>
<span class="linenos"> 885</span>            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">,</span> <span class="o">**</span><span class="n">ax_kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">)</span>
<span class="linenos"> 886</span>
<span class="linenos"> 887</span>            <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="linenos"> 888</span>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="linenos"> 889</span>                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;adjust_hspace&#39;</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span> <span class="n">label</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
<span class="linenos"> 890</span>                        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="linenos"> 891</span>                        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos"> 892</span>
<span class="linenos"> 893</span>            <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s2">&quot;normedVx&quot;</span><span class="p">)</span>
<span class="linenos"> 894</span>
<span class="linenos"> 895</span>            <span class="c1"># Set the subplots to overlap</span>
<span class="linenos"> 896</span>            <span class="n">g</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="o">-</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;adjust_hspace&#39;</span><span class="p">,</span> <span class="mf">.3</span><span class="p">))</span>
<span class="linenos"> 897</span>
<span class="linenos"> 898</span>            <span class="c1"># Remove axes details that don&#39;t play well with overlap</span>
<span class="linenos"> 899</span>            <span class="n">g</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="linenos"> 900</span>            <span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>  <span class="c1"># , xticks=[-100 + 50*_ for _ in range(5)])</span>
<span class="linenos"> 901</span>            <span class="n">g</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 902</span>            <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;mV&#39;</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mf">1e3</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">mu</span><span class="si">{}</span><span class="s1">V&#39;</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mf">1e6</span> <span class="k">else</span> <span class="s1">&#39;V&#39;</span>
<span class="linenos"> 903</span>            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$V_H$ [$</span><span class="se">\\</span><span class="s1">mathrm{</span><span class="si">%s</span><span class="s1">}$]&#39;</span> <span class="o">%</span> <span class="n">unit</span><span class="p">)</span>
<span class="linenos"> 904</span>
<span class="linenos"> 905</span>    <span class="k">def</span> <span class="nf">load_voltages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">508</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)):</span>
<span class="linenos"> 906</span>        <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">datapath</span><span class="p">):</span>
<span class="linenos"> 907</span>            <span class="n">meas_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 908</span>            <span class="n">meas_info</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 909</span>            <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 910</span>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">datapath</span><span class="p">:</span>
<span class="linenos"> 911</span>                <span class="n">f_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_info_from_name</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="linenos"> 912</span>                <span class="n">sr</span> <span class="o">=</span> <span class="n">f_info</span><span class="p">[</span><span class="s1">&#39;Vin&#39;</span><span class="p">]</span>
<span class="linenos"> 913</span>                <span class="n">nr</span> <span class="o">=</span> <span class="n">f_info</span><span class="p">[</span><span class="s1">&#39;nr&#39;</span><span class="p">]</span>
<span class="linenos"> 914</span>                <span class="n">meas_info</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_info</span>
<span class="linenos"> 915</span>                <span class="n">meas_data</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="linenos"> 916</span>                <span class="n">new_df</span> <span class="o">=</span> <span class="n">meas_data</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span>
<span class="linenos"> 917</span>                <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos"> 918</span>                <span class="k">if</span> <span class="n">nr</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos"> 919</span>                    <span class="n">all_data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_data</span><span class="p">[</span><span class="n">nr</span><span class="p">],</span> <span class="n">new_df</span><span class="p">])</span>
<span class="linenos"> 920</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 921</span>                    <span class="n">all_data</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_df</span>
<span class="linenos"> 922</span>            <span class="k">return</span> <span class="n">meas_data</span><span class="p">,</span> <span class="n">meas_info</span><span class="p">,</span> <span class="n">all_data</span>
<span class="linenos"> 923</span>
<span class="linenos"> 924</span>        <span class="k">def</span> <span class="nf">calc_PSD</span><span class="p">(</span><span class="n">meas_data</span><span class="p">):</span>
<span class="linenos"> 925</span>            <span class="n">meas_obj</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 926</span>            <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">data_df</span> <span class="ow">in</span> <span class="n">meas_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos"> 927</span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">:</span>
<span class="linenos"> 928</span>                    <span class="n">avg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">1024</span>
<span class="linenos"> 929</span>                    <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span> <span class="o">%</span> <span class="mi">1024</span><span class="p">)]</span>
<span class="linenos"> 930</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 931</span>                    <span class="n">d</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">Vx</span>
<span class="linenos"> 932</span>
<span class="linenos"> 933</span>                <span class="n">max_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="linenos"> 934</span>
<span class="linenos"> 935</span>                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 936</span>                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span>
<span class="linenos"> 937</span>                    <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 938</span>                        <span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="n">meas_info</span><span class="p">[</span><span class="n">sr</span><span class="p">][</span><span class="s1">&#39;nr&#39;</span><span class="p">],</span>
<span class="linenos"> 939</span>                        <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="linenos"> 940</span>                        <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="n">max_len</span> <span class="o">*</span> <span class="n">data_df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="linenos"> 941</span>                    <span class="p">}</span>
<span class="linenos"> 942</span>                <span class="p">}</span>
<span class="linenos"> 943</span>
<span class="linenos"> 944</span>                <span class="n">meas_obj</span><span class="p">[</span><span class="n">sr</span><span class="p">]</span> <span class="o">=</span> <span class="n">RAW</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="linenos"> 945</span>                                   <span class="n">rate</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;rate&#39;</span><span class="p">],</span>
<span class="linenos"> 946</span>                                   <span class="n">nof_first_spectra</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
<span class="linenos"> 947</span>                                   <span class="n">calc_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 948</span>                                   <span class="n">downsample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 949</span>                                   <span class="p">)</span>
<span class="linenos"> 950</span>            <span class="k">return</span> <span class="n">meas_obj</span>
<span class="linenos"> 951</span>
<span class="linenos"> 952</span>        <span class="k">def</span> <span class="nf">merge_data</span><span class="p">(</span><span class="n">meas_obj</span><span class="p">,</span> <span class="n">cutoff_frequency</span><span class="o">=</span><span class="mf">.9</span><span class="p">):</span>
<span class="linenos"> 953</span>            <span class="n">diff_voltages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 954</span>            <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meas_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos"> 955</span>                <span class="n">s</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">avg_spec</span>
<span class="linenos"> 956</span>                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="n">cutoff_frequency</span><span class="p">]</span>
<span class="linenos"> 957</span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos"> 958</span>                    <span class="k">continue</span>
<span class="linenos"> 959</span>                <span class="n">newdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 960</span>                <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">freq</span>
<span class="linenos"> 961</span>                <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">S</span>
<span class="linenos"> 962</span>                <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos"> 963</span>                <span class="n">diff_voltages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="n">newdf</span><span class="p">])</span>
<span class="linenos"> 964</span>            <span class="k">return</span> <span class="n">diff_voltages</span>
<span class="linenos"> 965</span>
<span class="linenos"> 966</span>        <span class="k">def</span> <span class="nf">plot_PSD_classic</span><span class="p">(</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">groupby_category</span><span class="o">=</span><span class="s1">&#39;Vin&#39;</span><span class="p">,</span>
<span class="linenos"> 967</span>                             <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;science&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;bright&#39;</span><span class="p">,</span> <span class="p">}]):</span>
<span class="linenos"> 968</span>            <span class="n">set_style</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
<span class="linenos"> 969</span>            <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="linenos"> 970</span>            <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="linenos"> 971</span>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="linenos"> 972</span>            <span class="c1"># g = sns.relplot(x=&#39;freq&#39;, y=&#39;S&#39;, hue=&#39;Vin&#39;, data=diff_voltages, height=5, kind=&#39;line&#39;)</span>
<span class="linenos"> 973</span>            <span class="n">grouped</span> <span class="o">=</span> <span class="n">diff_voltages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupby_category</span><span class="p">)</span>
<span class="linenos"> 974</span>            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos"> 975</span>                <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
<span class="linenos"> 976</span>                                              <span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="linenos"> 977</span>                                              <span class="n">label</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
<span class="linenos"> 978</span>                                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">,</span>
<span class="linenos"> 979</span>                                              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1">$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">^2/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">,</span>
<span class="linenos"> 980</span>                                              <span class="p">)</span>
<span class="linenos"> 981</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="linenos"> 982</span>            <span class="c1"># save_plot(&#39;m506&#39;, &#39;png&#39;)</span>
<span class="linenos"> 983</span>
<span class="linenos"> 984</span>        <span class="k">def</span> <span class="nf">show_PSD_classic</span><span class="p">(</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">groupby_category</span><span class="o">=</span><span class="s1">&#39;Vin&#39;</span><span class="p">,</span>
<span class="linenos"> 985</span>                             <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;science&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;talk&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="s1">&#39;bright&#39;</span><span class="p">,</span> <span class="p">}]):</span>
<span class="linenos"> 986</span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
<span class="linenos"> 987</span>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="linenos"> 988</span>            <span class="n">set_style</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
<span class="linenos"> 989</span>            <span class="n">c1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="linenos"> 990</span>            <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="linenos"> 991</span>            <span class="c1"># g = sns.relplot(x=&#39;freq&#39;, y=&#39;S&#39;, hue=&#39;Vin&#39;, data=diff_voltages, height=5, kind=&#39;line&#39;)</span>
<span class="linenos"> 992</span>            <span class="n">grouped</span> <span class="o">=</span> <span class="n">diff_voltages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupby_category</span><span class="p">)</span>
<span class="linenos"> 993</span>            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos"> 994</span>                <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
<span class="linenos"> 995</span>                                              <span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<span class="linenos"> 996</span>                                              <span class="n">label</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
<span class="linenos"> 997</span>                                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">,</span>
<span class="linenos"> 998</span>                                              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1">$ [$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{V}</span><span class="s1">^2/</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Hz}</span><span class="s1">$]&#39;</span><span class="p">,</span>
<span class="linenos"> 999</span>                                              <span class="p">)</span>
<span class="linenos">1000</span>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="linenos">1001</span>            <span class="k">return</span> <span class="n">ax</span>
<span class="linenos">1002</span>
<span class="linenos">1003</span>        <span class="n">datapath</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./data/MFN/m</span><span class="si">%s</span><span class="s1">/*&#39;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">)</span>
<span class="linenos">1004</span>        <span class="n">meas_data</span><span class="p">,</span> <span class="n">meas_info</span><span class="p">,</span> <span class="n">all_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">datapath</span><span class="p">)</span>
<span class="linenos">1005</span>        <span class="n">meas_obj</span> <span class="o">=</span> <span class="n">calc_PSD</span><span class="p">(</span><span class="n">meas_data</span><span class="p">)</span>
<span class="linenos">1006</span>        <span class="n">diff_voltages</span> <span class="o">=</span> <span class="n">merge_data</span><span class="p">(</span><span class="n">meas_obj</span><span class="p">)</span>
<span class="linenos">1007</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="linenos">1008</span>        <span class="n">show_PSD_classic</span><span class="p">(</span><span class="n">diff_voltages</span><span class="p">,</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: Compare different Voltages&#39;</span> <span class="o">%</span> <span class="n">nr</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos">1009</span>
<span class="linenos">1010</span>        <span class="n">inset2</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1011</span>                            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.54</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1012</span>                            <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1013</span>        <span class="n">inset3</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span>
<span class="linenos">1014</span>                            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.25</span><span class="p">),</span>
<span class="linenos">1015</span>                            <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="linenos">1016</span>
<span class="linenos">1017</span>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">diff_voltages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Vin&#39;</span><span class="p">)</span>
<span class="linenos">1018</span>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos">1019</span>            <span class="n">g</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="linenos">1020</span>            <span class="n">fit_area</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;freq &gt; </span><span class="si">%f</span><span class="s1"> and freq &lt; </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">2e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">))</span>
<span class="linenos">1021</span>            <span class="n">fit_area</span><span class="p">[</span><span class="s1">&#39;lnf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
<span class="linenos">1022</span>            <span class="n">fit_area</span><span class="p">[</span><span class="s1">&#39;lnS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
<span class="linenos">1023</span>            <span class="n">fit</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">lnf</span><span class="p">,</span> <span class="n">fit_area</span><span class="o">.</span><span class="n">lnS</span><span class="p">)</span>
<span class="linenos">1024</span>            <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="o">-</span><span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
<span class="linenos">1025</span>            <span class="n">voltage</span> <span class="o">=</span> <span class="n">group</span>
<span class="linenos">1026</span>
<span class="linenos">1027</span>            <span class="n">inset2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">intercept</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1028</span>            <span class="n">inset3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="linenos">1029</span>
<span class="linenos">1030</span>        <span class="n">inset2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Voltage [$\mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos">1031</span>        <span class="n">inset2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1"> (f=1</span><span class="se">\\</span><span class="s1">;$Hz$)$&#39;</span><span class="p">)</span>
<span class="linenos">1032</span>        <span class="n">inset2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="linenos">1033</span>
<span class="linenos">1034</span>        <span class="n">inset3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Voltage [$\mathrm</span><span class="si">{V}</span><span class="s1">$]&#39;</span><span class="p">)</span>
<span class="linenos">1035</span>        <span class="n">inset3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id30">
<h3><a class="toc-backref" href="#id67" role="doc-backlink">MeasurementClass</a><a class="headerlink" href="#id30" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">class</span> <span class="nc">MeasurementClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="linenos">  2</span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  3</span><span class="sd">        The main measurement class for all measurements.</span>
<span class="linenos">  4</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">  5</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">  6</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  7</span><span class="sd">        .. note:: **MeasurementClass:**</span>
<span class="linenos">  8</span><span class="sd">            This Class is the parent of all other measurement classes.</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="sd">        All measurements have the following variables:</span>
<span class="linenos"> 12</span><span class="sd">            </span>
<span class="linenos"> 13</span><span class="sd">        name: str/None</span>
<span class="linenos"> 14</span><span class="sd">            The name of the Measurement Class (e.g. SA, RAW, etc.)</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span><span class="sd">        info: dict</span>
<span class="linenos"> 17</span><span class="sd">            Contains informations about the measurement. Typical keys are:                </span>
<span class="linenos"> 18</span><span class="sd">                Nr: float, the number of the measurement,</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 21</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="linenos"> 22</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 23</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Nr&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="linenos"> 24</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info_file</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 25</span>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">PlottingClass</span><span class="p">()</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span>    <span class="k">def</span> <span class="nf">i</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">key</span><span class="p">):</span>
<span class="linenos"> 28</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 29</span><span class="sd">        Get  a specific measurement number information.</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span><span class="sd">        </span>
<span class="linenos"> 32</span><span class="sd">        :param *key: Will be passed to info.get</span>
<span class="linenos"> 33</span><span class="sd">        </span>
<span class="linenos"> 34</span><span class="sd">        :return: info.get(*key)</span>
<span class="linenos"> 35</span>
<span class="linenos"> 36</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 37</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span>    <span class="fm">__repr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (Nr. </span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span>    <span class="fm">__str__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (Nr. </span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> \
<span class="linenos"> 43</span>        <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="linenos"> 44</span>    
<span class="linenos"> 45</span>    
<span class="linenos"> 46</span>    <span class="k">def</span> <span class="nf">get_info_from_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 47</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 48</span><span class="sd">        Extracting information from filenames.</span>
<span class="linenos"> 49</span><span class="sd">        Using a default regex first or trying to extract &#39;key-value&#39; pairs</span>
<span class="linenos"> 50</span><span class="sd">        separated by &#39;_&#39;.</span>
<span class="linenos"> 51</span><span class="sd">    </span>
<span class="linenos"> 52</span><span class="sd">        :param name: filename that contains informations.</span>
<span class="linenos"> 53</span><span class="sd">        :param kwargs:</span>
<span class="linenos"> 54</span><span class="sd">            :str regex: Regular expression for the filename</span>
<span class="linenos"> 55</span><span class="sd">        :return: dict(key=value)</span>
<span class="linenos"> 56</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 57</span>    
<span class="linenos"> 58</span>        <span class="c1"># Default Regex Structure</span>
<span class="linenos"> 59</span>        <span class="c1"># Nr,     Struct,         deg,        Type1</span>
<span class="linenos"> 60</span>        <span class="c1"># Type2, Field, Date, Time</span>
<span class="linenos"> 61</span>        <span class="c1"># I1, I2, Lock-In (Connections)</span>
<span class="linenos"> 62</span>        <span class="c1"># Voltage In, Resistors (R11, R12)</span>
<span class="linenos"> 63</span>        <span class="c1"># R13, R21</span>
<span class="linenos"> 64</span>        <span class="c1"># Capacitors (C11, C21)</span>
<span class="linenos"> 65</span>        <span class="c1"># Temp</span>
<span class="linenos"> 66</span>        <span class="n">def_regex</span> <span class="o">=</span> <span class="s2">&quot;.*[Mm]([0-9.]*)_([A-Za-z]*)_([0-9.-]*)deg_([A-Za-z]*)_&quot;</span> \
<span class="linenos"> 67</span>                    <span class="s2">&quot;([A-Za-z]*)_*B_([0-9.-]*)T_([0-9]*)_([0-9]*)_I1-([&quot;</span> \
<span class="linenos"> 68</span>                    <span class="s2">&quot;0-9</span><span class="se">\\</span><span class="s2">-]*)_I2-([0-9</span><span class="se">\\</span><span class="s2">-]*)_G[PB]I[BP].-([0-9</span><span class="se">\\</span><span class="s2">-]*)_Vin-([&quot;</span> \
<span class="linenos"> 69</span>                    <span class="s2">&quot;0-9.]*)V_R11-([0-9]*.)O_R12-([0-9.]*.)O_R13-([&quot;</span> \
<span class="linenos"> 70</span>                    <span class="s2">&quot;0-9.]*.)_R21-([0-9.]*.)O_C11-([0-9]*)_C21-([0-9]*)_T-([&quot;</span> \
<span class="linenos"> 71</span>                    <span class="s2">&quot;0-9]*)K.*&quot;</span>
<span class="linenos"> 72</span>        <span class="n">regex</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;regex&#39;</span><span class="p">,</span> <span class="n">def_regex</span><span class="p">)</span>
<span class="linenos"> 73</span>        <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="linenos"> 74</span>    
<span class="linenos"> 75</span>        <span class="n">info_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="linenos"> 76</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
<span class="linenos"> 77</span>            <span class="n">filename</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="linenos"> 78</span>            <span class="n">raw_info</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="linenos"> 79</span>            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">raw_info</span><span class="p">:</span>
<span class="linenos"> 80</span>                <span class="n">regex_dict</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 81</span>                    <span class="s1">&#39;nr&#39;</span><span class="p">:</span> <span class="s1">&#39;m([0-9.]*)&#39;</span><span class="p">,</span>
<span class="linenos"> 82</span>                    <span class="s1">&#39;deg&#39;</span><span class="p">:</span> <span class="s1">&#39;((neg)?[0-9.-]*)deg&#39;</span><span class="p">,</span>
<span class="linenos"> 83</span>                    <span class="s1">&#39;dir&#39;</span><span class="p">:</span> <span class="s1">&#39;([Uu]p|[Dd]own)&#39;</span><span class="p">,</span>
<span class="linenos"> 84</span>                    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;(20[12][90][0-9]*)&#39;</span><span class="p">,</span>
<span class="linenos"> 85</span>                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;([012][0-9][0-6]*)&#39;</span><span class="p">,</span>
<span class="linenos"> 86</span>                    <span class="s1">&#39;type1&#39;</span><span class="p">:</span> <span class="s1">&#39;(RAW|Hloop)&#39;</span><span class="p">,</span>
<span class="linenos"> 87</span>                    <span class="s1">&#39;type2&#39;</span><span class="p">:</span> <span class="s1">&#39;(Parallel|Gradio)&#39;</span><span class="p">,</span>
<span class="linenos"> 88</span>                    <span class="s1">&#39;struct&#39;</span><span class="p">:</span> <span class="s1">&#39;([Pp]lusses|[Cc]rosses|[Ee]mpty)&#39;</span><span class="p">,</span>
<span class="linenos"> 89</span>                    <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="s1">&#39;p?m?([0-9.-]+)m?T&#39;</span><span class="p">,</span>
<span class="linenos"> 90</span>                <span class="p">}</span>
<span class="linenos"> 91</span>                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">):</span>
<span class="linenos"> 92</span>                    <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 93</span>                    <span class="k">continue</span>
<span class="linenos"> 94</span>    
<span class="linenos"> 95</span>                <span class="n">items</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="linenos"> 96</span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos"> 97</span>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">single_regex</span> <span class="ow">in</span> <span class="n">regex_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos"> 98</span>                        <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">single_regex</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos"> 99</span>                        <span class="k">if</span> <span class="n">reg</span><span class="p">:</span>
<span class="linenos">100</span>                            <span class="n">info_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">101</span>                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">102</span>                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">items</span>
<span class="linenos">103</span>                    <span class="n">info_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="linenos">104</span>                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">105</span>                    <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="linenos">106</span>                    <span class="n">info_dict</span><span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
<span class="linenos">107</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">108</span>            <span class="n">nr</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">type1</span><span class="p">,</span> \
<span class="linenos">109</span>                <span class="n">type2</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> \
<span class="linenos">110</span>                <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">lock_in</span><span class="p">,</span> \
<span class="linenos">111</span>                <span class="n">vin</span><span class="p">,</span> <span class="n">r11</span><span class="p">,</span> <span class="n">r12</span><span class="p">,</span> <span class="n">r13</span><span class="p">,</span> <span class="n">r21</span><span class="p">,</span> \
<span class="linenos">112</span>                <span class="n">c11</span><span class="p">,</span> <span class="n">c21</span><span class="p">,</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="linenos">113</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos">114</span>                <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;nr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
<span class="linenos">115</span>                <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="linenos">116</span>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="linenos">117</span>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Expected float field and nr, got:&#39;</span>
<span class="linenos">118</span>                                  <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">nr</span><span class="p">))</span>
<span class="linenos">119</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;srtuct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span>
<span class="linenos">120</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;deg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deg</span>
<span class="linenos">121</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;type1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type1</span>
<span class="linenos">122</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;type2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type2</span>
<span class="linenos">123</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span>
<span class="linenos">124</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>
<span class="linenos">125</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i1</span>
<span class="linenos">126</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;i2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i2</span>
<span class="linenos">127</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;lock_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lock_in</span>
<span class="linenos">128</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r11&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r11</span>
<span class="linenos">129</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r12&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r12</span>
<span class="linenos">130</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r13</span>
<span class="linenos">131</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;r21&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r21</span>
<span class="linenos">132</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vin</span>
<span class="linenos">133</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;c11&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c11</span>
<span class="linenos">134</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;c21&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c21</span>
<span class="linenos">135</span>            <span class="n">info_dict</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
<span class="linenos">136</span>   
<span class="linenos">137</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info_file</span> <span class="o">=</span> <span class="n">info_dict</span>
<span class="linenos">138</span>        
<span class="linenos">139</span>        <span class="k">return</span> <span class="n">info_dict</span>
<span class="linenos">140</span>
<span class="linenos">141</span>    <span class="k">def</span> <span class="nf">calc_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vy&#39;</span><span class="p">]):</span>
<span class="linenos">142</span>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
<span class="linenos">143</span>            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ln</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id31">
<h3><a class="toc-backref" href="#id68" role="doc-backlink">SingleM</a><a class="headerlink" href="#id31" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">SingleM</span><span class="p">(</span><span class="n">MeasurementClass</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 3</span>        <span class="sd">&quot;&quot;&quot;The main constructor for all single measurements.&quot;&quot;&quot;</span>
<span class="linenos"> 4</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 5</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>    <span class="n">linear_regression</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos"> 8</span>    
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="nf">fit_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="linenos">10</span>        <span class="sd">&quot;&quot;&quot;Applys a linear regression and adds result to DataFrame</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="sd">        Args:</span>
<span class="linenos">13</span><span class="sd">            df (pd.DataFrame): Fit data</span>
<span class="linenos">14</span><span class="sd">            x (np.ndarray): Fit variable.</span>
<span class="linenos">15</span><span class="sd">            y (np.ndarray): Fit variable.</span>
<span class="linenos">16</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">17</span>        <span class="n">fit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_regression</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos">18</span>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span>
<span class="linenos">19</span>            <span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">20</span>    
<span class="linenos">21</span>        <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</section>
<section id="id32">
<h3><a class="toc-backref" href="#id69" role="doc-backlink">RAW</a><a class="headerlink" href="#id32" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">class</span> <span class="nc">RAW</span><span class="p">(</span><span class="n">SingleM</span><span class="p">):</span>
<span class="linenos">  2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  3</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  4</span><span class="sd">        RAW Measurement:</span>
<span class="linenos">  5</span><span class="sd">            Measurements with time signal only.</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">  8</span><span class="sd">           :linenos:</span>
<span class="linenos">  9</span><span class="sd">           :caption: Example</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="sd">           data = np.array(timesignal, shape=(n,))</span>
<span class="linenos"> 12</span><span class="sd">           data = {</span>
<span class="linenos"> 13</span><span class="sd">                &#39;data&#39;: np.array(timesignal, shape=(n,))</span>
<span class="linenos"> 14</span><span class="sd">                &#39;info&#39;: {&#39;Nr&#39;: 123, &#39;Add Info&#39;: &#39;Important Informations&#39;}</span>
<span class="linenos"> 15</span><span class="sd">                }</span>
<span class="linenos"> 16</span><span class="sd">           raw = ana.RAW(data)</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="sd">        :param data: Different possibilities.</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="sd">        :param rate: At which rate was the timesignal measured (samplingrate) [Hz]</span>
<span class="linenos"> 21</span><span class="sd">        :type rate: float, default: 2e-4</span>
<span class="linenos"> 22</span>
<span class="linenos"> 23</span><span class="sd">        :info: First Spectrum parameters</span>
<span class="linenos"> 24</span><span class="sd">        :param nof_first_spectra: Cut timesignal into # pieces and average.</span>
<span class="linenos"> 25</span><span class="sd">        :type nof_first_spectra: int, default: 64</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="sd">        :param first_spectra_highest_frequency: Cut higher frequencies in final spectrum than this.</span>
<span class="linenos"> 28</span><span class="sd">        :type first_spectra_highest_frequency: float, default: rate/8</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="sd">        :param downsample: Downsample the timesignal before calculation.</span>
<span class="linenos"> 31</span><span class="sd">        :type downsamle: bool, default: True</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="sd">        :param calc_first: Triggers calculation of first spectrum.</span>
<span class="linenos"> 34</span><span class="sd">        :type calc_first: bool, default: False</span>
<span class="linenos"> 35</span>
<span class="linenos"> 36</span><span class="sd">        :info: Second Spectrum parameters</span>
<span class="linenos"> 37</span><span class="sd">        :param highest_octave: The highest octave starting point [Hz] of the second spectrum.</span>
<span class="linenos"> 38</span><span class="sd">        :type highest_octave: int, default: 64</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span><span class="sd">        :param minimum_points_in_octave: If octave would contain less points, stop.</span>
<span class="linenos"> 41</span><span class="sd">        :type minimum_points_in_octave: int, default: 10</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span><span class="sd">        :param calc_second: Triggers calculation of second spectrum.</span>
<span class="linenos"> 44</span><span class="sd">        :type calc_second: bool, default: False</span>
<span class="linenos"> 45</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 46</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 47</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;RAW&#39;</span><span class="p">)</span>
<span class="linenos"> 48</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RAW&#39;</span>
<span class="linenos"> 49</span>        <span class="c1"># Default Parameter for the first and second spectrum</span>
<span class="linenos"> 50</span>        <span class="n">timesignal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> 
<span class="linenos"> 51</span>                              <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timesignal&#39;</span><span class="p">,</span> 
<span class="linenos"> 52</span>                                         <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="linenos"> 53</span>                                         <span class="p">)</span>
<span class="linenos"> 54</span>                              <span class="p">)</span>
<span class="linenos"> 55</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="linenos"> 56</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
<span class="linenos"> 57</span>        <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span> <span class="mf">2e-4</span><span class="p">)</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span>        <span class="c1"># Define dummies</span>
<span class="linenos"> 60</span>        <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos"> 61</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos"> 62</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 63</span>        <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos"> 64</span>        <span class="bp">self</span><span class="o">.</span><span class="n">freq2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="linenos"> 65</span>        <span class="bp">self</span><span class="o">.</span><span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="linenos"> 66</span>        <span class="bp">self</span><span class="o">.</span><span class="n">second_spectrum_time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span>        <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_timesignal</span><span class="p">(</span><span class="n">timesignal</span><span class="p">)</span>
<span class="linenos"> 69</span>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">)</span>
<span class="linenos"> 70</span>        <span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;highest_octave&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="linenos"> 71</span>        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_points_in_octave</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;minimum_points_in_octave&#39;</span><span class="p">,</span>
<span class="linenos"> 72</span>                                                   <span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 73</span>        <span class="bp">self</span><span class="o">.</span><span class="n">shifting_method</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos"> 74</span>        <span class="bp">self</span><span class="o">.</span><span class="n">short_mode</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 75</span>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;lowpass&#39;</span>
<span class="linenos"> 76</span>        <span class="bp">self</span><span class="o">.</span><span class="n">passband_factor</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 77</span>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="linenos"> 78</span>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_analog</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos"> 79</span>        <span class="bp">self</span><span class="o">.</span><span class="n">downsample</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;downsample&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 80</span>        <span class="bp">self</span><span class="o">.</span><span class="n">f_max</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="linenos"> 81</span>            <span class="s1">&#39;first_spectra_highest_frequency&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="linenos"> 82</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nof_first_spectra&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos"> 85</span>            <span class="s2">&quot;Time&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
<span class="linenos"> 86</span>            <span class="s2">&quot;Num&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span>
<span class="linenos"> 87</span>            <span class="s2">&quot;Rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
<span class="linenos"> 88</span>            <span class="s2">&quot;Avg&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">,</span>
<span class="linenos"> 89</span>            <span class="s2">&quot;downsample&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">,</span>
<span class="linenos"> 90</span>            <span class="s2">&quot;f_max&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">,</span>
<span class="linenos"> 91</span>            <span class="s2">&quot;NofSpectra&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">,</span>
<span class="linenos"> 92</span>        <span class="p">})</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_first&#39;</span><span class="p">):</span>
<span class="linenos"> 95</span>            <span class="bp">self</span><span class="o">.</span><span class="n">calc_first_spectrum</span><span class="p">()</span>
<span class="linenos"> 96</span>            
<span class="linenos"> 97</span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<span class="linenos"> 98</span>                <span class="k">return</span> 
<span class="linenos"> 99</span>            
<span class="linenos">100</span>            <span class="n">max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">101</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos">102</span>                <span class="c1"># &quot;f_min&quot;: freq[0],</span>
<span class="linenos">103</span>                <span class="c1"># &#39;f_max&#39;: freq.max(),</span>
<span class="linenos">104</span>                <span class="s2">&quot;f_min&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos">105</span>                <span class="s1">&#39;f_max&#39;</span><span class="p">:</span> <span class="n">max_freq</span><span class="p">,</span>
<span class="linenos">106</span>            <span class="p">})</span>
<span class="linenos">107</span>
<span class="linenos">108</span>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;calc_second&#39;</span><span class="p">):</span>
<span class="linenos">109</span>                <span class="bp">self</span><span class="o">.</span><span class="n">calc_second_spectrum</span><span class="p">(</span><span class="n">highest_octave</span><span class="o">=</span><span class="n">max_freq</span><span class="p">)</span>
<span class="linenos">110</span>
<span class="linenos">111</span>    <span class="k">def</span> <span class="nf">check_timesignal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timesignal</span><span class="p">):</span>
<span class="linenos">112</span>        <span class="sd">&quot;&quot;&quot; converts pd.DataFrame[&#39;Vx&#39;] and Series into numpy array.</span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="sd">        :param timesignal: input timesignal</span>
<span class="linenos">115</span><span class="sd">        :return: converted timesignal.</span>
<span class="linenos">116</span><span class="sd">        :rtype: numpy.ndarray</span>
<span class="linenos">117</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">118</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="linenos">119</span>            <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesignal</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">])</span>
<span class="linenos">120</span>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<span class="linenos">121</span>            <span class="n">ts</span> <span class="o">=</span> <span class="n">timesignal</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="linenos">122</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">123</span>            <span class="n">ts</span> <span class="o">=</span> <span class="n">timesignal</span>
<span class="linenos">124</span>
<span class="linenos">125</span>        <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1024.</span><span class="p">)</span>
<span class="linenos">126</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">):</span>
<span class="linenos">127</span>            <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1024</span><span class="p">)</span>
<span class="linenos">128</span>            <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)]</span>
<span class="linenos">129</span>
<span class="linenos">130</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">131</span>            <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">132</span>
<span class="linenos">133</span>        <span class="k">return</span> <span class="n">ts</span>
<span class="linenos">134</span>
<span class="linenos">135</span>    <span class="k">def</span> <span class="nf">calc_first_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">136</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">137</span><span class="sd">        Sets the variable ``spectrum`` to a</span>
<span class="linenos">138</span><span class="sd">        :class:`spectrumanalyzer.SpectrumAnalyzer` object.</span>
<span class="linenos">139</span>
<span class="linenos">140</span><span class="sd">        .. important::</span>
<span class="linenos">141</span><span class="sd">            Calculates the first spectrum.</span>
<span class="linenos">142</span>
<span class="linenos">143</span><span class="sd">        </span>
<span class="linenos">144</span><span class="sd">        :raises NameError: spectrumanalyzer is not installed</span>
<span class="linenos">145</span><span class="sd">        :return: None</span>
<span class="linenos">146</span>
<span class="linenos">147</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">148</span>        
<span class="linenos">149</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">150</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">SpectrumAnalyzer</span><span class="p">(</span>
<span class="linenos">151</span>                <span class="c1"># filepath=filename,</span>
<span class="linenos">152</span>                <span class="n">timesignal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span>
<span class="linenos">153</span>                <span class="n">samplingrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
<span class="linenos">154</span>                <span class="n">averages</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">,</span>
<span class="linenos">155</span>                <span class="n">shifting_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shifting_method</span><span class="p">,</span>
<span class="linenos">156</span>                <span class="n">short_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">short_mode</span><span class="p">,</span>
<span class="linenos">157</span>                <span class="n">filter_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span><span class="p">,</span>
<span class="linenos">158</span>                <span class="n">passband_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">passband_factor</span><span class="p">,</span>
<span class="linenos">159</span>                <span class="n">filter_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">,</span>
<span class="linenos">160</span>                <span class="n">filter_analog</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_analog</span><span class="p">,</span>
<span class="linenos">161</span>                <span class="n">first_spectra_highest_frequency</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">,</span>
<span class="linenos">162</span>                <span class="n">downsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">,</span>
<span class="linenos">163</span>            <span class="p">)</span>
<span class="linenos">164</span>        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
<span class="linenos">165</span>            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;SpectrumAnalyzer module not installed.&quot;</span><span class="p">)</span>
<span class="linenos">166</span>
<span class="linenos">167</span>        <span class="k">for</span> <span class="n">spectrum_arr</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">cut_timesignal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">):</span>
<span class="linenos">168</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spectrum_arr</span><span class="p">)</span>
<span class="linenos">169</span>
<span class="linenos">170</span>        <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="linenos">171</span>            <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span><span class="p">,</span>
<span class="linenos">172</span>            <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectrum</span><span class="p">})</span>
<span class="linenos">173</span>
<span class="linenos">174</span>    <span class="k">def</span> <span class="nf">calc_second_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">175</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">176</span><span class="sd">        Calculating the second spectrum.</span>
<span class="linenos">177</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">178</span>
<span class="linenos">179</span>        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">calculate_second_spectrum</span><span class="p">(</span>
<span class="linenos">180</span>            <span class="n">highest_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;highest_octave&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span><span class="p">),</span>
<span class="linenos">181</span>            <span class="n">minimum_points_in_octave</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;minimum_points_in_octave&#39;</span><span class="p">,</span>
<span class="linenos">182</span>                                                <span class="bp">self</span><span class="o">.</span><span class="n">minimum_points_in_octave</span><span class="p">),</span>
<span class="linenos">183</span>            <span class="n">peak_filter</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;peak_filter&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="linenos">184</span>        <span class="p">)</span>
<span class="linenos">185</span>
<span class="linenos">186</span>        <span class="bp">self</span><span class="o">.</span><span class="n">freq2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span><span class="p">[</span>
<span class="linenos">187</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="linenos">188</span>            <span class="p">]</span>
<span class="linenos">189</span>
<span class="linenos">190</span>        <span class="n">octaves</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span><span class="p">]</span>
<span class="linenos">191</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="linenos">192</span>            <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span>
<span class="linenos">193</span>                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_first_spectra</span><span class="p">),</span>
<span class="linenos">194</span>                <span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
<span class="linenos">195</span>            <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="linenos">196</span>            <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">]</span>
<span class="linenos">197</span>            <span class="n">points_in_octave</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
<span class="linenos">198</span>                <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">highest_octave</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))])</span>
<span class="linenos">199</span>            <span class="n">number_of_octaves</span> <span class="o">=</span> <span class="n">i</span>
<span class="linenos">200</span>            <span class="k">if</span> <span class="n">points_in_octave</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_points_in_octave</span><span class="p">:</span>
<span class="linenos">201</span>                <span class="k">break</span>
<span class="linenos">202</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">203</span>                <span class="n">octaves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">octaves</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">],</span> <span class="n">octaves</span><span class="p">)</span>
<span class="linenos">204</span>
<span class="linenos">205</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos">206</span>            <span class="s1">&#39;NofOct&#39;</span><span class="p">:</span> <span class="n">number_of_octaves</span><span class="p">,</span>
<span class="linenos">207</span>        <span class="p">})</span>
<span class="linenos">208</span>
<span class="linenos">209</span>        <span class="c1"># Calculate Timesignal if needed</span>
<span class="linenos">210</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skip_timesignal&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos">211</span>            <span class="bp">self</span><span class="o">.</span><span class="n">calc_time_signal_second_spectrum</span><span class="p">()</span>
<span class="linenos">212</span>
<span class="linenos">213</span>    <span class="k">def</span> <span class="nf">calc_time_signal_second_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">214</span>        <span class="n">time_signal_second_spectrum_transposed</span> <span class="o">=</span> \
<span class="linenos">215</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">time_signal_second_spectrum</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="linenos">216</span>        <span class="n">second_spectrum_time_array</span> <span class="o">=</span> \
<span class="linenos">217</span>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> \
<span class="linenos">218</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">timestep_second_spectrum</span>
<span class="linenos">219</span>        <span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> \
<span class="linenos">220</span>            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed</span><span class="p">),</span>
<span class="linenos">221</span>                      <span class="nb">len</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="linenos">222</span>        <span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> \
<span class="linenos">223</span>            <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">time_signal_second_spectrum_transposed_normalized</span><span class="p">)</span>
<span class="linenos">224</span>
<span class="linenos">225</span>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_octaves</span><span class="p">):</span>
<span class="linenos">226</span>            <span class="n">time_signal_second_spectrum_transposed_normalized</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> \
<span class="linenos">227</span>                <span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
<span class="linenos">228</span>                    <span class="n">time_signal_second_spectrum_transposed</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="linenos">229</span>
<span class="linenos">230</span>        <span class="bp">self</span><span class="o">.</span><span class="n">time_signal_second_spectrum_transposed_normalized</span> <span class="o">=</span> \
<span class="linenos">231</span>            <span class="n">time_signal_second_spectrum_transposed_normalized</span>
<span class="linenos">232</span>        <span class="bp">self</span><span class="o">.</span><span class="n">second_spectrum_time_array</span> <span class="o">=</span> <span class="n">second_spectrum_time_array</span>
<span class="linenos">233</span>
<span class="linenos">234</span>
<span class="linenos">235</span>    <span class="k">def</span> <span class="nf">plot_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">):</span>
<span class="linenos">236</span>        <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="linenos">237</span>
<span class="linenos">238</span>    <span class="k">def</span> <span class="nf">plot_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">):</span>
<span class="linenos">239</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span>
<span class="linenos">240</span>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
<span class="linenos">241</span>
<span class="linenos">242</span>    <span class="k">def</span> <span class="nf">subtract_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">243</span>        <span class="sd">&quot;&quot;&quot;Subtracts mean value from timesignal.</span>
<span class="linenos">244</span>
<span class="linenos">245</span><span class="sd">        :param inplace: Change variable inside this object?</span>
<span class="linenos">246</span><span class="sd">        :type inplace: bool</span>
<span class="linenos">247</span>
<span class="linenos">248</span><span class="sd">        :return: normalized timesignal</span>
<span class="linenos">249</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">250</span>        <span class="n">norm_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">251</span>
<span class="linenos">252</span>        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<span class="linenos">253</span>            <span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span> <span class="o">=</span> <span class="n">norm_ts</span>
<span class="linenos">254</span>
<span class="linenos">255</span>        <span class="k">return</span> <span class="n">norm_ts</span>
<span class="linenos">256</span>
<span class="linenos">257</span>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="linenos">258</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">259</span><span class="sd">        Writing data to a file.</span>
<span class="linenos">260</span>
<span class="linenos">261</span><span class="sd">        Parameters</span>
<span class="linenos">262</span><span class="sd">        ----------</span>
<span class="linenos">263</span><span class="sd">        file: str</span>
<span class="linenos">264</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">265</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<span class="linenos">266</span>            <span class="k">return</span>
<span class="linenos">267</span>
<span class="linenos">268</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
<span class="linenos">269</span>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="linenos">270</span>
<span class="linenos">271</span>        <span class="n">all_first_spectra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">first_spectra_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span>
<span class="linenos">272</span>        <span class="n">all_first_spectra</span><span class="p">[</span><span class="s1">&#39;Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span>
<span class="linenos">273</span>
<span class="linenos">274</span>        <span class="n">all_first_spectra</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_first.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">275</span>        <span class="c1"># all_first_spectra.to_feather(&quot;%s_first.feather&quot; % file)</span>
<span class="linenos">276</span>
<span class="linenos">277</span>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="linenos">278</span>            <span class="k">return</span>
<span class="linenos">279</span>
<span class="linenos">280</span>        <span class="n">all_second_spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span><span class="p">,</span>
<span class="linenos">281</span>                                          <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">282</span>        <span class="n">all_second_spectra</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> <span class="o">=</span> \
<span class="linenos">283</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array_second_spectra</span>
<span class="linenos">284</span>        <span class="n">all_second_spectra</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_second.dat&#39;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span>
<span class="linenos">285</span>                                  <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">286</span>        <span class="c1"># all_second_spectra.to_feather(&#39;%s_second.feather&#39; % file)</span>
<span class="linenos">287</span>
<span class="linenos">288</span>        <span class="n">all_second_spectra_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="linenos">289</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">time_signal_second_spectrum</span><span class="p">)</span>
<span class="linenos">290</span>        <span class="n">all_second_spectra_time</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_second_time.dat&#39;</span> <span class="o">%</span> <span class="n">file</span><span class="p">,</span>
<span class="linenos">291</span>                                       <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">292</span>        <span class="c1"># all_second_spectra_time.to_feather(&#39;%s_second_time.feather&#39; % file)</span>
<span class="linenos">293</span>
<span class="linenos">294</span>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
<span class="linenos">295</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">296</span><span class="sd">        Reading data from file.</span>
<span class="linenos">297</span>
<span class="linenos">298</span><span class="sd">        Parameters</span>
<span class="linenos">299</span><span class="sd">        ----------</span>
<span class="linenos">300</span><span class="sd">        file: str</span>
<span class="linenos">301</span><span class="sd">        Filename base to read data from.</span>
<span class="linenos">302</span>
<span class="linenos">303</span><span class="sd">        Returns</span>
<span class="linenos">304</span><span class="sd">        -------</span>
<span class="linenos">305</span><span class="sd">        self</span>
<span class="linenos">306</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">307</span>
<span class="linenos">308</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">309</span>            <span class="n">first_spectra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_first.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
<span class="linenos">310</span>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<span class="linenos">311</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;First Spectrum at </span><span class="si">%s</span><span class="s1">_first.dat not found!&#39;</span><span class="p">,</span>
<span class="linenos">312</span>                              <span class="n">file</span><span class="p">)</span>
<span class="linenos">313</span>            <span class="k">return</span> <span class="kc">False</span>
<span class="linenos">314</span>
<span class="linenos">315</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">316</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">SpectrumAnalyzer</span><span class="p">(</span>
<span class="linenos">317</span>                <span class="n">timesignal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timesignal</span><span class="p">,</span>
<span class="linenos">318</span>                <span class="n">samplingrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
<span class="linenos">319</span>                <span class="n">averages</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">,</span>
<span class="linenos">320</span>                <span class="n">shifting_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shifting_method</span><span class="p">,</span>
<span class="linenos">321</span>                <span class="n">short_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">short_mode</span><span class="p">,</span>
<span class="linenos">322</span>                <span class="n">filter_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span><span class="p">,</span>
<span class="linenos">323</span>                <span class="n">passband_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">passband_factor</span><span class="p">,</span>
<span class="linenos">324</span>                <span class="n">filter_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">,</span>
<span class="linenos">325</span>                <span class="n">filter_analog</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_analog</span><span class="p">,</span>
<span class="linenos">326</span>                <span class="n">first_spectra_highest_frequency</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">f_max</span><span class="p">,</span>
<span class="linenos">327</span>                <span class="n">downsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">,</span>
<span class="linenos">328</span>            <span class="p">)</span>
<span class="linenos">329</span>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos">330</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not create SpectrumAnalyzer Object: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="linenos">331</span>            <span class="k">return</span> <span class="kc">False</span>
<span class="linenos">332</span>
<span class="linenos">333</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">334</span>            <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="p">[[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span>
<span class="linenos">335</span>            <span class="bp">self</span><span class="o">.</span><span class="n">avg_spec</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Avg&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span>
<span class="linenos">336</span>                                  <span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="s1">&#39;freq&#39;</span><span class="p">},</span>
<span class="linenos">337</span>                                 <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">338</span>
<span class="linenos">339</span>            <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
<span class="linenos">340</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">number_of_first_spectra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span>
<span class="linenos">341</span>
<span class="linenos">342</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array</span> <span class="o">=</span> <span class="n">first_spectra</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
<span class="linenos">343</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">finalize_first_spectrum</span><span class="p">(</span>
<span class="linenos">344</span>                <span class="n">first_spectra</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Avg&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="linenos">345</span>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos">346</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not load variables: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="linenos">347</span>            <span class="k">return</span> <span class="kc">False</span>
<span class="linenos">348</span>
<span class="linenos">349</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">350</span>            <span class="n">second_spectrum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_second.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
<span class="linenos">351</span>            <span class="n">second_spectrum_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_second_time.dat&quot;</span> <span class="o">%</span> <span class="n">file</span><span class="p">)</span>
<span class="linenos">352</span>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<span class="linenos">353</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Second Spectrum (</span><span class="si">%s</span><span class="s1">_second.dat) not found!&#39;</span><span class="p">,</span>
<span class="linenos">354</span>                             <span class="n">file</span><span class="p">)</span>
<span class="linenos">355</span>            <span class="k">return</span> <span class="kc">True</span>
<span class="linenos">356</span>
<span class="linenos">357</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">358</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">frequency_span_array_second_spectra</span> <span class="o">=</span> \
<span class="linenos">359</span>                <span class="n">second_spectrum</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
<span class="linenos">360</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">second_spectra</span> <span class="o">=</span> <span class="n">second_spectrum</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span>
<span class="linenos">361</span>                                                                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">362</span>            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">time_signal_second_spectrum</span> <span class="o">=</span> <span class="n">second_spectrum_time</span>
<span class="linenos">363</span>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos">364</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can not load second spectrum variables: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="linenos">365</span>            <span class="k">return</span> <span class="kc">False</span>
<span class="linenos">366</span>
<span class="linenos">367</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Second Spectrum loaded but not all variables&quot;</span>
<span class="linenos">368</span>                            <span class="s2">&quot;are implemented yet. Only access to </span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos">369</span>                            <span class="s2">&quot;- second_spectra</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos">370</span>                            <span class="s2">&quot;- time_signal_second_spectrum</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="linenos">371</span>                            <span class="s2">&quot;- frequency_span_array_second_spectra&quot;</span><span class="p">)</span>
<span class="linenos">372</span>        <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="id33">
<h3><a class="toc-backref" href="#id70" role="doc-backlink">SA</a><a class="headerlink" href="#id33" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">class</span> <span class="nc">SA</span><span class="p">(</span><span class="n">SingleM</span><span class="p">):</span>
<span class="linenos">  2</span>    <span class="sd">&quot;&quot;&quot;Loads and analyzes datafiles from :instrument:`SR785`&quot;&quot;&quot;</span>
<span class="linenos">  3</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">  4</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  5</span><span class="sd">        Args:</span>
<span class="linenos">  6</span><span class="sd">            *args:</span>
<span class="linenos">  7</span><span class="sd">            **kwargs:</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="sd">        Returns:</span>
<span class="linenos"> 10</span><span class="sd">            None</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="sd">        Raises:</span>
<span class="linenos"> 13</span><span class="sd">            * ValueError</span>
<span class="linenos"> 14</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 15</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 16</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;SA&#39;</span><span class="p">)</span>
<span class="linenos"> 17</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;SA&#39;</span>
<span class="linenos"> 18</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 19</span>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos"> 20</span>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="linenos"> 21</span>            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Not Able to find DataFrame. Please use SA_measurement(data).&quot;</span>
<span class="linenos"> 22</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
<span class="linenos"> 23</span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<span class="linenos"> 26</span>            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="linenos"> 27</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
<span class="linenos"> 28</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 29</span>            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span>        <span class="c1"># Convert data to numeric values</span>
<span class="linenos"> 32</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 33</span>            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="linenos"> 34</span>            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vx</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="linenos"> 35</span>            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Vy</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="linenos"> 36</span>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="linenos"> 37</span>            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Unable to convert data to numeric.&quot;</span>
<span class="linenos"> 38</span>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
<span class="linenos"> 39</span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span>        <span class="c1"># Redirect functions</span>
<span class="linenos"> 42</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_oneoverf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">draw_oneoverf</span>
<span class="linenos"> 43</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_plot_settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_plot_settings</span>
<span class="linenos"> 44</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_calc_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_log</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 47</span>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;SA Measurement (Nr. </span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Nr&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 48</span>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos"> 49</span>            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<span class="linenos"> 50</span>        <span class="k">return</span> <span class="n">ret</span>
<span class="linenos"> 51</span>
<span class="linenos"> 52</span>
<span class="linenos"> 53</span>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 54</span>        <span class="sd">&quot;&quot;&quot;Plotting the Data on given Axis or creating a new Plot for plotting.</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span><span class="sd">        .. code-block:: python</span>
<span class="linenos"> 57</span><span class="sd">           :linenos:</span>
<span class="linenos"> 58</span><span class="sd">           :caption: Signature</span>
<span class="linenos"> 59</span>
<span class="linenos"> 60</span><span class="sd">           plot(ax, label=None, color=None, linestyle=None,</span>
<span class="linenos"> 61</span><span class="sd">               plot_x=&#39;f&#39;, plot_y=&#39;Vx&#39;, dont_set_plot_settings=False,</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="sd">                   xscale=&#39;log&#39;, yscale=&#39;log&#39;, xlim=(None, None), ylim=(None,</span>
<span class="linenos"> 64</span><span class="sd">                   None), legend_location=&#39;best&#39;, grid=None, title=None,</span>
<span class="linenos"> 65</span><span class="sd">                   xlabel=&#39;f [Hz]&#39;, ylabel=&#39;S_VH [V2/Hz]&#39;,</span>
<span class="linenos"> 66</span>
<span class="linenos"> 67</span><span class="sd">           )</span>
<span class="linenos"> 68</span>
<span class="linenos"> 69</span><span class="sd">        Args:</span>
<span class="linenos"> 70</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 71</span>
<span class="linenos"> 72</span><span class="sd">        Note:</span>
<span class="linenos"> 73</span><span class="sd">            If **dont_set_plot_settings** is True, all kwargs below are not</span>
<span class="linenos"> 74</span><span class="sd">            used.</span>
<span class="linenos"> 75</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 76</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">)</span>
<span class="linenos"> 77</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
<span class="linenos"> 78</span>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span>        <span class="n">plotargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 81</span>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="linenos"> 82</span>            <span class="n">plotargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="linenos"> 83</span>        <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="linenos"> 84</span>            <span class="n">plotargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
<span class="linenos"> 85</span>        <span class="k">if</span> <span class="s1">&#39;linestyle&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="linenos"> 86</span>            <span class="n">plotargs</span><span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">)</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_x&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)],</span>
<span class="linenos"> 89</span>                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_y&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">)],</span>
<span class="linenos"> 90</span>                <span class="o">**</span><span class="n">plotargs</span><span class="p">)</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dont_set_plot_settings&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)):</span>
<span class="linenos"> 93</span>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_plot_settings</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 94</span>
<span class="linenos"> 95</span>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">7e-1</span><span class="p">)):</span>
<span class="linenos"> 96</span>        <span class="sd">&quot;&quot;&quot;Fits a linear regression</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span><span class="sd">        Args:</span>
<span class="linenos"> 99</span><span class="sd">            fit_range (tuple, optional, default: (1e-2, 1e0).):</span>
<span class="linenos">100</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">101</span>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx&#39;</span><span class="p">,</span> <span class="s1">&#39;Vy&#39;</span><span class="p">])</span>
<span class="linenos">102</span>        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">fit_range</span>
<span class="linenos">103</span>
<span class="linenos">104</span>        <span class="n">fit_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xmax</span><span class="p">]</span>
<span class="linenos">105</span>        <span class="n">fit_area</span> <span class="o">=</span> <span class="n">fit_area</span><span class="p">[</span><span class="n">fit_area</span><span class="o">.</span><span class="n">f</span> <span class="o">&gt;</span> <span class="n">xmin</span><span class="p">]</span>
<span class="linenos">106</span>        <span class="n">f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">lnf</span><span class="p">,</span> <span class="n">fit_area</span><span class="o">.</span><span class="n">lnVx</span><span class="p">)</span>
<span class="linenos">107</span>
<span class="linenos">108</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Slope&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">slope</span>
<span class="linenos">109</span>        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span>
<span class="linenos">110</span>        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</div>
</section>
<section id="id34">
<h3><a class="toc-backref" href="#id71" role="doc-backlink">Hloop</a><a class="headerlink" href="#id34" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">class</span> <span class="nc">Hloop</span><span class="p">(</span><span class="n">SingleM</span><span class="p">):</span>
<span class="linenos">  2</span>    <span class="sd">&quot;&quot;&quot;This class represents the measurement of a hysteresis loop. It evaluates</span>
<span class="linenos">  3</span><span class="sd">    and plots the data.</span>
<span class="linenos">  4</span>
<span class="linenos">  5</span><span class="sd">    It collects all files that match the following regex:</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="sd">    .. code-block:: python</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="sd">       files = glob(&quot;data/Hloop/[mM]%s_*.dat&quot; % measurement_number)</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="sd">    The files should contain a file that contains the word &quot;up&quot; or &quot;down&quot;</span>
<span class="linenos"> 12</span><span class="sd">    indicating the direction of the field sweep.</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="sd">    If one file contains the word &#39;Gradio&#39; it expects a gradiometry</span>
<span class="linenos"> 15</span><span class="sd">    measurement. If the filename contains the word &#39;Parallel&#39; it expects a</span>
<span class="linenos"> 16</span><span class="sd">    parallel measurement. If the filename contains neither of these words the</span>
<span class="linenos"> 17</span><span class="sd">    variables need to be set manually.</span>
<span class="linenos"> 18</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement_number</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 21</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 22</span><span class="sd">        Args:</span>
<span class="linenos"> 23</span><span class="sd">            measurement_number:</span>
<span class="linenos"> 24</span><span class="sd">            **kwargs:</span>
<span class="linenos"> 25</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 26</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 27</span>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Hloop&#39;</span><span class="p">)</span>
<span class="linenos"> 28</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Hloop&#39;</span>
<span class="linenos"> 29</span>        <span class="c1"># Defining Constants</span>
<span class="linenos"> 30</span>        <span class="n">header_gradio</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth8&quot;</span><span class="p">,</span> <span class="s2">&quot;TempRO CU&quot;</span><span class="p">,</span>
<span class="linenos"> 31</span>                         <span class="s2">&quot;TempRO YOKE&quot;</span><span class="p">,</span> <span class="s2">&quot;TempCX CU&quot;</span><span class="p">,</span> <span class="s2">&quot;SampTemp&quot;</span><span class="p">,</span> <span class="s2">&quot;Temp1K Pot&quot;</span><span class="p">,</span>
<span class="linenos"> 32</span>                         <span class="s2">&quot;TempCharcoal&quot;</span><span class="p">]</span>
<span class="linenos"> 33</span>        <span class="n">header_parallel</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth8&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx9&quot;</span><span class="p">,</span>
<span class="linenos"> 34</span>                           <span class="s2">&quot;Vy9&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr9&quot;</span><span class="p">,</span> <span class="s2">&quot;Vth9&quot;</span><span class="p">,</span> <span class="s2">&quot;Vx13&quot;</span><span class="p">,</span> <span class="s2">&quot;Vy13&quot;</span><span class="p">,</span> <span class="s2">&quot;Vr13&quot;</span><span class="p">,</span>
<span class="linenos"> 35</span>                           <span class="s2">&quot;Vth13&quot;</span><span class="p">,</span> <span class="s2">&quot;TempRO CU&quot;</span><span class="p">,</span> <span class="s2">&quot;TempRO YOKE&quot;</span><span class="p">,</span> <span class="s2">&quot;TempCX CU&quot;</span><span class="p">,</span>
<span class="linenos"> 36</span>                           <span class="s2">&quot;SampTemp&quot;</span><span class="p">,</span> <span class="s2">&quot;Temp1K Pot&quot;</span><span class="p">,</span> <span class="s2">&quot;TempCharcoal&quot;</span><span class="p">]</span>
<span class="linenos"> 37</span>        <span class="bp">self</span><span class="o">.</span><span class="n">c_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span>
<span class="linenos"> 38</span>                       <span class="mi">330</span><span class="p">]</span>  <span class="c1"># Condensators in pF</span>
<span class="linenos"> 39</span>        <span class="bp">self</span><span class="o">.</span><span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">392</span><span class="p">,</span> <span class="mi">475</span><span class="p">,</span> <span class="mi">562</span><span class="p">,</span> <span class="mi">619</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">825</span><span class="p">,</span> <span class="mi">909</span><span class="p">,</span>
<span class="linenos"> 40</span>                       <span class="mf">1e3</span><span class="p">]</span>  <span class="c1"># Resistors in k Ohm</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mf">1369288448319507.5</span>  <span class="c1"># Carrier Concentration calculated from perp. sweep</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">measurement_number</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
<span class="linenos"> 45</span>                <span class="n">measurement_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span class="linenos"> 46</span>            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/Hloop/[mM]</span><span class="si">%s</span><span class="s2">_*.dat&quot;</span> <span class="o">%</span> <span class="n">measurement_number</span><span class="p">)</span>
<span class="linenos"> 47</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 48</span>            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">measurement_number</span><span class="p">)</span>
<span class="linenos"> 49</span>        <span class="n">files</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file_list&#39;</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
<span class="linenos"> 50</span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">files</span><span class="p">):</span>
<span class="linenos"> 51</span>            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
<span class="linenos"> 52</span>                <span class="s2">&quot;No File for measurement Nr. </span><span class="si">%s</span><span class="s2"> found.&quot;</span> <span class="o">%</span> <span class="n">measurement_number</span><span class="p">)</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span>        <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<span class="linenos"> 55</span>            <span class="n">file_info</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos"> 56</span>            <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 57</span>                <span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Gradio&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 58</span>                    <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
<span class="linenos"> 59</span>                        <span class="s2">&quot;.*[Mm]([0-9.]*)_([A-Za-z]*)_([0-9.-]*)deg_&quot;</span>
<span class="linenos"> 60</span>                        <span class="s2">&quot;([A-Za-z]*)_&quot;</span>
<span class="linenos"> 61</span>                        <span class="s2">&quot;([A-Za-z]*)_*([A-Za-z]*)_([0-9]*)_([0-9]*)_&quot;</span>
<span class="linenos"> 62</span>                        <span class="s2">&quot;I1-([0-9\-]*)_I2-([0-9\-]*)_G.*-([0-9\-]*)_&quot;</span>
<span class="linenos"> 63</span>                        <span class="s2">&quot;Vin-([0-9.]*)V_R11-([0-9]*.)O_R12-([0-9.]*.)O_&quot;</span>
<span class="linenos"> 64</span>                        <span class="s2">&quot;R13-([0-9.]*.)_R21-([0-9.]*.)O_&quot;</span>
<span class="linenos"> 65</span>                        <span class="s2">&quot;C11-([0-9]*)_C21-([0-9]*)_&quot;</span>
<span class="linenos"> 66</span>                        <span class="s2">&quot;T-([0-9]*)K_SR-([0-9.]*)-T-min&quot;</span><span class="p">,</span>
<span class="linenos"> 67</span>                        <span class="n">fname</span><span class="p">)</span>
<span class="linenos"> 68</span>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
<span class="linenos"> 69</span>                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not fitting Regex&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
<span class="linenos"> 70</span>                    <span class="n">m_no</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">m_type</span><span class="p">,</span> \
<span class="linenos"> 71</span>                        <span class="n">m_dir</span><span class="p">,</span> <span class="n">m_type2</span><span class="p">,</span> <span class="n">m_date</span><span class="p">,</span> <span class="n">m_time</span><span class="p">,</span> \
<span class="linenos"> 72</span>                        <span class="n">m_i1</span><span class="p">,</span> <span class="n">m_i2</span><span class="p">,</span> <span class="n">m_li1</span><span class="p">,</span> \
<span class="linenos"> 73</span>                        <span class="n">m_vin</span><span class="p">,</span> <span class="n">m_r11</span><span class="p">,</span> <span class="n">m_r12</span><span class="p">,</span> \
<span class="linenos"> 74</span>                        <span class="n">m_r13</span><span class="p">,</span> <span class="n">m_r21</span><span class="p">,</span> \
<span class="linenos"> 75</span>                        <span class="n">m_c11</span><span class="p">,</span> <span class="n">m_c21</span><span class="p">,</span> \
<span class="linenos"> 76</span>                        <span class="n">m_T</span><span class="p">,</span> <span class="n">m_SR</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="linenos"> 77</span>                    <span class="n">header</span> <span class="o">=</span> <span class="n">header_gradio</span>
<span class="linenos"> 78</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="kc">False</span>
<span class="linenos"> 79</span>                <span class="k">elif</span> <span class="n">fname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Parallel&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 80</span>                    <span class="n">reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
<span class="linenos"> 81</span>                        <span class="s2">&quot;.*[Mm]([0-9.]*)_([A-Za-z_]*)_([0-9.-]*)deg_([A-Za-z]*)_&quot;</span>
<span class="linenos"> 82</span>                        <span class="o">+</span> <span class="s2">&quot;([A-Za-z]*)_*([A-Za-z]*)_([0-9]*)_([0-9]*)_&quot;</span> \
<span class="linenos"> 83</span>                        <span class="o">+</span> <span class="s2">&quot;I-([0-9\-]*)_(G.*-[0-9\-]*)_&quot;</span> \
<span class="linenos"> 84</span>                        <span class="o">+</span> <span class="s2">&quot;Vin-([0-9.]*)V_R11-([0-9]*.)O&quot;</span> \
<span class="linenos"> 85</span>                        <span class="o">+</span> <span class="s2">&quot;.*_&quot;</span> \
<span class="linenos"> 86</span>                        <span class="o">+</span> <span class="s2">&quot;T-([0-9]*)K_SR-([0-9.]*)-T-min&quot;</span><span class="p">,</span>
<span class="linenos"> 87</span>                        <span class="n">fname</span><span class="p">)</span>
<span class="linenos"> 88</span>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">reg</span><span class="p">:</span>
<span class="linenos"> 89</span>                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not fitting Regex&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
<span class="linenos"> 90</span>                    <span class="n">m_no</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">m_type</span><span class="p">,</span> \
<span class="linenos"> 91</span>                    <span class="n">m_dir</span><span class="p">,</span> <span class="n">m_type2</span><span class="p">,</span> <span class="n">m_date</span><span class="p">,</span> <span class="n">m_time</span><span class="p">,</span> \
<span class="linenos"> 92</span>                    <span class="n">m_i1</span><span class="p">,</span> <span class="n">m_li1</span><span class="p">,</span> \
<span class="linenos"> 93</span>                    <span class="n">m_vin</span><span class="p">,</span> <span class="n">m_r11</span><span class="p">,</span> \
<span class="linenos"> 94</span>                    <span class="n">m_T</span><span class="p">,</span> <span class="n">m_SR</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="linenos"> 95</span>                    <span class="n">m_i2</span> <span class="o">=</span> <span class="n">m_r12</span> <span class="o">=</span> <span class="n">m_r13</span> <span class="o">=</span> <span class="n">m_r21</span> <span class="o">=</span> <span class="n">m_c11</span> <span class="o">=</span> <span class="n">m_c21</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
<span class="linenos"> 96</span>                    <span class="n">header</span> <span class="o">=</span> <span class="n">header_parallel</span>
<span class="linenos"> 97</span>                    <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos"> 98</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 99</span>                    <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not fitting Regex&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
<span class="linenos">100</span>            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
<span class="linenos">101</span>                <span class="n">file_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_info_from_name</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="linenos">102</span>                
<span class="linenos">103</span>                <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type2&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Parallel&#39;</span>
<span class="linenos">104</span>                <span class="n">header</span> <span class="o">=</span> <span class="n">header_gradio</span> <span class="k">if</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type2&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Gradio&#39;</span> <span class="k">else</span> <span class="n">header_parallel</span>
<span class="linenos">105</span>                <span class="n">header</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;header&#39;</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
<span class="linenos">106</span>                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">file_info</span><span class="p">)</span>
<span class="linenos">107</span>
<span class="linenos">108</span>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> \
<span class="linenos">109</span>                        <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="linenos">110</span>                    <span class="n">file_info</span><span class="p">[</span><span class="s1">&#39;deg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="linenos">111</span>                <span class="n">deg</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.01</span>
<span class="linenos">112</span>                <span class="n">m_dir</span> <span class="o">=</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dir&#39;</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="linenos">113</span>
<span class="linenos">114</span>                <span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;b.dat&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">115</span>                    <span class="n">m_dir</span> <span class="o">=</span> <span class="s1">&#39;up&#39;</span>
<span class="linenos">116</span>
<span class="linenos">117</span>
<span class="linenos">118</span>            <span class="c1">### Loading File</span>
<span class="linenos">119</span>            <span class="k">if</span> <span class="p">(</span><span class="n">m_dir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">):</span>
<span class="linenos">120</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fname_up</span> <span class="o">=</span> <span class="n">fname</span>
<span class="linenos">121</span>                <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
<span class="linenos">122</span>                                      <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="linenos">123</span>                <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="mf">1e3</span>
<span class="linenos">124</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">125</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fname_down</span> <span class="o">=</span> <span class="n">fname</span>
<span class="linenos">126</span>                <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
<span class="linenos">127</span>                                        <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="linenos">128</span>                <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="mf">1e3</span>
<span class="linenos">129</span>
<span class="linenos">130</span>        <span class="k">if</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;down_only&#39;</span><span class="p">)):</span>
<span class="linenos">131</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span>
<span class="linenos">132</span>        <span class="k">if</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;up_only&#39;</span><span class="p">)):</span>
<span class="linenos">133</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span>
<span class="linenos">134</span>
<span class="linenos">135</span>        <span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span> <span class="o">=</span> <span class="n">measurement_number</span>
<span class="linenos">136</span>        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">137</span>
<span class="linenos">138</span>        <span class="c1"># Mirror all Angles bigger than 90</span>
<span class="linenos">139</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;force_mirror&#39;</span><span class="p">)</span> <span class="ow">or</span> \
<span class="linenos">140</span>                <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auto_mirror&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> \
<span class="linenos">141</span>                 <span class="nb">float</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">):</span>
<span class="linenos">142</span>            <span class="bp">self</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">143</span>            <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">144</span>
<span class="linenos">145</span>        <span class="k">if</span> <span class="n">file_info</span><span class="p">:</span>
<span class="linenos">146</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">file_info</span>
<span class="linenos">147</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos">148</span>                <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span>
<span class="linenos">149</span>                                     <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type2&#39;</span><span class="p">)),</span>
<span class="linenos">150</span>                <span class="s1">&#39;Structure&#39;</span><span class="p">:</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;struct&#39;</span><span class="p">),</span>
<span class="linenos">151</span>                <span class="s1">&#39;Angle&#39;</span><span class="p">:</span> <span class="n">file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span>
<span class="linenos">152</span>            <span class="p">})</span>
<span class="linenos">153</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">154</span>            <span class="n">m_datetime</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
<span class="linenos">155</span>            <span class="n">m_date</span><span class="p">[</span><span class="mi">6</span><span class="p">:],</span> <span class="n">m_date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">m_date</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">m_time</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">m_time</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<span class="linenos">156</span>            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">157</span>                <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m_type</span><span class="p">,</span> <span class="n">m_type2</span><span class="p">),</span>
<span class="linenos">158</span>                <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">m_datetime</span><span class="p">,</span>
<span class="linenos">159</span>                <span class="s1">&#39;Structure&#39;</span><span class="p">:</span> <span class="n">struct</span><span class="p">,</span>
<span class="linenos">160</span>                <span class="s1">&#39;Angle&#39;</span><span class="p">:</span> <span class="n">deg</span><span class="p">,</span>
<span class="linenos">161</span>                <span class="s1">&#39;I1&#39;</span><span class="p">:</span> <span class="n">m_i1</span><span class="p">,</span>
<span class="linenos">162</span>                <span class="s1">&#39;I2&#39;</span><span class="p">:</span> <span class="n">m_i2</span><span class="p">,</span>
<span class="linenos">163</span>                <span class="s1">&#39;Vin&#39;</span><span class="p">:</span> <span class="n">m_vin</span><span class="p">,</span>
<span class="linenos">164</span>                <span class="s1">&#39;R11&#39;</span><span class="p">:</span> <span class="n">m_r11</span><span class="p">,</span>
<span class="linenos">165</span>                <span class="s1">&#39;R12&#39;</span><span class="p">:</span> <span class="n">m_r12</span><span class="p">,</span>
<span class="linenos">166</span>                <span class="s1">&#39;R13&#39;</span><span class="p">:</span> <span class="n">m_r13</span><span class="p">,</span>
<span class="linenos">167</span>                <span class="s1">&#39;R21&#39;</span><span class="p">:</span> <span class="n">m_r21</span><span class="p">,</span>
<span class="linenos">168</span>                <span class="s1">&#39;C11&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">m_c11</span><span class="p">)],</span>
<span class="linenos">169</span>                <span class="s1">&#39;C21&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">m_c21</span><span class="p">)],</span>
<span class="linenos">170</span>                <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">m_T</span><span class="p">,</span>
<span class="linenos">171</span>                <span class="s1">&#39;SR&#39;</span><span class="p">:</span> <span class="n">m_SR</span><span class="p">,</span>
<span class="linenos">172</span>                <span class="s1">&#39;Additional&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="linenos">173</span>
<span class="linenos">174</span>        <span class="c1"># Update data from kwargs</span>
<span class="linenos">175</span>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">176</span>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="linenos">177</span>                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="linenos">178</span>
<span class="linenos">179</span>    <span class="k">def</span> <span class="nf">set_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="linenos">180</span>        <span class="sd">&quot;&quot;&quot;Multiplying the Voltage by a Factor</span>
<span class="linenos">181</span>
<span class="linenos">182</span><span class="sd">        Args:</span>
<span class="linenos">183</span><span class="sd">            factor:</span>
<span class="linenos">184</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">185</span>        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">186</span>        <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">187</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">188</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">189</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">190</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">191</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">192</span>
<span class="linenos">193</span>        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
<span class="linenos">194</span>
<span class="linenos">195</span>        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">196</span>        <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">197</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">198</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">199</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">200</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">201</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
<span class="linenos">202</span>
<span class="linenos">203</span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">204</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
<span class="linenos">205</span>
<span class="linenos">206</span>    <span class="k">def</span> <span class="nf">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
<span class="linenos">207</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">208</span><span class="sd">        Args:</span>
<span class="linenos">209</span><span class="sd">            V:</span>
<span class="linenos">210</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">211</span>        <span class="n">e</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s1">&#39;electron volt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">212</span>        <span class="n">R</span> <span class="o">=</span> <span class="n">V</span> <span class="o">/</span> <span class="mf">2.5e-6</span>
<span class="linenos">213</span>        <span class="n">B</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">e</span>
<span class="linenos">214</span>        <span class="k">return</span> <span class="n">B</span>
<span class="linenos">215</span>
<span class="linenos">216</span>    <span class="k">def</span> <span class="nf">remove_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos">217</span>        <span class="sd">&quot;&quot;&quot;Removes the values 0.0 from up and down sweep where the lock-in</span>
<span class="linenos">218</span><span class="sd">        didn&#39;t return any values (read error will be saved as 0.0).</span>
<span class="linenos">219</span>
<span class="linenos">220</span><span class="sd">        Args:</span>
<span class="linenos">221</span><span class="sd">            columns:</span>
<span class="linenos">222</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">223</span>        <span class="c1"># Set Columns to remove values from</span>
<span class="linenos">224</span>        <span class="k">if</span> <span class="n">columns</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">225</span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">:</span>
<span class="linenos">226</span>                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx9&#39;</span><span class="p">,</span> <span class="s1">&#39;Vx13&#39;</span><span class="p">]</span>
<span class="linenos">227</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">228</span>                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]</span>
<span class="linenos">229</span>
<span class="linenos">230</span>        <span class="c1"># Remove zero values from columns (= measurement error)</span>
<span class="linenos">231</span>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
<span class="linenos">232</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">233</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">234</span>
<span class="linenos">235</span>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()):</span>
<span class="linenos">236</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">237</span><span class="sd">        Fitting the Voltage Signal.</span>
<span class="linenos">238</span>
<span class="linenos">239</span><span class="sd">        For Parallel measurement:</span>
<span class="linenos">240</span>
<span class="linenos">241</span><span class="sd">           the empty cross Vx13 is subtracted from the signal Vx8/Vx9</span>
<span class="linenos">242</span>
<span class="linenos">243</span><span class="sd">        For gradiometry:</span>
<span class="linenos">244</span>
<span class="linenos">245</span><span class="sd">           A condition can be added to determine the amount of</span>
<span class="linenos">246</span><span class="sd">           datapoints to fit (default: B &lt; B_min + 150mT).</span>
<span class="linenos">247</span>
<span class="linenos">248</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">249</span><span class="sd">           :caption: Example</span>
<span class="linenos">250</span>
<span class="linenos">251</span><span class="sd">            cond = (self.up.B &lt; self.up.B.min() + 150)</span>
<span class="linenos">252</span><span class="sd">            m.fit(cond)</span>
<span class="linenos">253</span>
<span class="linenos">254</span><span class="sd">        Args:</span>
<span class="linenos">255</span><span class="sd">            cond:</span>
<span class="linenos">256</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">257</span>        <span class="c1"># Set Fitting Condition</span>
<span class="linenos">258</span>        <span class="k">if</span> <span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">empty</span><span class="p">):</span>
<span class="linenos">259</span>            <span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">150</span><span class="p">)</span>
<span class="linenos">260</span>
<span class="linenos">261</span>        <span class="c1">### Fitting Graph</span>
<span class="linenos">262</span>        <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos">263</span>        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos">264</span>
<span class="linenos">265</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">266</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx13</span>
<span class="linenos">267</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx13</span>
<span class="linenos">268</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx13</span>
<span class="linenos">269</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx9</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx13</span>
<span class="linenos">270</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">271</span>            <span class="n">fit_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos">272</span>            <span class="n">fit</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">fit_area</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">273</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">274</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span> <span class="o">+</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">)</span>
<span class="linenos">275</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">276</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span> <span class="o">+</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">)</span>
<span class="linenos">277</span>            <span class="n">fit_area</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fit_area</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span>
<span class="linenos">278</span>                               <span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span> <span class="o">+</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">)</span>
<span class="linenos">279</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">fit</span>
<span class="linenos">280</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">fit</span>
<span class="linenos">281</span>
<span class="linenos">282</span>    <span class="k">def</span> <span class="nf">plot_hloop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">show_fitted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">283</span>                   <span class="n">show_rem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_coer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">284</span>                   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">285</span>        <span class="sd">&quot;&quot;&quot;Plotting the hysteresis loop.</span>
<span class="linenos">286</span>
<span class="linenos">287</span><span class="sd">        :param ax: Matplotlib Axis to plot on.</span>
<span class="linenos">288</span><span class="sd">        :param figtitle: can be set to a manual figure title.</span>
<span class="linenos">289</span><span class="sd">        :param show_fitted: plot the fitted curve.</span>
<span class="linenos">290</span><span class="sd">        :param show_rem: show the remanent voltage.</span>
<span class="linenos">291</span><span class="sd">        :param show_coer: show the coercive field.</span>
<span class="linenos">292</span><span class="sd">        :param show_original: plots the RAW data.</span>
<span class="linenos">293</span><span class="sd">        :param show_linear_fit: plots the linear fitting line used for the fit</span>
<span class="linenos">294</span><span class="sd">        (only gradiometry).</span>
<span class="linenos">295</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">296</span>
<span class="linenos">297</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_original&#39;</span><span class="p">):</span>  <span class="c1"># Drawing RAW Data</span>
<span class="linenos">298</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up&quot;</span><span class="p">)</span>
<span class="linenos">299</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>
<span class="linenos">300</span>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">301</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up (LI 9)&quot;</span><span class="p">)</span>
<span class="linenos">302</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down (LI 9)&#39;</span><span class="p">)</span>
<span class="linenos">303</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up (LI 13)&quot;</span><span class="p">)</span>
<span class="linenos">304</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down (LI 13)&#39;</span><span class="p">)</span>
<span class="linenos">305</span>
<span class="linenos">306</span>        <span class="k">if</span> <span class="n">show_fitted</span><span class="p">:</span>  <span class="c1"># Drawing fitted data</span>
<span class="linenos">307</span>            <span class="c1"># Already fitted?</span>
<span class="linenos">308</span>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;down_fitted&#39;</span><span class="p">)):</span>
<span class="linenos">309</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="linenos">310</span>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">311</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
<span class="linenos">312</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">313</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
<span class="linenos">314</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">315</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span>
<span class="linenos">316</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">317</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">,</span>
<span class="linenos">318</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">319</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">320</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
<span class="linenos">321</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">322</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">,</span>
<span class="linenos">323</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">324</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_linear_fit&#39;</span><span class="p">):</span>  <span class="c1"># Drawing linear Fit</span>
<span class="linenos">325</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span>
<span class="linenos">326</span>                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear Fit&#39;</span><span class="p">)</span>
<span class="linenos">327</span>
<span class="linenos">328</span>        <span class="c1">### Remanent Field ###</span>
<span class="linenos">329</span>        <span class="k">if</span> <span class="n">show_rem</span><span class="p">:</span>
<span class="linenos">330</span>            <span class="n">rem1</span><span class="p">,</span> <span class="n">rem2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_remanence</span><span class="p">()</span>
<span class="linenos">331</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="linenos">332</span>                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
<span class="linenos">333</span>                    <span class="s1">&#39;r-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;.5&#39;</span><span class="p">)</span>
<span class="linenos">334</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="linenos">335</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="linenos">336</span>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$V_</span><span class="si">{rem}</span><span class="s2"> = </span><span class="si">%.3f</span><span class="s2"> </span><span class="se">\\</span><span class="s2">mu V$&quot;</span> <span class="o">%</span> <span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span>
<span class="linenos">337</span>                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem1</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
<span class="linenos">338</span>                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
<span class="linenos">339</span>                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
<span class="linenos">340</span>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$V_</span><span class="si">{rem}</span><span class="s2"> = </span><span class="si">%.3f</span><span class="s2"> </span><span class="se">\\</span><span class="s2">mu V$&quot;</span> <span class="o">%</span> <span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span>
<span class="linenos">341</span>                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">rem2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
<span class="linenos">342</span>                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
<span class="linenos">343</span>                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
<span class="linenos">344</span>
<span class="linenos">345</span>        <span class="c1">### Coercive Field</span>
<span class="linenos">346</span>        <span class="k">if</span> <span class="n">show_coer</span><span class="p">:</span>
<span class="linenos">347</span>            <span class="n">mean</span><span class="p">,</span> <span class="n">coer</span><span class="p">,</span> <span class="n">coer2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coercive_field</span><span class="p">()</span>
<span class="linenos">348</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
<span class="linenos">349</span>                    <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">mean</span><span class="p">],</span> <span class="s1">&#39;r-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;.5&#39;</span><span class="p">)</span>
<span class="linenos">350</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coer</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="linenos">351</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="linenos">352</span>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$B_</span><span class="si">{coer}</span><span class="s2"> = </span><span class="si">%.4f</span><span class="s2"> T$&quot;</span> <span class="o">%</span> <span class="n">coer</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos">353</span>                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">coer</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
<span class="linenos">354</span>                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
<span class="linenos">355</span>                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
<span class="linenos">356</span>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$B_</span><span class="si">{coer}</span><span class="s2"> = </span><span class="si">%.4f</span><span class="s2"> T$&quot;</span> <span class="o">%</span> <span class="n">coer2</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
<span class="linenos">357</span>                        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">coer2</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]),</span>
<span class="linenos">358</span>                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
<span class="linenos">359</span>                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
<span class="linenos">360</span>
<span class="linenos">361</span>        <span class="c1"># Making a nice plot</span>
<span class="linenos">362</span>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos">363</span>        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
<span class="linenos">364</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
<span class="linenos">365</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$B</span><span class="se">\\</span><span class="s2">;[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos">366</span>
<span class="linenos">367</span>        <span class="c1"># Setting correct Y Label</span>
<span class="linenos">368</span>        <span class="n">yunit</span> <span class="o">=</span> <span class="s1">&#39;$V_x$&#39;</span>
<span class="linenos">369</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">==</span> <span class="mf">1e3</span><span class="p">):</span>
<span class="linenos">370</span>            <span class="n">yunit</span> <span class="o">+=</span> <span class="s1">&#39; $[</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{mV}</span><span class="s1">]$&#39;</span>
<span class="linenos">371</span>        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">==</span> <span class="mf">1e6</span><span class="p">):</span>
<span class="linenos">372</span>            <span class="n">yunit</span> <span class="o">+=</span> <span class="s1">&#39; $[</span><span class="se">\\</span><span class="s1">mathrm{</span><span class="se">\\</span><span class="s1">mu V}]$&#39;</span>
<span class="linenos">373</span>
<span class="linenos">374</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">yunit</span><span class="p">)</span>
<span class="linenos">375</span>
<span class="linenos">376</span>        <span class="k">if</span> <span class="p">(</span><span class="n">figtitle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="linenos">377</span>            <span class="n">figtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
<span class="linenos">378</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">figtitle</span><span class="p">)</span>
<span class="linenos">379</span>
<span class="linenos">380</span>    <span class="k">def</span> <span class="nf">calculate_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">381</span>        <span class="sd">&quot;&quot;&quot;Calculates the strayfield of the signal and stores it in up and down</span>
<span class="linenos">382</span><span class="sd">        sweeps.</span>
<span class="linenos">383</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">384</span>        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">385</span>        <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">386</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">387</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
<span class="linenos">388</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
<span class="linenos">389</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>
<span class="linenos">390</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>
<span class="linenos">391</span>
<span class="linenos">392</span>    <span class="k">def</span> <span class="nf">calculate_fitted_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">393</span>        <span class="sd">&quot;&quot;&quot;Calculates the strayfield of the fitted signal and stores it in up</span>
<span class="linenos">394</span><span class="sd">        and down sweeps.</span>
<span class="linenos">395</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">396</span>        <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">397</span>        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;Bx8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">398</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">399</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
<span class="linenos">400</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;Bx9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx9</span><span class="p">)</span>
<span class="linenos">401</span>            <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>
<span class="linenos">402</span>            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span><span class="s1">&#39;Bx13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_B</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Vx13</span><span class="p">)</span>
<span class="linenos">403</span>
<span class="linenos">404</span>    <span class="k">def</span> <span class="nf">plot_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">405</span>        <span class="sd">&quot;&quot;&quot;Plots the strayfield of the data. Strayfield is calculated using the</span>
<span class="linenos">406</span><span class="sd">        electron concentration at 0 degree measured before</span>
<span class="linenos">407</span><span class="sd">        (hardcoded in __init__).</span>
<span class="linenos">408</span>
<span class="linenos">409</span><span class="sd">        Args:</span>
<span class="linenos">410</span><span class="sd">            ax (matplotlib.pyplot.axis): where should we plot.</span>
<span class="linenos">411</span><span class="sd">            figtitle (str, optional): Choose your own title above the figure.</span>
<span class="linenos">412</span><span class="sd">            **kwargs:</span>
<span class="linenos">413</span>
<span class="linenos">414</span><span class="sd">        Returns:</span>
<span class="linenos">415</span><span class="sd">            None.:</span>
<span class="linenos">416</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">417</span>        <span class="bp">self</span><span class="o">.</span><span class="n">set_factor</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">))</span>
<span class="linenos">418</span>        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_strayfield</span><span class="p">()</span>
<span class="linenos">419</span>
<span class="linenos">420</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_original&#39;</span><span class="p">):</span>  <span class="c1"># Drawing RAW Data</span>
<span class="linenos">421</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up&quot;</span><span class="p">)</span>
<span class="linenos">422</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>
<span class="linenos">423</span>
<span class="linenos">424</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_fitted&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>  <span class="c1"># Drawing fitted data</span>
<span class="linenos">425</span>            <span class="c1"># Already fitted?</span>
<span class="linenos">426</span>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;down_fitted&#39;</span><span class="p">)):</span>
<span class="linenos">427</span>                <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="linenos">428</span>            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_fitted_strayfield</span><span class="p">()</span>
<span class="linenos">429</span>
<span class="linenos">430</span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">:</span>
<span class="linenos">431</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_plusses&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
<span class="linenos">432</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
<span class="linenos">433</span>                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">434</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
<span class="linenos">435</span>                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Plusses: Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">436</span>
<span class="linenos">437</span>                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_crosses&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
<span class="linenos">438</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
<span class="linenos">439</span>                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">440</span>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="p">,</span>
<span class="linenos">441</span>                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Crosses: Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">442</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">443</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
<span class="linenos">444</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Up (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">445</span>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="p">,</span>
<span class="linenos">446</span>                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Down (fitted)&#39;</span><span class="p">)</span>
<span class="linenos">447</span>
<span class="linenos">448</span>        <span class="c1"># Making a nice plot</span>
<span class="linenos">449</span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nolegend&#39;</span><span class="p">)):</span>
<span class="linenos">450</span>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="linenos">451</span>        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minmax</span><span class="p">()</span>
<span class="linenos">452</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">)</span>
<span class="linenos">453</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu_0 H_</span><span class="si">{ext}</span><span class="s2">$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos">454</span>
<span class="linenos">455</span>        <span class="c1"># Setting correct Y Label</span>
<span class="linenos">456</span>        <span class="n">bhmin</span><span class="p">,</span> <span class="n">bhmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bhminmax</span><span class="p">()</span>
<span class="linenos">457</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bhmin</span> <span class="o">-</span> <span class="mf">.05</span><span class="p">,</span> <span class="n">bhmax</span> <span class="o">+</span> <span class="mf">.05</span><span class="p">)</span>
<span class="linenos">458</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">langle B_z </span><span class="se">\\</span><span class="s2">rangle$ $[</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos">459</span>
<span class="linenos">460</span>        <span class="c1"># Setting Title</span>
<span class="linenos">461</span>        <span class="k">if</span> <span class="p">(</span><span class="n">figtitle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="linenos">462</span>            <span class="n">figtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
<span class="linenos">463</span>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">464</span>                <span class="n">figtitle</span> <span class="o">=</span> <span class="s2">&quot;M</span><span class="si">%s</span><span class="s2">: $</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
<span class="linenos">465</span>                                                 <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">])</span>
<span class="linenos">466</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">figtitle</span><span class="p">)</span>
<span class="linenos">467</span>
<span class="linenos">468</span>    <span class="k">def</span> <span class="nf">plot_downminusup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="linenos">469</span>        <span class="sd">&quot;&quot;&quot;Plotting the difference between the down and up sweep. ax: Matplotlib</span>
<span class="linenos">470</span><span class="sd">        Axis to plot on. figtitle: can be set to a manual figure title.</span>
<span class="linenos">471</span>
<span class="linenos">472</span><span class="sd">        Args:</span>
<span class="linenos">473</span><span class="sd">            ax:</span>
<span class="linenos">474</span><span class="sd">            figtitle:</span>
<span class="linenos">475</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">476</span>        <span class="n">B</span><span class="p">,</span> <span class="n">vx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_downminusup</span><span class="p">()</span>
<span class="linenos">477</span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">vx</span><span class="p">)</span>
<span class="linenos">478</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$B [</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{mT}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="linenos">479</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$V_x [</span><span class="se">\\</span><span class="s2">mathrm{</span><span class="se">\\</span><span class="s2">mu V}]$&quot;</span><span class="p">)</span>
<span class="linenos">480</span>        <span class="k">if</span> <span class="p">(</span><span class="n">figtitle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="linenos">481</span>            <span class="n">figtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_title</span><span class="p">()</span>
<span class="linenos">482</span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">figtitle</span><span class="p">)</span>
<span class="linenos">483</span>
<span class="linenos">484</span>    <span class="k">def</span> <span class="nf">get_downminusup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">1e5</span><span class="p">):</span>
<span class="linenos">485</span>        <span class="sd">&quot;&quot;&quot;Returns the magnetic field and difference between down and up sweep.</span>
<span class="linenos">486</span>
<span class="linenos">487</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">488</span><span class="sd">           :caption: Example</span>
<span class="linenos">489</span>
<span class="linenos">490</span><span class="sd">            B, Vx = meas.get_downminusup() plt.plot(B, Vx)</span>
<span class="linenos">491</span>
<span class="linenos">492</span><span class="sd">        Args:</span>
<span class="linenos">493</span><span class="sd">            n:</span>
<span class="linenos">494</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">495</span>        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">496</span>        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">Vx8</span><span class="p">)</span>
<span class="linenos">497</span>        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="linenos">498</span>        <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="linenos">499</span>        <span class="k">return</span> <span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span>
<span class="linenos">500</span>
<span class="linenos">501</span>    <span class="k">def</span> <span class="nf">get_downminusup_strayfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">1e5</span><span class="p">,</span> <span class="n">fitted_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="linenos">502</span>        <span class="sd">&quot;&quot;&quot;Returns the magnetic field and difference between down and up sweep.</span>
<span class="linenos">503</span>
<span class="linenos">504</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">505</span><span class="sd">           :caption: Example</span>
<span class="linenos">506</span>
<span class="linenos">507</span><span class="sd">           B_ext, Bx = meas.get_downminusup_strayfield() plt.plot(B_ext, Bx)</span>
<span class="linenos">508</span>
<span class="linenos">509</span><span class="sd">        Args:</span>
<span class="linenos">510</span><span class="sd">            n:</span>
<span class="linenos">511</span><span class="sd">            fitted_data:</span>
<span class="linenos">512</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">513</span>        <span class="k">if</span> <span class="n">fitted_data</span><span class="p">:</span>
<span class="linenos">514</span>            <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span>
<span class="linenos">515</span>            <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span>
<span class="linenos">516</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">517</span>            <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span>
<span class="linenos">518</span>            <span class="n">down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span>
<span class="linenos">519</span>        <span class="n">f_up</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">up</span><span class="o">.</span><span class="n">Bx8</span><span class="p">)</span>
<span class="linenos">520</span>        <span class="n">f_down</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">down</span><span class="o">.</span><span class="n">Bx8</span><span class="p">)</span>
<span class="linenos">521</span>        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="linenos">522</span>        <span class="n">downminusup</span> <span class="o">=</span> <span class="n">f_down</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_up</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="linenos">523</span>        <span class="k">return</span> <span class="n">B</span><span class="p">,</span> <span class="n">downminusup</span>
<span class="linenos">524</span>
<span class="linenos">525</span>    <span class="k">def</span> <span class="nf">get_coercive_field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">526</span>        <span class="sd">&quot;&quot;&quot;Returns the mean and coercive fields calculated.</span>
<span class="linenos">527</span>
<span class="linenos">528</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">529</span><span class="sd">           :caption: Example</span>
<span class="linenos">530</span>
<span class="linenos">531</span><span class="sd">           mean, coer1, coer2 = meas.get_coercive_field()</span>
<span class="linenos">532</span><span class="sd">           print(&#39;Coercive Field (up sweep): (%.3f, %.3f)&#39; % (coer1, mean))</span>
<span class="linenos">533</span><span class="sd">           print(&#39;Coercive Field (down sweep): (%.3f, %.3f)&#39; % (coer2, mean))</span>
<span class="linenos">534</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">535</span>        <span class="n">mean</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span><span class="s1">&#39;Vx8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span>
<span class="linenos">536</span>            <span class="s1">&#39;Vx8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span>
<span class="linenos">537</span>        <span class="n">coer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="p">[</span> \
<span class="linenos">538</span>                                              <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">350</span><span class="p">][</span>
<span class="linenos">539</span>                                              <span class="s1">&#39;Vx8&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
<span class="linenos">540</span>        <span class="n">coer2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="p">[</span> \
<span class="linenos">541</span>                                                 <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">350</span><span class="p">][</span>
<span class="linenos">542</span>                                                 <span class="s1">&#39;Vx8&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span>
<span class="linenos">543</span>        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">coer</span><span class="p">,</span> <span class="n">coer2</span>
<span class="linenos">544</span>
<span class="linenos">545</span>    <span class="k">def</span> <span class="nf">plot_hysteresis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">546</span>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">))</span>
<span class="linenos">547</span>        
<span class="linenos">548</span>        <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>
<span class="linenos">549</span>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_strayfield</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">550</span>        <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span>
<span class="linenos">551</span>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_hloop</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">552</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">553</span>            <span class="bp">self</span><span class="o">.</span><span class="n">plot_downminusup</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">554</span>
<span class="linenos">555</span>    <span class="k">def</span> <span class="nf">get_remanence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">556</span>        <span class="sd">&quot;&quot;&quot;Returns the remanent voltage calculated.</span>
<span class="linenos">557</span>
<span class="linenos">558</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">559</span><span class="sd">           :caption: Example</span>
<span class="linenos">560</span>
<span class="linenos">561</span><span class="sd">           rem1, rem2 = meas.get_remanence()</span>
<span class="linenos">562</span><span class="sd">           print(&#39;Remanent Voltage (up sweep): (%d, %.3f)&#39; % (0, rem1))</span>
<span class="linenos">563</span><span class="sd">           print(&#39;Remanent Voltage (down sweep): (%d, %.3f)&#39; % (0, rem2))</span>
<span class="linenos">564</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">565</span>        <span class="n">rem1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="linenos">566</span>        <span class="n">rem2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="linenos">567</span>        <span class="k">return</span> <span class="n">rem1</span><span class="p">,</span> <span class="n">rem2</span>
<span class="linenos">568</span>
<span class="linenos">569</span>    <span class="k">def</span> <span class="nf">get_minmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">570</span>        <span class="sd">&quot;&quot;&quot;Returns the minimum and maximum of the field and voltage.</span>
<span class="linenos">571</span>
<span class="linenos">572</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">573</span><span class="sd">           :caption: Example</span>
<span class="linenos">574</span>
<span class="linenos">575</span><span class="sd">           bmin, bmax, vmin, vmax = meas.get_minmax()</span>
<span class="linenos">576</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">577</span>        <span class="n">bmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
<span class="linenos">578</span>        <span class="n">bmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="linenos">579</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">580</span>            <span class="n">max_8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">581</span>            <span class="n">max_9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">582</span>            <span class="n">max_13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">583</span>            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">max_8</span><span class="p">,</span> <span class="n">max_9</span><span class="p">,</span> <span class="n">max_13</span><span class="p">])</span>
<span class="linenos">584</span>
<span class="linenos">585</span>            <span class="n">min_8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="linenos">586</span>            <span class="n">min_9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx9</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="linenos">587</span>            <span class="n">min_13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx13</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="linenos">588</span>            <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">min_8</span><span class="p">,</span> <span class="n">min_9</span><span class="p">,</span> <span class="n">min_13</span><span class="p">])</span>
<span class="linenos">589</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">590</span>            <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="linenos">591</span>            <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">Vx8</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="linenos">592</span>
<span class="linenos">593</span>        <span class="k">return</span> <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>
<span class="linenos">594</span>
<span class="linenos">595</span>    <span class="k">def</span> <span class="nf">get_bhminmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">596</span>        <span class="sd">&quot;&quot;&quot;Returns the minimum and maximum of the measured hall voltage</span>
<span class="linenos">597</span><span class="sd">        converted to strayfield.</span>
<span class="linenos">598</span>
<span class="linenos">599</span><span class="sd">        .. code-block:: python</span>
<span class="linenos">600</span><span class="sd">           :caption: Example</span>
<span class="linenos">601</span>
<span class="linenos">602</span><span class="sd">           bhmin, bhmax = meas.get_bhminmax()</span>
<span class="linenos">603</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">604</span>        <span class="n">max_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos">605</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="linenos">606</span>        <span class="n">min_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos">607</span>                        <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx8</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
<span class="linenos">608</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">609</span>            <span class="n">max_9</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<span class="linenos">610</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="linenos">611</span>            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">max_8</span><span class="p">,</span> <span class="n">max_9</span><span class="p">])</span>
<span class="linenos">612</span>
<span class="linenos">613</span>            <span class="n">min_9</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<span class="linenos">614</span>                            <span class="bp">self</span><span class="o">.</span><span class="n">down_fitted</span><span class="o">.</span><span class="n">Bx9</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
<span class="linenos">615</span>            <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">min_8</span><span class="p">,</span> <span class="n">min_9</span><span class="p">])</span>
<span class="linenos">616</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">617</span>            <span class="n">vmax</span> <span class="o">=</span> <span class="n">max_8</span>
<span class="linenos">618</span>            <span class="n">vmin</span> <span class="o">=</span> <span class="n">min_8</span>
<span class="linenos">619</span>
<span class="linenos">620</span>        <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>
<span class="linenos">621</span>
<span class="linenos">622</span>    <span class="k">def</span> <span class="nf">get_default_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">623</span>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">):</span>
<span class="linenos">624</span>            <span class="k">return</span> <span class="s2">&quot;m</span><span class="si">%s</span><span class="s2">: $</span><span class="si">%s</span><span class="s2">^</span><span class="se">\\</span><span class="s2">circ$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
<span class="linenos">625</span>                                         <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">])</span>
<span class="linenos">626</span>        <span class="k">return</span> <span class="s1">&#39;m</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> ($</span><span class="si">%s</span><span class="s1">^</span><span class="se">\\</span><span class="s1">circ$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measurement_number</span><span class="p">,</span>
<span class="linenos">627</span>                                          <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">],</span>
<span class="linenos">628</span>                                          <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id35">
<h3><a class="toc-backref" href="#id72" role="doc-backlink">MultipleM</a><a class="headerlink" href="#id35" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">MultipleM</span><span class="p">(</span><span class="n">MeasurementClass</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 3</span>        <span class="sd">&quot;&quot;&quot;MultipleM:</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="sd">        Main parent class for all multiple measurements. These Measurements</span>
<span class="linenos"> 6</span><span class="sd">        are represent by one data variable.</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="sd">        All multiple measurements have a variable called ``multi_info`` which</span>
<span class="linenos"> 9</span><span class="sd">        contains a pandas.DataFrame with parameter settings to single</span>
<span class="linenos">10</span><span class="sd">        measurements.</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="sd">        All multiple measurements can be represented by</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="sd">            &gt;&gt;&gt; m = ana.MultipleM()</span>
<span class="linenos">15</span><span class="sd">            &gt;&gt;&gt; m</span>
<span class="linenos">16</span><span class="sd">            Nr. 0: Hloop</span>
<span class="linenos">17</span><span class="sd">            Nr. 0: RAW</span>
<span class="linenos">18</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">19</span>        
<span class="linenos">20</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos">21</span>        <span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="linenos">22</span>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;data/mfn_info.csv&#39;</span><span class="p">):</span>
<span class="linenos">23</span>            <span class="bp">self</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/mfn_info.csv&#39;</span><span class="p">)</span>
<span class="linenos">24</span>    
<span class="linenos">25</span>    
<span class="linenos">26</span>    <span class="n">query</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="k">def</span> <span class="nf">get_lofm_sweeps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{}):</span>
<span class="linenos">29</span>        <span class="sd">&quot;&quot;&quot;Workaround to get list of measurements for sweeps.</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="sd">        Args:</span>
<span class="linenos">32</span><span class="sd">            to_show (dict): Measurement Numbers pointing to label format</span>
<span class="linenos">33</span><span class="sd">                variables: e.g. `` {nr: [-1, 1, &#39;Plusses&#39;, &#39;2 mT/min&#39;]}</span>
<span class="linenos">34</span><span class="sd">            label (str): Label to show in plots: e.g. &quot;Show %s -&gt; %s (%s) %s &quot;</span>
<span class="linenos">35</span><span class="sd">                -&gt; will be formated using to_show</span>
<span class="linenos">36</span><span class="sd">            options (dict, default: empty): Additional plotting options</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="sd">        Returns:</span>
<span class="linenos">39</span><span class="sd">            dict: List of Measurements with description</span>
<span class="linenos">40</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">41</span>        
<span class="linenos">42</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lofm</span><span class="p">(</span><span class="n">to_show</span><span class="p">,</span> 
<span class="linenos">43</span>                             <span class="n">label</span><span class="p">,</span> 
<span class="linenos">44</span>                             <span class="n">options</span><span class="p">)</span>
<span class="linenos">45</span>
<span class="linenos">46</span>    <span class="k">def</span> <span class="nf">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
<span class="linenos">47</span>        <span class="sd">&quot;&quot;&quot;Updates multi_info DataFrame. Reads csv and adds information to</span>
<span class="linenos">48</span><span class="sd">        self.multi_info</span>
<span class="linenos">49</span>
<span class="linenos">50</span><span class="sd">        Args:</span>
<span class="linenos">51</span><span class="sd">            *args:</span>
<span class="linenos">52</span><span class="sd">            **kwargs:</span>
<span class="linenos">53</span>
<span class="linenos">54</span><span class="sd">        Returns:</span>
<span class="linenos">55</span><span class="sd">            None</span>
<span class="linenos">56</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">57</span>
<span class="linenos">58</span>        <span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_info</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)])</span>
<span class="linenos">59</span>
<span class="linenos">60</span>    <span class="k">def</span> <span class="nf">get_lofm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_show</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{}):</span>
<span class="linenos">61</span>        <span class="sd">&quot;&quot;&quot;Returns the List of Measurements (lofm) for plot functions</span>
<span class="linenos">62</span><span class="sd">            (see :meth:`ana.HandleM.plot`).</span>
<span class="linenos">63</span>
<span class="linenos">64</span><span class="sd">        Args:</span>
<span class="linenos">65</span><span class="sd">            to_show (dict): Measurement Numbers pointing to label format</span>
<span class="linenos">66</span><span class="sd">                variables: e.g. ``{nr: [(-1, 1), &#39;Plusses&#39;, &#39;5 mT/min&#39;]}``</span>
<span class="linenos">67</span><span class="sd">            label (str): Label to show in plots: e.g.</span>
<span class="linenos">68</span><span class="sd">                ``&quot;Show %s -&gt; %s (%s) %s &quot;`` -&gt; will be string formated using</span>
<span class="linenos">69</span><span class="sd">                to_show</span>
<span class="linenos">70</span><span class="sd">            options (dict, optional, default: empty): Additional plotting</span>
<span class="linenos">71</span><span class="sd">                parameters</span>
<span class="linenos">72</span>
<span class="linenos">73</span><span class="sd">        Returns:</span>
<span class="linenos">74</span><span class="sd">            dict: List of Measurements with description: ``{nr: [labels]}``</span>
<span class="linenos">75</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">76</span>        <span class="n">lofm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">77</span>        <span class="k">for</span> <span class="n">nr</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">to_show</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">78</span>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
<span class="linenos">79</span>                <span class="n">form</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="linenos">80</span>            <span class="c1"># elif isinstance(content[0], str) or \</span>
<span class="linenos">81</span>            <span class="c1">#         isinstance(content[0], int) or \</span>
<span class="linenos">82</span>            <span class="c1">#         isinstance(content[0], float):</span>
<span class="linenos">83</span>            <span class="c1">#    form = content[0], content[1], content[2]</span>
<span class="linenos">84</span>            <span class="k">else</span><span class="p">:</span>
<span class="linenos">85</span>                <span class="n">form</span> <span class="o">=</span> <span class="n">content</span>
<span class="linenos">86</span>                
<span class="linenos">87</span>            <span class="n">lofm</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="o">%</span> <span class="n">form</span><span class="p">,</span> <span class="n">options</span><span class="p">]</span>
<span class="linenos">88</span>
<span class="linenos">89</span>        <span class="k">return</span> <span class="n">lofm</span>
</pre></div>
</div>
</section>
<section id="id36">
<h3><a class="toc-backref" href="#id73" role="doc-backlink">PlottingClass</a><a class="headerlink" href="#id36" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">class</span> <span class="nc">PlottingClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="linenos">  2</span>    <span class="sd">&quot;&quot;&quot;Defines the basic plotting style.&quot;&quot;&quot;</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">):</span>
<span class="linenos">  5</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  6</span><span class="sd">        Args:</span>
<span class="linenos">  7</span><span class="sd">            **style:</span>
<span class="linenos">  8</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">  9</span>        <span class="n">default_style</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 10</span>            <span class="s1">&#39;dpi&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
<span class="linenos"> 11</span>            <span class="s1">&#39;figure.autolayout&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 12</span>            <span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="linenos"> 13</span>            <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
<span class="linenos"> 14</span>            <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="linenos"> 15</span>            <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
<span class="linenos"> 16</span>            <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos"> 17</span>            <span class="s1">&#39;lines.markersize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
<span class="linenos"> 18</span>            <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
<span class="linenos"> 19</span>            <span class="s1">&#39;mpl_style&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 20</span>            <span class="s1">&#39;latex&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 21</span>            <span class="s1">&#39;default_cm&#39;</span><span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span>
<span class="linenos"> 22</span>        <span class="p">}</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Default Plotting Class&#39;</span>
<span class="linenos"> 25</span>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">default_style</span>
<span class="linenos"> 26</span>        <span class="bp">self</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span>    <span class="n">get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span>    <span class="fm">__repr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span>    <span class="fm">__str__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> \
<span class="linenos"> 33</span>                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="se">\t</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 38</span><span class="sd">        Args:</span>
<span class="linenos"> 39</span><span class="sd">            other:</span>
<span class="linenos"> 40</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 41</span>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="linenos"> 44</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 45</span><span class="sd">        Args:</span>
<span class="linenos"> 46</span><span class="sd">            key:</span>
<span class="linenos"> 47</span><span class="sd">            value:</span>
<span class="linenos"> 48</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 49</span>        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">value</span><span class="p">))</span>
<span class="linenos"> 50</span>
<span class="linenos"> 51</span>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="linenos"> 52</span>        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span>    <span class="c1"># Set Plotting Style</span>
<span class="linenos"> 55</span>    <span class="k">def</span> <span class="nf">set_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">):</span>
<span class="linenos"> 56</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 57</span><span class="sd">        Sets the Style for plots</span>
<span class="linenos"> 58</span><span class="sd">    </span>
<span class="linenos"> 59</span><span class="sd">        :param size: A dictionary of parameters or the name of a preconfigured set.</span>
<span class="linenos"> 60</span><span class="sd">        :type size: dict, None, or one of {paper, notebook, talk, poster}</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span><span class="sd">        :param style:</span>
<span class="linenos"> 63</span><span class="sd">        :type style: dict, None, or one of {darkgrid, whitegrid, dark, white, ticks}</span>
<span class="linenos"> 64</span><span class="sd">    </span>
<span class="linenos"> 65</span><span class="sd">        :param default: if True it sets default</span>
<span class="linenos"> 66</span><span class="sd">            :code:`size=talk` and</span>
<span class="linenos"> 67</span><span class="sd">            :code:`style=whitegrid`</span>
<span class="linenos"> 68</span><span class="sd">        :type default: bool</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="sd">        :param notebook: if True it sets default</span>
<span class="linenos"> 71</span><span class="sd">            :code:`size=notebook` and</span>
<span class="linenos"> 72</span><span class="sd">            :code:`style=ticks`</span>
<span class="linenos"> 73</span>
<span class="linenos"> 74</span><span class="sd">        :type notebook: bool</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span><span class="sd">    </span>
<span class="linenos"> 77</span><span class="sd">        Returns</span>
<span class="linenos"> 78</span><span class="sd">        -------</span>
<span class="linenos"> 79</span><span class="sd">        None.</span>
<span class="linenos"> 80</span><span class="sd">    </span>
<span class="linenos"> 81</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 82</span>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
<span class="linenos"> 83</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="linenos"> 84</span>            <span class="n">def_size</span> <span class="o">=</span> <span class="s1">&#39;talk&#39;</span>
<span class="linenos"> 85</span>            <span class="n">def_style</span> <span class="o">=</span> <span class="s1">&#39;whitegrid&#39;</span>
<span class="linenos"> 86</span>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">):</span>
<span class="linenos"> 87</span>            <span class="n">def_size</span> <span class="o">=</span> <span class="s1">&#39;notebook&#39;</span>
<span class="linenos"> 88</span>            <span class="n">def_style</span> <span class="o">=</span> <span class="s1">&#39;ticks&#39;</span>
<span class="linenos"> 89</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 90</span>            <span class="n">def_size</span> <span class="o">=</span> <span class="s1">&#39;talk&#39;</span>
<span class="linenos"> 91</span>            <span class="n">def_style</span> <span class="o">=</span> <span class="s1">&#39;whitegrid&#39;</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span>        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="n">def_size</span><span class="p">),</span>
<span class="linenos"> 94</span>                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">def_style</span><span class="p">),</span>
<span class="linenos"> 95</span>                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;palette&#39;</span><span class="p">,</span> <span class="s1">&#39;deep&#39;</span><span class="p">),</span>
<span class="linenos"> 96</span>                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">),</span>
<span class="linenos"> 97</span>                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;font-scale&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span>        <span class="k">if</span> <span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">):</span>
<span class="linenos">100</span>            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">101</span>            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span>
<span class="linenos">102</span>
<span class="linenos">103</span>        <span class="n">latex</span> <span class="o">=</span> <span class="s1">&#39;latex&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
<span class="linenos">104</span>        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">latex</span>
<span class="linenos">105</span>        <span class="k">if</span> <span class="n">latex</span><span class="p">:</span>  <span class="c1"># True activates latex output in fonts!</span>
<span class="linenos">106</span>            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span>
<span class="linenos">107</span>                <span class="s1">&#39;text.latex.preamble&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="linenos">108</span>
<span class="linenos">109</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;set_mpl_params&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span class="linenos">110</span>            <span class="n">params</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_params&#39;</span><span class="p">,</span> <span class="p">{</span>
<span class="linenos">111</span>                <span class="s1">&#39;figure.dpi&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
<span class="linenos">112</span>                <span class="s1">&#39;savefig.dpi&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
<span class="linenos">113</span>                <span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">),</span>
<span class="linenos">114</span>                <span class="s1">&#39;figure.autolayout&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">115</span>                <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
<span class="linenos">116</span>                <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="linenos">117</span>                <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
<span class="linenos">118</span>                <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos">119</span>                <span class="s1">&#39;lines.markersize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
<span class="linenos">120</span>                <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
<span class="linenos">121</span>                <span class="s1">&#39;figure.subplot.hspace&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
<span class="linenos">122</span>                <span class="s1">&#39;figure.subplot.wspace&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
<span class="linenos">123</span>                <span class="s1">&#39;savefig.transparent&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">124</span>                <span class="s1">&#39;savefig.bbox&#39;</span><span class="p">:</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span>
<span class="linenos">125</span>                <span class="s1">&#39;savefig.pad_inches&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="linenos">126</span>            <span class="p">})</span>
<span class="linenos">127</span>            <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;figure.autolayout&#39;</span><span class="p">,</span>
<span class="linenos">128</span>                           <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">,</span>
<span class="linenos">129</span>                           <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">,</span>
<span class="linenos">130</span>                           <span class="s1">&#39;font.size&#39;</span><span class="p">,</span>
<span class="linenos">131</span>                           <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">,</span>
<span class="linenos">132</span>                           <span class="s1">&#39;lines.markersize&#39;</span><span class="p">,</span>
<span class="linenos">133</span>                           <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span>
<span class="linenos">134</span>            <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos">135</span>                <span class="n">update_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">update_keys</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> \
<span class="linenos">136</span>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">([</span><span class="n">_</span> <span class="ow">in</span> <span class="n">style</span> \
<span class="linenos">137</span>                                        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">])</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="linenos">138</span>            <span class="p">})</span>
<span class="linenos">139</span>            <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="linenos">140</span>
<span class="linenos">141</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_style&#39;</span><span class="p">):</span>
<span class="linenos">142</span>            <span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_style&#39;</span><span class="p">))</span>
<span class="linenos">143</span>
<span class="linenos">144</span>    <span class="k">def</span> <span class="nf">get_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos">145</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">146</span><span class="sd">        Args:</span>
<span class="linenos">147</span><span class="sd">            custom:</span>
<span class="linenos">148</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">149</span>        <span class="k">if</span> <span class="n">custom</span><span class="p">:</span>
<span class="linenos">150</span>            <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span>
<span class="linenos">151</span>        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mpl_style&#39;</span><span class="p">))</span>
<span class="linenos">152</span>
<span class="linenos">153</span>    <span class="k">def</span> <span class="nf">set_plot_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">154</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">155</span><span class="sd">        Args:</span>
<span class="linenos">156</span><span class="sd">            **kwargs:</span>
<span class="linenos">157</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">158</span>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">))</span>
<span class="linenos">159</span>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">))</span>
<span class="linenos">160</span>
<span class="linenos">161</span>        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="linenos">162</span>        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylim&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="linenos">163</span>        <span class="k">if</span> <span class="n">xmin</span><span class="p">:</span>
<span class="linenos">164</span>            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="linenos">165</span>        <span class="k">if</span> <span class="n">ymin</span><span class="p">:</span>
<span class="linenos">166</span>            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
<span class="linenos">167</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_settings&#39;</span><span class="p">):</span>
<span class="linenos">168</span>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_location&#39;</span><span class="p">,</span> <span class="s1">&#39;best&#39;</span><span class="p">))</span>
<span class="linenos">169</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">170</span>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_settings&#39;</span><span class="p">))</span>
<span class="linenos">171</span>
<span class="linenos">172</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">):</span>
<span class="linenos">173</span>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">])</span>
<span class="linenos">174</span>
<span class="linenos">175</span>        <span class="n">title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
<span class="linenos">176</span>        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
<span class="linenos">177</span>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="linenos">178</span>
<span class="linenos">179</span>        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;$f$ [Hz]&#39;</span><span class="p">)</span>
<span class="linenos">180</span>        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;$S_</span><span class="si">{V_H}</span><span class="s1">$ [${V^2}$/</span><span class="si">{Hz}</span><span class="s1">]&#39;</span><span class="p">)</span>
<span class="linenos">181</span>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
<span class="linenos">182</span>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
<span class="linenos">183</span>
<span class="linenos">184</span>    <span class="k">def</span> <span class="nf">draw_oneoverf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">185</span>        <span class="c1"># Draw 1/f</span>
<span class="linenos">186</span>        <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">187</span><span class="sd">        Args:</span>
<span class="linenos">188</span><span class="sd">            ax:</span>
<span class="linenos">189</span><span class="sd">            **kwargs:</span>
<span class="linenos">190</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">191</span>        <span class="n">xmin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>
<span class="linenos">192</span>        <span class="n">ymin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="linenos">193</span>        <span class="n">factor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">194</span>        <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">195</span>        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_label&#39;</span><span class="p">):</span>
<span class="linenos">196</span>            <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_label&#39;</span><span class="p">)</span>
<span class="linenos">197</span>        <span class="k">elif</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">198</span>            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$1/f$&#39;</span>
<span class="linenos">199</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">200</span>            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$1/f^</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">alpha</span>
<span class="linenos">201</span>
<span class="linenos">202</span>        <span class="n">mean_x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mean_x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">factor</span><span class="p">)))</span>
<span class="linenos">203</span>        <span class="n">mean_y</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mean_y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">/</span> <span class="p">(</span><span class="n">factor</span> <span class="o">**</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))))</span>
<span class="linenos">204</span>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disable&#39;</span><span class="p">)):</span>
<span class="linenos">205</span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">*</span> <span class="n">factor</span><span class="p">],</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">/</span> <span class="p">(</span><span class="n">factor</span> <span class="o">**</span> <span class="n">alpha</span><span class="p">)],</span>
<span class="linenos">206</span>                    <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">207</span>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">mean_x</span><span class="p">,</span> <span class="n">mean_y</span><span class="p">),</span>
<span class="linenos">208</span>                        <span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;an_color&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">),</span>
<span class="linenos">209</span>                        <span class="n">size</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;an_size&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="linenos">210</span>
<span class="linenos">211</span>    <span class="k">def</span> <span class="nf">save_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">fext</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">):</span>
<span class="linenos">212</span>        <span class="sd">&quot;&quot;&quot;Saves the current plot as file.</span>
<span class="linenos">213</span>
<span class="linenos">214</span><span class="sd">        Args:</span>
<span class="linenos">215</span><span class="sd">            fname (str): Filename</span>
<span class="linenos">216</span><span class="sd">            fext (str): Extension</span>
<span class="linenos">217</span>
<span class="linenos">218</span><span class="sd">        Returns:</span>
<span class="linenos">219</span><span class="sd">            None</span>
<span class="linenos">220</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">221</span>
<span class="linenos">222</span>        <span class="n">base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="linenos">223</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
<span class="linenos">224</span>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
<span class="linenos">225</span>
<span class="linenos">226</span>        <span class="k">if</span> <span class="n">fext</span> <span class="o">==</span> <span class="s1">&#39;pgf&#39;</span><span class="p">:</span>
<span class="linenos">227</span>            <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="linenos">228</span>                <span class="s2">&quot;pgf.texsystem&quot;</span><span class="p">:</span> <span class="s2">&quot;pdflatex&quot;</span><span class="p">,</span>
<span class="linenos">229</span>                <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
<span class="linenos">230</span>                <span class="s1">&#39;text.usetex&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">231</span>                <span class="s1">&#39;pgf.rcfonts&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">232</span>                <span class="s1">&#39;text.latex.preamble&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\usepackage[utf8]</span><span class="si">{inputenc}</span><span class="s1">\DeclareUnicodeCharacter</span><span class="si">{2212}</span><span class="s1">{-}&#39;</span>
<span class="linenos">233</span>            <span class="p">})</span>
<span class="linenos">234</span>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">fext</span><span class="p">),</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;pgf&#39;</span><span class="p">)</span>
<span class="linenos">235</span>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos">236</span>
<span class="linenos">237</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">238</span>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">fext</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id37">
<h3><a class="toc-backref" href="#id74" role="doc-backlink">Functions</a><a class="headerlink" href="#id37" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># SPDX-FileCopyrightText: 2020/2021 Jonathan Pieper &lt;ody55eus@mailbox.org&gt;</span>
<span class="linenos"> 2</span><span class="c1">#</span>
<span class="linenos"> 3</span><span class="c1"># SPDX-License-Identifier: GPL-3.0-or-later</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span><span class="sd">Helps to handle measurements and style plots.</span>
<span class="linenos"> 7</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="linenos">12</span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="kn">from</span> <span class="nn">.plotting</span> <span class="kn">import</span> <span class="n">PlottingClass</span>
<span class="linenos">15</span><span class="kn">from</span> <span class="nn">.measurement</span> <span class="kn">import</span> <span class="n">MeasurementClass</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="n">plot</span> <span class="o">=</span> <span class="n">PlottingClass</span><span class="p">()</span>
<span class="linenos">18</span><span class="n">set_sns</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_style</span>
<span class="linenos">19</span><span class="n">set_plot_settings</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_plot_settings</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">meas</span> <span class="o">=</span> <span class="n">MeasurementClass</span><span class="p">()</span>
<span class="linenos">22</span><span class="n">get_info_from_name</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">get_info_from_name</span>
<span class="linenos">23</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="k">def</span> <span class="nf">getpath</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
<span class="linenos">26</span>    <span class="sd">&quot;&quot;&quot;Alias for ``glob``.</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="sd">    Args:</span>
<span class="linenos">29</span><span class="sd">        *arg:</span>
<span class="linenos">30</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">31</span>    <span class="k">return</span> <span class="n">glob</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="k">def</span> <span class="nf">timing</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
<span class="linenos">35</span>    <span class="sd">&quot;&quot;&quot;Wraps a function to measure the time it takes.</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="sd">    Args:</span>
<span class="linenos">38</span><span class="sd">        f:</span>
<span class="linenos">39</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">40</span>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="linenos">41</span>    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="linenos">42</span>        <span class="n">ts</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="linenos">43</span>        <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="linenos">44</span>        <span class="n">te</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="linenos">45</span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;func:</span><span class="si">%r</span><span class="s1"> took: </span><span class="si">%2.4f</span><span class="s1"> sec&#39;</span> <span class="o">%</span> \
<span class="linenos">46</span>          <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">te</span><span class="o">-</span><span class="n">ts</span><span class="p">))</span>
<span class="linenos">47</span>        <span class="k">return</span> <span class="n">result</span>
<span class="linenos">48</span>    <span class="k">return</span> <span class="n">wrap</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020/2021, Jonathan Pieper.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>